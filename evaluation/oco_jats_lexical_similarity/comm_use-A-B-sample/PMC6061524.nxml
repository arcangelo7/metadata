<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bull Math Biol</journal-id><journal-id journal-id-type="iso-abbrev">Bull. Math. Biol</journal-id><journal-title-group><journal-title>Bulletin of Mathematical Biology</journal-title></journal-title-group><issn pub-type="ppub">0092-8240</issn><issn pub-type="epub">1522-9602</issn><publisher><publisher-name>Springer US</publisher-name><publisher-loc>New York</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">29948885</article-id><article-id pub-id-type="pmc">6061524</article-id><article-id pub-id-type="publisher-id">452</article-id><article-id pub-id-type="doi">10.1007/s11538-018-0452-0</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Article</subject></subj-group></article-categories><title-group><article-title>Exploring the Tiers of Rooted Phylogenetic Network Space Using Tail Moves</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5192-1470</contrib-id><name><surname>Janssen</surname><given-names>Remie</given-names></name><address><email>remiejanssen@gmail.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Jones</surname><given-names>Mark</given-names></name><address><email>markelliotlloyd@gmail.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Erd&#x00151;s</surname><given-names>P&#x000e9;ter L.</given-names></name><address><email>erdos.peter@renyi.mta.hu</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7142-4706</contrib-id><name><surname>van Iersel</surname><given-names>Leo</given-names></name><address><email>l.j.j.v.iersel@gmail.com</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Scornavacca</surname><given-names>Celine</given-names></name><address><email>celine.scornavacca@umontpellier.fr</email></address><xref ref-type="aff" rid="Aff3">3</xref><xref ref-type="aff" rid="Aff4">4</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2097 4740</institution-id><institution-id institution-id-type="GRID">grid.5292.c</institution-id><institution>Delft Institute of Applied Mathematics, </institution><institution>Delft University of Technology, </institution></institution-wrap>Postbus 5031, 2600 GA Delft, The Netherlands </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2149 4407</institution-id><institution-id institution-id-type="GRID">grid.5018.c</institution-id><institution>MTA R&#x000e9;nyi Institute of Mathematics, </institution></institution-wrap>Re&#x000e1;ltanoda u 13-15, Budapest, 1053 Hungary </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2097 0141</institution-id><institution-id institution-id-type="GRID">grid.121334.6</institution-id><institution>Institut des Sciences de l&#x02019;Evolution, CNRS, IRD, EPHE, </institution><institution>Universit&#x000e9; de Montpellier, </institution></institution-wrap>Place Eug&#x000e8;ne Bataillon, Montpellier, France </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2097 0141</institution-id><institution-id institution-id-type="GRID">grid.121334.6</institution-id><institution>Institut de Biologie Computationnelle (IBC), </institution></institution-wrap>Place Eug&#x000e8;ne Bataillon, Montpellier, France </aff></contrib-group><pub-date pub-type="epub"><day>14</day><month>6</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>14</day><month>6</month><year>2018</year></pub-date><pub-date pub-type="ppub"><year>2018</year></pub-date><volume>80</volume><issue>8</issue><fpage>2177</fpage><lpage>2208</lpage><history><date date-type="received"><day>17</day><month>8</month><year>2017</year></date><date date-type="accepted"><day>4</day><month>6</month><year>2018</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2018</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>/), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">Popular methods for exploring the space of rooted phylogenetic trees use rearrangement moves such as rooted Nearest Neighbour Interchange (rNNI) and rooted Subtree Prune and Regraft (rSPR). Recently, these moves were generalized to rooted phylogenetic networks, which are a more suitable representation of reticulate evolutionary histories, and it was shown that any two rooted phylogenetic networks of the same complexity are connected by a sequence of either rSPR or rNNI moves. Here, we show that this is possible using only <italic>tail moves</italic>, which are a restricted version of rSPR moves on networks that are more closely related to rSPR moves on trees. The connectedness still holds even when we restrict to distance-1 tail moves (a localized version of tail moves). Moreover, we give bounds on the number of (distance-1) tail moves necessary to turn one network into another, which in turn yield new bounds for rSPR, rNNI and SPR (i.e. the equivalent of rSPR on unrooted networks). The upper bounds are constructive, meaning that we can actually find a sequence with at most this length for any pair of networks. Finally, we show that finding a shortest sequence of tail or rSPR moves is NP-hard.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Phylogenetic network</kwd><kwd>Rearrangement</kwd><kwd>Head-move operation</kwd><kwd>Tail-move operation</kwd><kwd>Network space</kwd><kwd>Diameter</kwd></kwd-group><kwd-group xml:lang="--"><title>Mathematics Subject Classification</title><kwd>92D15</kwd><kwd>68R10</kwd><kwd>68R05</kwd><kwd>05C20</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003246</institution-id><institution>Nederlandse Organisatie voor Wetenschappelijk Onderzoek</institution></institution-wrap></funding-source><award-id>639.072.602</award-id></award-group></funding-group><funding-group><award-group><funding-source><institution>4TU Applied Mathematics Institute</institution></funding-source></award-group></funding-group><funding-group><award-group><funding-source><institution>Hungarian National Research, Development and Innovation Office</institution></funding-source><award-id>K 116769</award-id><award-id>SNN 116095</award-id><principal-award-recipient><name><surname>Erd&#x00151;s</surname><given-names>P&#x000e9;ter L.</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution>Agence Nationale de la Recherche Investissements d&#x02019;Avenir/Bioinformatique (FR)</institution></funding-source><award-id>ANR-10-BINF-01-02</award-id><principal-award-recipient><name><surname>Scornavacca</surname><given-names>Celine</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; Society for Mathematical Biology 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">Leaf-labelled trees are routinely used in phylogenetics to depict the relatedness between entities such as species and genes. Accurate knowledge of these trees, commonly called <italic>phylogenetic trees</italic>, is vital for our understanding of the processes underlying molecular evolution, and thousands of phylogenetic trees are reconstructed from molecular data each day.</p><p id="Par3">However, this representation is not suitable when reticulation events such as hybrid speciations (e.g. Abbott et&#x000a0;al. <xref ref-type="bibr" rid="CR1">2013</xref>), horizontal gene transfers (e.g. Zhaxybayeva and Doolittle <xref ref-type="bibr" rid="CR19">2011</xref>) and recombinations (e.g. Vuilleumier and Bonhoeffer <xref ref-type="bibr" rid="CR16">2015</xref>) are involved in the evolution of the entities of interest. In such cases, a more suitable representation can be found in <italic>phylogenetic networks</italic>, where in its broadest sense a phylogenetic network can be thought of as a leaf-labelled graph (directed or undirected), usually without parallel edges and degree-2 nodes (Morrison <xref ref-type="bibr" rid="CR14">2011</xref>; Huson et&#x000a0;al. <xref ref-type="bibr" rid="CR11">2010</xref>).</p><p id="Par4">Common procedures used to reconstruct phylogenetic trees from biological data are tree rearrangement heuristics (Felsenstein <xref ref-type="bibr" rid="CR7">2004</xref>). These techniques consist of choosing an optimization criterion (e.g. maximum parsimony, maximum likelihood, a distance-based scoring scheme) or opting for a Bayesian approach, and then using <italic>tree rearrangement moves</italic> to explore the space of phylogenetic trees. These moves specify possible ways of generating alternative phylogenies from a given one, and their fundamental property is to be able to transform, by repeated application, any phylogenetic tree into any other phylogenetic tree. Several tree rearrangement moves have been defined in the past, the most commonly used ones being <italic>Nearest Neighbour Interchange</italic> (<italic>NNI</italic>) moves and <italic>Subtree Prune and Regraft</italic> (<italic>SPR</italic>) moves; when the phylogenetic trees are considered as <italic>rooted</italic>, i.e. directed and out-branching (i.e. singly rooted), we have their rooted versions: rNNI and rSPR moves.</p><p id="Par5">Recently, researchers have become interested in defining rearrangement moves for phylogenetic networks and studying their properties (Bordewich et&#x000a0;al. <xref ref-type="bibr" rid="CR4">2017a</xref>; Francis et&#x000a0;al. <xref ref-type="bibr" rid="CR8">2017</xref>; Gambette et&#x000a0;al. <xref ref-type="bibr" rid="CR9">2017</xref>; Huber et&#x000a0;al. <xref ref-type="bibr" rid="CR10">2016</xref>). Huber et&#x000a0;al. (<xref ref-type="bibr" rid="CR10">2016</xref>) gave a generalization of NNI moves for unrooted phylogenetic networks and showed the connectivity under these moves of the <italic>tiers</italic> of phylogenetic network space, i.e. phylogenetic networks having the same <italic>reticulation number</italic>. The latter concept will be formally defined in the next section, but roughly speaking, it is a way to express the amount of reticulate evolution present in a phylogenetic network. Francis et&#x000a0;al. (<xref ref-type="bibr" rid="CR8">2017</xref>) generalized SPR moves for unrooted phylogenetic networks and studied the properties of the NNI and SPR neighbourhoods of a network, giving bounds on their sizes. Gambette et&#x000a0;al. (<xref ref-type="bibr" rid="CR9">2017</xref>) focused on <italic>rooted</italic> phylogenetic networks, i.e. phylogenetic networks where the underlying graph is a rooted directed acyclic graph, and introduced generalizations of rNNI and rSPR moves for rooted phylogenetic networks. rSPR moves consist of <italic>head moves</italic> and <italic>tail moves</italic> (see Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>), while rNNI moves can be seen as distance-1 head moves and distance-1 tail moves (see Definitions&#x000a0;<xref ref-type="sec" rid="FPar5">2.5</xref> and&#x000a0;<xref ref-type="sec" rid="FPar6">2.6</xref> for formal descriptions). In the same paper, Gambette et al. showed the connectivity of each tier of rooted phylogenetic networks under rNNI moves (and consequently also under rSPR moves) and gave bounds for the rNNI neighbourhood of a network. Finally, Bordewich et&#x000a0;al. (<xref ref-type="bibr" rid="CR4">2017a</xref>) introduced another generalization of rSPR called SNPR (SubNet Prune and Regraft), giving connectivity proofs and bounds for some classes of rooted phylogenetic networks, allowing parallel edges in most cases.<fig id="Fig1"><label>Fig. 1</label><caption><p>(Color figure online) Starting with the rooted phylogenetic network on the left, if we move the tail of (<italic>u</italic>,&#x000a0;<italic>v</italic>) to (<italic>x</italic>,&#x000a0;<italic>y</italic>) we produce the network in the middle. If we instead move the head of (<italic>u</italic>,&#x000a0;<italic>v</italic>) to (<italic>x</italic>,&#x000a0;<italic>y</italic>), we produce the network on the right</p></caption><graphic xlink:href="11538_2018_452_Fig1_HTML" id="MO41"/></fig>
</p><p id="Par6">Note also that a handful of rearrangement heuristics for phylogenetic networks have been published recently (see, for example, PhyloNET (Than et&#x000a0;al. <xref ref-type="bibr" rid="CR15">2008</xref>) and the BEAST 2 add-on SpeciesNetwork) and each of them uses its own set of rearrangement moves, e.g. the &#x0201c;Branch relocator&#x0201d; move in (Zhang et&#x000a0;al. <xref ref-type="bibr" rid="CR18">2017</xref>) and the &#x0201c;Relocating the source of an edge&#x0201d; and &#x0201c;Relocating the destination of a reticulation edge&#x0201d; moves in (Yu et&#x000a0;al. <xref ref-type="bibr" rid="CR17">2014</xref>). These sets of moves are often included among the ones cited in the previous paragraph; for example, the above-cited moves from (Yu et&#x000a0;al. <xref ref-type="bibr" rid="CR17">2014</xref>) correspond, respectively, to head and tail moves (see Definitions <xref ref-type="sec" rid="FPar5">2.5</xref> and <xref ref-type="sec" rid="FPar6">2.6</xref>) and their union correspond to the rSPR moves defined in (Gambette et&#x000a0;al. <xref ref-type="bibr" rid="CR9">2017</xref>), c.f. next section. Since these papers do not focus on studying the properties of the moves they define, we will not discuss them here.</p><p id="Par7">In this paper, we mostly focus on rooted binary phylogenetic networks and <italic>tail moves</italic>. In some sense, these can be seen as the most natural generalization of rSPR moves on rooted phylogenetic trees to networks. We show that each tier of rooted binary phylogenetic network space is connected using only tail moves, and even using only distance-1 tail moves. Hence, to get connectivity, head moves are not necessary. We note, however, that head moves could be useful in practice to escape from local optima (see the Discussion section). We also analyse the tail-move diameter, giving upper bounds on the number of tail moves, and the number of distance-1 tail moves (<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {Tail}_1$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mtext>Tail</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq1.gif"/></alternatives></inline-formula> moves), necessary to turn any rooted binary phylogenetic network with&#x000a0;<italic>k</italic> reticulations into any other such network on the same leaf set. Since the upper-bound proofs are constructive, we can actually find a sequence to go from one network to another network via tail moves. Interestingly, these bounds yield new bounds for rSPR, rNNI and SPR moves (see Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>New diameter bounds for several rearrangement moves</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Move</th><th align="left" colspan="2">Diameter of tier <italic>k</italic> networks with <italic>n</italic> leaves</th></tr><tr><th align="left">Lower bound</th><th align="left">Upper bound</th></tr></thead><tbody><tr><td align="center">rSPR</td><td align="center">
<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-\varTheta (\sqrt{n})$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq2.gif"/></alternatives></inline-formula>
</td><td align="left">
<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2n+3k$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq3.gif"/></alternatives></inline-formula>
</td></tr><tr><td align="center">Tail</td><td align="center">
<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-\varTheta (\sqrt{n})$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq4.gif"/></alternatives></inline-formula>
</td><td align="left">
<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3(n+2k)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq5.gif"/></alternatives></inline-formula>
</td></tr><tr><td align="center">rNNI</td><td align="center">
<inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varOmega (n \log (n))$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>&#x003a9;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq6.gif"/></alternatives></inline-formula>
</td><td align="left">
<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n^2)$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq7.gif"/></alternatives></inline-formula>
</td></tr><tr><td align="center">
<inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {Tail}_1$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mtext>Tail</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq8.gif"/></alternatives></inline-formula>
</td><td align="center">
<inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varOmega (n \log (n))$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>&#x003a9;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq9.gif"/></alternatives></inline-formula>
</td><td align="left">
<inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n^2)$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq10.gif"/></alternatives></inline-formula>
</td></tr><tr><td align="center">SPR</td><td align="center"/><td align="left">
<inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n+\frac{8}{3}k$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>8</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq11.gif"/></alternatives></inline-formula>
</td></tr></tbody></table></table-wrap>
</p><p id="Par8">Finally, we show that the computation of a tail move sequence or rSPR sequence of shortest length is NP-hard.</p></sec><sec id="Sec2"><title>Definitions and Properties</title><sec id="Sec3"><title>Phylogenetic Networks</title><p id="Par9">In this subsection, we define the combinatorial objects of interest in this article.</p><sec id="FPar1"><title>Definition 2.1</title><p id="Par10">A <italic>rooted binary phylogenetic network</italic>
<inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=(V,E)$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq12.gif"/></alternatives></inline-formula> on a finite set <italic>X</italic> of taxa is a directed acyclic graph (DAG) with no parallel edges where the <italic>leaves</italic> (nodes of indegree-1 and outdegree-0) are bijectively labelled by&#x000a0;<italic>X</italic>, there is a unique node of indegree-0 and outdegree-1&#x02014;the <italic>root</italic>&#x02014;and all other nodes are either <italic>tree nodes</italic> (indegree-1 and outdegree-2) or <italic>reticulations</italic> (indegree-2 and outdegree-1). We will write <italic>V</italic>(<italic>N</italic>),&#x000a0;<italic>L</italic>(<italic>N</italic>) to denote the nodes and leaves of <italic>N</italic>, respectively. For a set of nodes <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y \subseteq V$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>&#x02286;</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq13.gif"/></alternatives></inline-formula>, we will write <italic>N</italic>[<italic>Y</italic>] to denote the subgraph of <italic>N</italic> induced by <italic>Y</italic>, and we will write <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\setminus Y$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq14.gif"/></alternatives></inline-formula> to denote <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N[V \setminus Y]$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>V</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq15.gif"/></alternatives></inline-formula>. For any directed acyclic graph <italic>D</italic> (including rooted binary phylogenetic networks), we will write |<italic>D</italic>| to denote the number of nodes in <italic>D</italic>.</p><p>A <italic>rooted binary phylogenetic tree</italic> is a rooted binary phylogenetic network with no reticulation nodes (all edges are directed outward from the root). For brevity, we henceforth simply use the terms <italic>network</italic> and <italic>tree</italic>.</p></sec><sec id="FPar2"><title>Definition 2.2</title><p id="Par12">Let <italic>N</italic>, <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M32"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq16.gif"/></alternatives></inline-formula> be two directed acyclic graphs (including networks) with some nodes labelled with <italic>X</italic>. Then, an <italic>isomorphism between</italic>
<italic>N</italic>
<italic>and</italic>
<inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M34"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq17.gif"/></alternatives></inline-formula> is a bijection <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi : V(N) \rightarrow V(N')$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mo>:</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq18.gif"/></alternatives></inline-formula> such that<list list-type="bullet"><list-item><p id="Par13">Two nodes <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u,v \in V(N)$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq19.gif"/></alternatives></inline-formula> are adjacent in <italic>N</italic> if and only if <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi (u)$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq20.gif"/></alternatives></inline-formula> and <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi (v)$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq21.gif"/></alternatives></inline-formula> are adjacent in <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M44"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq22.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par14">For any labelled node <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u \in L(N)$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq23.gif"/></alternatives></inline-formula>, <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi (u)$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq24.gif"/></alternatives></inline-formula> is the node in <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L(N')$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq25.gif"/></alternatives></inline-formula> that has the same label as <italic>u</italic>.</p></list-item></list>We say <italic>N</italic> and <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M52"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq26.gif"/></alternatives></inline-formula> are <italic>isomorphic</italic> if there exists an isomorphism between <italic>N</italic> and <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M54"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq27.gif"/></alternatives></inline-formula>.</p><p>Let <italic>u</italic> and <italic>v</italic> be nodes in a network, and then we say <italic>u</italic> is <italic>above</italic>
<italic>v</italic> and <italic>v</italic> is <italic>below</italic>
<italic>u</italic> if <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u \le v$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq28.gif"/></alternatives></inline-formula> in the order induced by the directed graph underlying the network. Similarly, if <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e=(x,y)$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq29.gif"/></alternatives></inline-formula> is a directed edge of the network and <italic>u</italic> a node, then we say that <italic>e</italic> is <italic>above</italic>
<italic>u</italic> if <italic>y</italic> is above <italic>u</italic> and <italic>e</italic> is <italic>below</italic>
<italic>u</italic> if <italic>x</italic> is below <italic>u</italic>. Let <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e=(u,v)$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq30.gif"/></alternatives></inline-formula> be an edge of a phylogenetic network, then we say that <italic>u</italic> is the <italic>tail</italic> of <italic>e</italic> and <italic>v</italic> is the <italic>head</italic> of <italic>e</italic>. In this situation, we also say that <italic>u</italic> is a <italic>parent</italic> of <italic>v</italic>, or <italic>u</italic> is <italic>directly above</italic>
<italic>v</italic> and <italic>v</italic> is a <italic>child</italic> of <italic>u</italic> or <italic>v</italic> is <italic>directly below</italic>
<italic>u</italic>. Note that in a tree <italic>T</italic>, there is always a unique <italic>lowest common ancestor</italic> (LCA) per pair of nodes of <italic>T</italic>. This is not the case for networks, where we can have several different LCAs.</p><p>A standard measure of tree-likeness of a network <italic>N</italic> is the <italic>reticulation number</italic>. Denoted by <italic>r</italic>(<italic>N</italic>), it is defined as the (unique) number of edges that need to be removed in order to obtain a tree. As any tree has exactly one more node than edges, we may equivalently define it as:<disp-formula id="Equ1"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} r(N)=\sum _{v\in V : \delta ^{-}(v)&#x0003e;0 }\delta ^{-}(v)-1 =|E| - |V|+1, \end{aligned}$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>V</mml:mi><mml:mo>:</mml:mo><mml:msup><mml:mi>&#x003b4;</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:msup><mml:mi>&#x003b4;</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2018_452_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq31"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta ^{-}(v)$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:msup><mml:mi>&#x003b4;</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq31.gif"/></alternatives></inline-formula> denotes the indegree of the node <italic>v</italic>. Note that for binary networks, <italic>r</italic>(<italic>N</italic>) is equal to the number of reticulation nodes.</p><p>Here, we are interested in studying the sets of networks with the same reticulation number:</p></sec><sec id="FPar3"><title>Definition 2.3</title><p id="Par18">Let <italic>X</italic> be a finite set of taxa. The <italic>k</italic><italic>th tier</italic> (Francis et&#x000a0;al. <xref ref-type="bibr" rid="CR8">2017</xref>; Huber et&#x000a0;al. <xref ref-type="bibr" rid="CR10">2016</xref>) on <italic>X</italic> is the set of all networks with label set <italic>X</italic> and reticulation number&#x000a0;<italic>k</italic>.</p><p>This interest comes from the fact that comparing optimization scores across networks with different reticulation numbers may be tricky, since a network generally allows a better fit with the data when its reticulation number is higher. For this reason, it is increasingly conventional (e.g. in Gambette et&#x000a0;al. <xref ref-type="bibr" rid="CR9">2017</xref>) to make a distinction between &#x0201c;horizontal&#x0201d; rearrangement moves, enabling the exploration of a tier, and &#x0201c;vertical&#x0201d; moves, allowing a jump across tiers.</p><p>The next observation will be useful in the next sections:</p></sec><sec id="FPar4"><title>Observation 2.4</title><p id="Par21">As every non-root, non-leaf node in a binary network is incident to exactly three edges, we have that <inline-formula id="IEq32"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|V| = 2|E| + 2|X| + 2$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq32.gif"/></alternatives></inline-formula>. Subtracting <inline-formula id="IEq33"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2|V| = 2|E| - 2k + 2$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq33.gif"/></alternatives></inline-formula> from each side, we get that <inline-formula id="IEq34"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|V| = 2|X| + 2k$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq34.gif"/></alternatives></inline-formula>, which in turn implies that <inline-formula id="IEq35"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|E| = 2|X| + 3k - 1$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq35.gif"/></alternatives></inline-formula>. Thus, any two binary networks in the <italic>k</italic>th tier on <italic>X</italic> have the same number of nodes and edges, not just the same number of reticulation nodes.</p></sec></sec><sec id="Sec4"><title>Rearrangement Moves</title><p id="Par22">As mentioned in the introduction, several analogues of rearrangement moves on trees have been defined for phylogenetic networks. Such rearrangement moves typically modify the head, the tail, or both the head and the tail of one edge. These moves are only allowed if they produce a valid phylogenetic network.<fig id="Fig2"><label>Fig. 2</label><caption><p>(Color figure online) A head move as described in Definition&#x000a0;<xref ref-type="sec" rid="FPar5">2.5</xref></p></caption><graphic xlink:href="11538_2018_452_Fig2_HTML" id="MO42"/></fig>
</p><sec id="FPar5"><title>Definition 2.5</title><p id="Par23">(<italic>Head move</italic>) Let <inline-formula id="IEq36"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e=(u,v)$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq36.gif"/></alternatives></inline-formula> and <italic>f</italic> be edges of a network. A head move of <italic>e</italic> to <italic>f</italic> consists of the following steps (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>):<list list-type="order"><list-item><p id="Par24">Deleting <italic>e</italic>;</p></list-item><list-item><p id="Par25"><italic>Subdividing</italic>
<italic>f</italic> with a new node <inline-formula id="IEq37"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v'$$\end{document}</tex-math><mml:math id="M76"><mml:msup><mml:mi>v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq37.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par26"><italic>Suppressing</italic> the indegree-1 outdegree-1 node <italic>v</italic>;</p></list-item><list-item><p id="Par27">Adding the edge <inline-formula id="IEq38"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(u,v')$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq38.gif"/></alternatives></inline-formula>.</p></list-item></list><italic>Subdividing</italic> an edge (<italic>u</italic>,&#x000a0;<italic>v</italic>) consists of deleting it and adding a node <italic>x</italic> and edges (<italic>u</italic>,&#x000a0;<italic>x</italic>) and (<italic>x</italic>,&#x000a0;<italic>v</italic>). <italic>Suppressing</italic> an indegree-1, outdegree-1 node <italic>x</italic> with parent <italic>u</italic> and child <italic>v</italic> consists in removing edges (<italic>u</italic>,&#x000a0;<italic>x</italic>) and (<italic>x</italic>,&#x000a0;<italic>v</italic>) and node <italic>x</italic>, and then adding an edge (<italic>u</italic>,&#x000a0;<italic>v</italic>).</p><p id="Par28">Head moves are only allowed if the resulting digraph is still a network, see Definition <xref ref-type="sec" rid="FPar1">2.1</xref>. We say that a head move is a <italic>distance-</italic><italic>d</italic> move if, after step 2, a shortest path from <italic>v</italic> to <inline-formula id="IEq39"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v'$$\end{document}</tex-math><mml:math id="M80"><mml:msup><mml:mi>v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq39.gif"/></alternatives></inline-formula> in the underlying undirected graph has length <inline-formula id="IEq40"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d+1$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq40.gif"/></alternatives></inline-formula> (number of edges in the path).</p></sec><sec id="FPar6"><title>Definition 2.6</title><p id="Par29">(<italic>Tail move</italic>) Let <inline-formula id="IEq41"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e=(u,v)$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq41.gif"/></alternatives></inline-formula> and <italic>f</italic> be edges of a network. A tail move of <italic>e</italic> to <italic>f</italic> consists of the following steps (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>):<list list-type="order"><list-item><p id="Par30">Deleting <italic>e</italic>;</p></list-item><list-item><p id="Par31">Subdividing <italic>f</italic> with a new node <inline-formula id="IEq42"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M86"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq42.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par32">Suppressing the indegree-1 outdegree-1 node <italic>u</italic>;</p></list-item><list-item><p id="Par33">Adding the edge <inline-formula id="IEq43"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(u',v)$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq43.gif"/></alternatives></inline-formula>.</p></list-item></list>Tail moves are only allowed if the resulting digraph is still a network, see Definition <xref ref-type="sec" rid="FPar1">2.1</xref>. We say that a tail move is a <italic>distance-</italic><italic>d</italic> move if, after step 2, a shortest path from <italic>u</italic> to <inline-formula id="IEq44"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M90"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq44.gif"/></alternatives></inline-formula> in the underlying undirected graph has length <inline-formula id="IEq45"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d+1$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq45.gif"/></alternatives></inline-formula>.</p><p>Note that head moves are only possible for <italic>reticulation edges</italic>, that is, edges in which the head is a reticulation. This means that these moves are, in our opinion, not necessarily part of a natural generalization of rSPR moves on trees, which consist only of tail moves.</p><p>Other generalizations of tree moves that have been proposed include head moves. For example, one <italic>rSPR move</italic> (Gambette et&#x000a0;al. <xref ref-type="bibr" rid="CR9">2017</xref>) on a network consists of one head move or one tail move, and one <italic>rNNI move</italic> consists of one distance-1 head move or one distance-1 tail move. Thus, it is clear that any tail move is an rSPR move, and any distance-1 tail move is an rNNI move. <italic>SNPR moves</italic> (Bordewich et&#x000a0;al. <xref ref-type="bibr" rid="CR4">2017a</xref>) are a variation on the theme: they are defined on networks where parallel edges are allowed, as a tail move or a deletion/addition of an edge. Because the deletion/addition of an edge is a vertical move, SNPR moves can change the reticulation number. Moreover, even if vertical moves are not permitted, the presence of parallel edges makes this restriction of SNPR moves still subtly different from the tail moves studied in this paper, see Definition <xref ref-type="sec" rid="FPar6">2.6</xref>. Nevertheless, Bordewich et al. do disallow parallel edges and vertical moves when studying <italic>tree-child networks</italic> (i.e. networks in which every internal node has at least a child that is not a reticulation) and they prove that any tier of tree-child networks is connected by tail moves if <inline-formula id="IEq46"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\le |X|-2$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq46.gif"/></alternatives></inline-formula>.<fig id="Fig3"><label>Fig. 3</label><caption><p>(Color figure online) A tail move as described in Definition&#x000a0;<xref ref-type="sec" rid="FPar6">2.6</xref></p></caption><graphic xlink:href="11538_2018_452_Fig3_HTML" id="MO43"/></fig>
</p><p>Rearrangement moves are also defined for <italic>unrooted networks</italic>: connected graphs with nodes of degree 1 (the leaves) and of degree 3, where the leaves are labelled bijectively with some set <italic>X</italic>, with&#x000a0;<inline-formula id="IEq47"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X|\ge 2$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02265;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq47.gif"/></alternatives></inline-formula>. The unrooted equivalents of rSPR moves and rNNI moves are called <italic>SPR moves</italic> and <italic>NNI moves</italic>, respectively (Huber et&#x000a0;al. <xref ref-type="bibr" rid="CR10">2016</xref>). An SPR move relocates one of the endpoints of an edge, like an rSPR move, with the condition that the resulting graph is still an unrooted network. An NNI move on an unrooted network is again the distance-1 version of an SPR move. Moreover, any rSPR move induces an SPR move on the underlying undirected graph, and similarly for rNNI and NNI moves. This means that, in some sense, any rSPR move is an SPR move, and any rNNI move is an NNI move. The converse is clearly not true: for example, an rSPR move that creates a directed cycle is invalid, but the induced SPR move on the undirected network may be valid. In addition, not every unrooted network is the underlying graph of a rooted network (see for example the network in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>). Such networks are unrootable and will be treated in more detail in Sect.&#x000a0;<xref rid="Sec11" ref-type="sec">4.4</xref>.<fig id="Fig4"><label>Fig. 4</label><caption><p>An unrootable unrooted network</p></caption><graphic xlink:href="11538_2018_452_Fig4_HTML" id="MO44"/></fig>
</p></sec></sec><sec id="Sec5"><title>Properties of Tail Moves</title><p id="Par37">From now on, we will mostly focus on tail moves (and hence on rooted networks). Note that not all edges of a network can be moved by a tail move; we introduce here the notion of <italic>movability</italic> of edges:</p><sec id="FPar7"><title>Definition 2.7</title><p id="Par38">Let <inline-formula id="IEq48"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e=(u,v)$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq48.gif"/></alternatives></inline-formula> be an edge in a network. Then, <italic>e</italic> is called <italic>non-movable</italic> if <italic>u</italic> is the root, if&#x000a0;<italic>u</italic> is a reticulation, or if the removal of <italic>e</italic> followed by suppressing&#x000a0;<italic>u</italic> creates parallel edges. Otherwise, <italic>e</italic> is called <italic>movable</italic>.</p><p>There is only one situation in which moving a tail of an edge&#x000a0;(<italic>u</italic>,&#x000a0;<italic>v</italic>) can result in parallel edges: when there exists an edge from the parent of <italic>u</italic> to the child of <italic>u</italic> other than <italic>v</italic>. The situation is characterized in the following definition:</p></sec><sec id="FPar8"><title>Definition 2.8</title><p id="Par40">Let <italic>N</italic> be a network and let <italic>x</italic>,&#x000a0;<italic>u</italic>,&#x000a0;<italic>y</italic> be nodes of <italic>N</italic>. We say <italic>x</italic>,&#x000a0;<italic>u</italic> and <italic>y</italic> form a <italic>triangle</italic> if there are edges (<italic>x</italic>,&#x000a0;<italic>u</italic>),&#x000a0;(<italic>u</italic>,&#x000a0;<italic>y</italic>) and (<italic>x</italic>,&#x000a0;<italic>y</italic>). The edge (<italic>x</italic>,&#x000a0;<italic>y</italic>) is called the <italic>long edge</italic> and (<italic>u</italic>,&#x000a0;<italic>y</italic>) is called the <italic>bottom edge</italic> of the triangle.</p><p>The interesting case in Definition&#x000a0;<xref ref-type="sec" rid="FPar8">2.8</xref> is when <italic>u</italic> is a tree node:</p></sec><sec id="FPar9"><title>Observation 2.9</title><p id="Par42">Let <italic>x</italic>,&#x000a0;<italic>u</italic> and <italic>y</italic> form a triangle in a network, and let <italic>v</italic> be the other child of <italic>u</italic>. The edge (<italic>u</italic>,&#x000a0;<italic>v</italic>) is non-movable because this move would create parallel edges from <italic>x</italic> to <italic>y</italic>. The edges (<italic>u</italic>,&#x000a0;<italic>y</italic>) and (<italic>x</italic>,&#x000a0;<italic>y</italic>) are movable, however, and if (<italic>u</italic>,&#x000a0;<italic>y</italic>) is moved sufficiently far up (i.e., destroying the triangle) then the new edge&#x000a0;(<italic>x</italic>,&#x000a0;<italic>v</italic>) is also movable.</p><p>The following observation is a direct consequence of Observation&#x000a0;<xref ref-type="sec" rid="FPar9">2.9</xref> and of the binary nature of the networks studied in this paper, and will play an important role in the arguments presented in the next section:</p></sec><sec id="FPar10"><title>Observation 2.10</title><p id="Par44">Let <italic>u</italic> be a tree node, then at least one of its child edges is movable because at most one of these has its tail in a triangle not containing its head.</p><p>Note that movability of an edge <italic>e</italic> does not imply that there exists a valid tail move for <italic>e</italic>: it only ensures that we can remove the tail without creating a clear violation of the definition of a network; it does not ensure that we can reattach it anywhere else. The following observation characterizes valid moves:</p></sec><sec id="FPar11"><title>Observation 2.11</title><p id="Par46">The tail of an edge <inline-formula id="IEq49"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e=(u,v)$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq49.gif"/></alternatives></inline-formula> can be moved to another edge <inline-formula id="IEq50"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f=(s,t)$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq50.gif"/></alternatives></inline-formula> if and only if the following conditions hold:<list list-type="order"><list-item><p id="Par47"><italic>e</italic> is movable;</p></list-item><list-item><p id="Par48"><italic>f</italic> is not below <italic>v</italic>;</p></list-item><list-item><p id="Par49"><inline-formula id="IEq51"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t\ne v$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq51.gif"/></alternatives></inline-formula>.</p></list-item></list>
</p><p>The first condition assures that the tail can be removed, the second that we do not create cycles, and the third that we do not create parallel edges. Note that these conditions imply that <italic>moving</italic> a (movable) edge <italic>up</italic> is allowed, i.e. moving an edge to another edge that is above it. In particular, a tail can always be moved to the root edge. However, note that it is not certain that this results in a non-isomorphic network.</p><p>The following lemma is related to the previous observation and will be used in the next section to find a tail that can be moved down &#x0201c;sufficiently far&#x0201d; (see Cases (b) and (d) in the proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar17">3.3</xref>):</p></sec><sec id="FPar12"><title>Lemma 2.12</title><p id="Par52">Let <italic>x</italic>,&#x000a0;<italic>y</italic> be nodes of a phylogenetic network <italic>N</italic> such that neither&#x000a0;<italic>x</italic> nor&#x000a0;<italic>y</italic> is an LCA of&#x000a0;<italic>x</italic> and&#x000a0;<italic>y</italic>. Then, for any LCA of <italic>x</italic> and <italic>y</italic>, one of the child edges of that LCA is a movable edge that is not both above <italic>x</italic> and above <italic>y</italic>.</p></sec><sec id="FPar13"><title>Proof</title><p id="Par53">Consider an arbitrary LCA <italic>u</italic> of <italic>x</italic> and <italic>y</italic>. This LCA is a tree node, and both child edges are above either <italic>x</italic> or <italic>y</italic>, but not both. Because at least one of the child edges of a tree node is movable (by Observation&#x000a0;<xref ref-type="sec" rid="FPar10">2.10</xref>), at least one of the child edges of the LCA has the desired properties. <inline-formula id="IEq52"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M106"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq52.gif"/></alternatives></inline-formula></p><p>We conclude this section by citing a result by Gambette et al. that implies connectivity of <italic>k</italic>th tiers (for any <inline-formula id="IEq53"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\ge 0$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq53.gif"/></alternatives></inline-formula>) via <italic>rNNI moves</italic>, which are equivalent to the combination of distance-1 head moves and distance-1 tail moves. This result is fundamental for our proof of connectivity of the tiers via tail moves.</p></sec><sec id="FPar14"><title>Theorem 2.13</title><p id="Par55">(Theorem&#x000a0;3.2 in Gambette et&#x000a0;al. <xref ref-type="bibr" rid="CR9">2017</xref>) Let <italic>N</italic> and <inline-formula id="IEq54"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M110"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq54.gif"/></alternatives></inline-formula> be two rooted binary phylogenetic networks belonging to the <italic>k</italic>th tier on a fixed leaf set <italic>X</italic>. Then, there exists a sequence of rNNI moves turning <italic>N</italic> into <inline-formula id="IEq55"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M112"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq55.gif"/></alternatives></inline-formula>.</p></sec></sec></sec><sec id="Sec6"><title>Head Moves Rewritten</title><p id="Par56">In this section, we present one of the main results of the paper: the connectivity of <italic>k</italic>th tiers using tail moves. Theorem&#x000a0;<xref ref-type="sec" rid="FPar14">2.13</xref> tells us that <italic>k</italic>th tiers are connected by rNNI moves. This means that, to prove our result, it suffices to show that any distance-1 head move can be replaced by a sequence of tail moves. To this end, we list in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref> all different cases where it is possible to perform a distance-1 head move. We observe the following:</p><sec id="FPar15"><title>Observation 3.1</title><p id="Par57">Each distance-1 head move is depicted as exactly one of the cases (a)&#x02013;(f) in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>. Note that the figure does not indicate whether <italic>u</italic>,&#x000a0;<italic>w</italic>,&#x000a0;<italic>x</italic>,&#x000a0;<italic>y</italic> are all distinct. There are only a few cases in which <italic>u</italic>,&#x000a0;<italic>w</italic>,&#x000a0;<italic>x</italic>,&#x000a0;<italic>y</italic> are not all distinct, and the head move is valid. If <inline-formula id="IEq56"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=y$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq56.gif"/></alternatives></inline-formula> in cases (a) and (b) or <inline-formula id="IEq57"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u=y$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq57.gif"/></alternatives></inline-formula> in cases (d) and (f), we have a valid move that results in a network that is isomorphic to the starting one. Having <inline-formula id="IEq58"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u=w$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq58.gif"/></alternatives></inline-formula> in case (a) is the only situation that results in a non-isomorphic network. All other possibilities lead to invalid moves.</p><p>
<fig id="Fig5"><label>Fig. 5</label><caption><p>(Color figure online) Illustration of all possible distance-1 head moves: <bold>a</bold> sideways movement below a tree node, <bold>b</bold> sideways movement above a reticulation, <bold>c</bold> downward movement through a tree node, <bold>d</bold> downward movement through a reticulation, <bold>e</bold> upward movement through a tree node, <bold>f</bold> upward movement through a reticulation</p></caption><graphic xlink:href="11538_2018_452_Fig5_HTML" id="MO45"/></fig>
</p></sec><sec id="FPar16"><title>Observation 3.2</title><p id="Par59">It is easy to see that moves (c) and (e) as well as moves (d) and (f) are each others reversions. Because all tail moves are also reversible, we only have to show that moves (a)&#x02013;(d) can be rewritten as a sequence of tail moves.</p><p>We treat all cases separately in the following lemma. We note here that, in the proof of this lemma, the sequences of tail moves used to mimic the different distance-1 head moves are often non-unique and possibly non-optimal. In the following, we shall use the convention of naming <inline-formula id="IEq59"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t'$$\end{document}</tex-math><mml:math id="M120"><mml:msup><mml:mi>t</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq59.gif"/></alternatives></inline-formula> the new tail node created when moving an edge with tail <italic>t</italic>.</p></sec><sec id="FPar17"><title>Lemma 3.3</title><p id="Par61">All distance-1 head moves can be substituted by a sequence of tail moves, except for the head move in the network depicted on the right in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>. For networks with more than one leaf, a sequence of length at most four can be found.</p></sec><sec id="FPar18"><title>Proof</title><p id="Par62">We analyse Cases (a)&#x02013;(d) separately.<graphic position="anchor" xlink:href="11538_2018_452_Figa_HTML" id="MO7"/> In light of Observation&#x000a0;<xref ref-type="sec" rid="FPar15">3.1</xref>, we distinguish two cases: <inline-formula id="IEq60"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u\ne w$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq60.gif"/></alternatives></inline-formula> and <inline-formula id="IEq61"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u=w$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq61.gif"/></alternatives></inline-formula>. All other nodes in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>a are distinct.<fig id="Fig6"><label>Fig. 6</label><caption><p>(Color figure online) Proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar17">3.3</xref>: the sequence of tail moves needed to simulate head move (a) in Case&#x000a0;1. Moving edges are dash-dotted before a move, and dashed after a move</p></caption><graphic xlink:href="11538_2018_452_Fig6_HTML" id="MO46"/></fig>
<fig id="Fig7"><label>Fig. 7</label><caption><p>(Color figure online) Proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar17">3.3</xref>: the sequence of tail moves used to simulate head move (a) in Case&#x000a0;2. The &#x0201c;extra tail&#x0201d; <italic>s</italic> of edge (<italic>s</italic>,&#x000a0;<italic>t</italic>) is used in the sequence of moves: (<italic>s</italic>,&#x000a0;<italic>t</italic>) to (<italic>z</italic>,&#x000a0;<italic>y</italic>), <inline-formula id="IEq62"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(s',y)$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq62.gif"/></alternatives></inline-formula> to (<italic>v</italic>,&#x000a0;<italic>x</italic>), <inline-formula id="IEq63"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(s'',x)$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq63.gif"/></alternatives></inline-formula> to (<italic>z</italic>,&#x000a0;<italic>t</italic>) and <inline-formula id="IEq64"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(s''',t)$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq64.gif"/></alternatives></inline-formula> to (<italic>p</italic>,&#x000a0;<italic>r</italic>). Here, <italic>p</italic> and <italic>r</italic> are, respectively, the parent and (other) child of <italic>s</italic> in the network before the head move</p></caption><graphic xlink:href="11538_2018_452_Fig7_HTML" id="MO47"/></fig>
</p><p id="Par63">
<list list-type="order"><list-item><p id="Par64"><inline-formula id="IEq65"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u\ne w}$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo mathvariant="bold">&#x02260;</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq65.gif"/></alternatives></inline-formula> In this case, we can use the sequence of tail moves depicted in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>, since the validity of the head move implies that the intermediate network does not contain directed cycles and parallel edges, as we shall show in the following.</p><p id="Par65">To see that the intermediate network has no directed cycles or parallel edges, we check that the tail move <italic>e</italic> to (<italic>v</italic>,&#x000a0;<italic>x</italic>) is valid. Note that <italic>e</italic> is movable (Definition&#x000a0;<xref ref-type="sec" rid="FPar7">2.7</xref>) because <italic>z</italic> is not the root nor a reticulation, and because <inline-formula id="IEq66"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u\ne w$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq66.gif"/></alternatives></inline-formula>, the removal of the tail of (<italic>z</italic>,&#x000a0;<italic>y</italic>) does not create parallel edges. Moreover, by Observation&#x000a0;<xref ref-type="sec" rid="FPar11">2.11</xref>, <italic>e</italic> can be moved to (<italic>v</italic>,&#x000a0;<italic>x</italic>) since (<italic>v</italic>,&#x000a0;<italic>x</italic>) is not below <italic>y</italic> (otherwise there would be a path from <italic>y</italic> to <italic>v</italic> in the network after the head move, which implies a directed cycle, and the head move could not be valid) and all nodes in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref> are distinct, so in particular <inline-formula id="IEq67"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x\ne y$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq67.gif"/></alternatives></inline-formula>.</p><p id="Par66">Thus, we can conclude that the intermediate network is valid, and therefore that the sequence of tail moves is valid.</p></list-item><list-item><p id="Par67"><inline-formula id="IEq68"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u=w}$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo mathvariant="bold">=</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq68.gif"/></alternatives></inline-formula> Note that <italic>u</italic> and <italic>v</italic> form a triangle together with the tree node <italic>z</italic>. In this situation, we cannot directly use the same sequence as before, since this sequence would create parallel edges. There are two conditions under which we can solve this problem:<list list-type="simple"><list-item><label>(i)</label><p id="Par68"><bold>There is a tree node somewhere not above</bold>
<inline-formula id="IEq69"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u}$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq69.gif"/></alternatives></inline-formula>, <bold>that is not</bold>
<italic>u</italic> or <italic>z</italic>. In this case, we &#x0201c;expand&#x0201d; the triangle. Instead of moving edge <italic>e</italic> directly, we first subdivide it by moving a tail to <italic>e</italic>. Then, we can apply the sequence of moves depicted in Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>. Barring the addition of the &#x0201c;extra tail&#x0201d;, the sequence of moves is quite similar to the moves in Case&#x000a0;1, and it can be shown in a similar way that this will not create cycles or parallel edges.</p></list-item><list-item><label>(ii)</label><p id="Par69"><bold>There is at least one vertex above</bold>
<inline-formula id="IEq70"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u}$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq70.gif"/></alternatives></inline-formula>
<bold>in addition to the root</bold> In this case we &#x0201c;destroy&#x0201d; the triangle. The bottom edge of the triangle (<italic>z</italic>,&#x000a0;<italic>v</italic>) is movable. If this edge is moved to the root (i.e. to the single edge incident to the root), the situation changes to that of Case&#x000a0;1. Thus, we can apply the sequence moves for that case, and move the bottom edge of the triangle back. Since (<italic>z</italic>,&#x000a0;<italic>v</italic>) is movable, moving up and down to/from the root are valid moves by Observation&#x000a0;<xref ref-type="sec" rid="FPar11">2.11</xref>.</p></list-item></list> If neither of these conditions hold, then there are no tree nodes except <italic>u</italic> and <italic>z</italic>. It follows by inspection that one of two possibilities holds - either <italic>x</italic> and <italic>y</italic> are the same reticulation node with a single leaf below it, or <italic>x</italic> and <italic>y</italic> are both leaves. The two possible networks are shown in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>. In the first network, no head move leads to a different (non-isomorphic) network. The only non-trivial case is the second network: here the type (a) head move cannot be substituted by a sequence of tail moves, because there is no valid tail move. Note that this network is excluded in the statement of the lemma.</p></list-item></list>
<fig id="Fig8"><label>Fig. 8</label><caption><p>(Color figure online) The networks for which there are no valid tail moves to simulate a distance-1 head move of type (a). Left: The network with one leaf and 2 reticulations where all valid head moves give isomorphic networks. Right: A network in which one non-trivial head move of type (a) is possible. There are no non-trivial tail moves for this network, therefore the head move cannot be simulated by tail moves</p></caption><graphic xlink:href="11538_2018_452_Fig8_HTML" id="MO10"/></fig>
<fig id="Fig9"><label>Fig. 9</label><caption><p>(Color figure online) Proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar17">3.3</xref>: the sequence of tail moves used to simulate head move (b). The moving edges are coloured, and the colouring of the edges is consistent throughout the sequence. The tail of the extra edge (light blue) is first moved to (<italic>x</italic>,&#x000a0;<italic>v</italic>), then the orange edge <inline-formula id="IEq71"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(s',v)$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq71.gif"/></alternatives></inline-formula> is moved to (<italic>y</italic>,&#x000a0;<italic>z</italic>), then the green edge <inline-formula id="IEq72"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(s'',z)$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq72.gif"/></alternatives></inline-formula> is moved to (<italic>x</italic>,&#x000a0;<italic>t</italic>), and finally the light blue edge <inline-formula id="IEq73"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(s''',t)$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq73.gif"/></alternatives></inline-formula> (the &#x0201c;extra tail&#x0201d;) is moved back</p></caption><graphic xlink:href="11538_2018_452_Fig9_HTML" id="MO48"/></fig>
<graphic position="anchor" xlink:href="11538_2018_452_Figb_HTML" id="MO12"/> The idea of this substitution is to use an extra tail again. The sequence we use is given in Fig.&#x000a0;<xref rid="Fig9" ref-type="fig">9</xref>. The main challenge is to find a usable tail: to use the sequence of moves, we need a tail that can be moved below either <italic>x</italic> or <italic>y</italic>. We will find this tail by considering an LCA <italic>s</italic> of <italic>x</italic> and <italic>y</italic> in Fig.&#x000a0;<xref rid="Fig9" ref-type="fig">9</xref>. We treat the following cases:<list list-type="order"><list-item><p id="Par70"><bold>The LCA</bold>
<inline-formula id="IEq74"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{s}$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq74.gif"/></alternatives></inline-formula>
<bold>is neither equal to</bold>
<inline-formula id="IEq75"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{x}$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq75.gif"/></alternatives></inline-formula>
<bold>nor to</bold>
<inline-formula id="IEq76"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{y}$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq76.gif"/></alternatives></inline-formula> At least one of the child edges (<italic>s</italic>,&#x000a0;<italic>t</italic>) of this LCA can be moved and it is not above both <italic>x</italic> and <italic>y</italic> (by Lemma&#x000a0;<xref ref-type="sec" rid="FPar12">2.12</xref>). Hence, we can move this tail down below one of these nodes (by Observation&#x000a0;<xref ref-type="sec" rid="FPar11">2.11</xref>).<list list-type="simple"><list-item><label>(i)</label><p id="Par71"><bold>The movable edge</bold>
<inline-formula id="IEq77"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{(s,t)}$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq77.gif"/></alternatives></inline-formula>
<bold>is above</bold>
<inline-formula id="IEq78"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{y}$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq78.gif"/></alternatives></inline-formula> If <italic>t</italic> is not directly below <italic>x</italic>, we can use the proposed sequence of moves. However, if <italic>t</italic> is directly below <italic>x</italic>, then <italic>x</italic> is above <italic>y</italic>, and <italic>x</italic> is the only LCA of <italic>x</italic> and <italic>y</italic>. This contradicts our assumption that <inline-formula id="IEq79"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s\ne x$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mi>s</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq79.gif"/></alternatives></inline-formula> and we can certainly use the sequence of moves depicted in Fig.&#x000a0;<xref rid="Fig9" ref-type="fig">9</xref>.</p></list-item><list-item><label>(ii)</label><p id="Par72"><bold>The movable edge</bold>
<inline-formula id="IEq80"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{(s,t)}$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq80.gif"/></alternatives></inline-formula>
<bold>is above</bold>
<inline-formula id="IEq81"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{x}$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq81.gif"/></alternatives></inline-formula> The symmetry of the situation and the reversibility of the sequence of moves lets us reduce to the previous case: We do the sequence of moves in reverse order, where we switch the labels of <italic>x</italic> and <italic>y</italic>.</p></list-item></list>
</p></list-item><list-item><p id="Par73"><inline-formula id="IEq82"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{x}$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq82.gif"/></alternatives></inline-formula>
<bold>is an LCA of</bold>&#x000a0;<inline-formula id="IEq83"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{x}$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq83.gif"/></alternatives></inline-formula>
<bold>and</bold>&#x000a0;<inline-formula id="IEq84"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{y}$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq84.gif"/></alternatives></inline-formula> Because <italic>x</italic> is the LCA of <italic>x</italic> and <italic>y</italic> and there is no path from <italic>v</italic> to <italic>y</italic> (such a path would imply a path from <italic>z</italic> to <italic>y</italic> and thus a cycle in the starting network), <italic>x</italic> must be a tree node. Let the children of <italic>x</italic> be <italic>v</italic> and <italic>t</italic>, and let the parent of <italic>x</italic> be <italic>p</italic>. Two cases are possible:<list list-type="simple"><list-item><label>(i)</label><p id="Par74"><inline-formula id="IEq85"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{(x,v)}$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq85.gif"/></alternatives></inline-formula>
<bold>is movable</bold> In this case, we can use a similar sequence as before, but without the addition of a tail: (<italic>x</italic>,&#x000a0;<italic>v</italic>) to (<italic>y</italic>,&#x000a0;<italic>z</italic>), <inline-formula id="IEq86"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(x',z)$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq86.gif"/></alternatives></inline-formula> to (<italic>p</italic>,&#x000a0;<italic>t</italic>).</p></list-item><list-item><label>(ii)</label><p id="Par75"><inline-formula id="IEq87"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{(x,v)}$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq87.gif"/></alternatives></inline-formula>
<bold>is not movable</bold> In this case, <italic>p</italic>,&#x000a0;<italic>x</italic> and <italic>t</italic> form a triangle. We employ a strategy to break the triangle similar to the one used for Case&#x000a0;2 of head move (a).<list list-type="bullet"><list-item><label/><p id="Par76"><bold>There is a node above the triangle besides the root</bold> Moving the long edge of the triangle to the root, we can reduce the problem to Case&#x000a0;2i. Then, we apply the same sequence of tail moves and move the long edge back to the original position.</p></list-item><list-item><label/><p id="Par77"><bold>The node above the triangle is the root</bold> If there is no node above the triangle, then there is a tree node not above <italic>x</italic>, for example an <inline-formula id="IEq88"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathrm{LCA}}}$$\end{document}</tex-math><mml:math id="M178"><mml:mi mathvariant="normal">LCA</mml:mi></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq88.gif"/></alternatives></inline-formula>
<italic>s</italic> of <italic>u</italic> and <italic>y</italic>. It is easy to see that <italic>s</italic> cannot be above <italic>x</italic> since the parent node of <italic>x</italic> has children <italic>x</italic> and <italic>t</italic> and its parent is the root. Note that <italic>s</italic> can only be a reticulation if it has outdegreee 1, i.e. if <inline-formula id="IEq89"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s=u$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq89.gif"/></alternatives></inline-formula> or <inline-formula id="IEq90"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s=y$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq90.gif"/></alternatives></inline-formula>. Suppose that <inline-formula id="IEq91"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s=u$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq91.gif"/></alternatives></inline-formula>. Since <italic>v</italic> and <italic>z</italic> are reticulations, this would mean that <italic>y</italic> is below <italic>z</italic>, which implies the existence of a directed cycle in the original network, a clear contradiction. A similar reasoning shows that <inline-formula id="IEq92"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s=y$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq92.gif"/></alternatives></inline-formula> leads to a contradiction. Hence, <italic>s</italic> is a tree node and one of the child edges can be moved up to (<italic>x</italic>,&#x000a0;<italic>t</italic>). This puts us in the situation of Case&#x000a0;2i, and we can use the corresponding sequence of moves. After the corresponding sequence of moves, we move the edge back to its original position.</p></list-item></list>
</p></list-item></list>
</p></list-item><list-item><p id="Par78"><inline-formula id="IEq93"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{y}$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq93.gif"/></alternatives></inline-formula>
<bold>is an LCA of</bold>
<inline-formula id="IEq94"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{x}$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq94.gif"/></alternatives></inline-formula>
<bold>and</bold>&#x000a0;<inline-formula id="IEq95"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{y}$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq95.gif"/></alternatives></inline-formula> Like in Case&#x000a0;1ii, we use the symmetry of the situation and the reversibility of the moves to reduce to the previous case (Case&#x000a0;2) by doing the moves in reverse order where the labels of <italic>x</italic> and <italic>y</italic> are switched.</p></list-item></list>In all sequences we gave, no directed cycles were created, because such cycles imply directed cycles in one of the networks before and after the head move. We conclude that any allowed head move of type (b) can be substituted by a sequence of tail moves.<graphic position="anchor" xlink:href="11538_2018_452_Figc_HTML" id="MO13"/> This is the easiest case, as we can substitute the head move by exactly one tail move: (<italic>z</italic>,&#x000a0;<italic>y</italic>) to (<italic>w</italic>,&#x000a0;<italic>v</italic>), with labelling as in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>. Parallel edges and directed cycles cannot occur because there are no intermediate networks.<graphic position="anchor" xlink:href="11538_2018_452_Figd_HTML" id="MO14"/> This one is the most complicated distance-1 head move to translate in tail moves. We exploit the following symmetry of this case: relabelling <inline-formula id="IEq96"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u\leftrightarrow y$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:mi>u</mml:mi><mml:mo stretchy="false">&#x02194;</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq96.gif"/></alternatives></inline-formula> and <inline-formula id="IEq97"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v\leftrightarrow z$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">&#x02194;</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq97.gif"/></alternatives></inline-formula> transforms the network before the head move into the network after the head move. Let us start with the easiest case:<list list-type="order"><list-item><p id="Par79"><bold>Either</bold>
<inline-formula id="IEq98"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{(u,v)}$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq98.gif"/></alternatives></inline-formula>
<bold>or</bold>
<inline-formula id="IEq99"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{(y,z)}$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq99.gif"/></alternatives></inline-formula>
<bold>is movable</bold> First assume that (<italic>u</italic>,&#x000a0;<italic>v</italic>) is movable and that the other child and parent of <italic>u</italic> are <italic>p</italic> and <italic>t</italic>, we move (<italic>u</italic>,&#x000a0;<italic>v</italic>) to (<italic>y</italic>,&#x000a0;<italic>z</italic>) and then <inline-formula id="IEq100"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(u',z)$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq100.gif"/></alternatives></inline-formula> to (<italic>p</italic>,&#x000a0;<italic>t</italic>). The case that (<italic>y</italic>,&#x000a0;<italic>z</italic>) is movable can be tackled in a similar way thanks to the reversibility of tail moves and the symmetry given above.</p></list-item><list-item><p id="Par80"><bold>Either</bold>
<inline-formula id="IEq101"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u}$$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq101.gif"/></alternatives></inline-formula>
<bold>or</bold>
<inline-formula id="IEq102"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{y}$$\end{document}</tex-math><mml:math id="M206"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq102.gif"/></alternatives></inline-formula>
<bold>is a tree node</bold> If one of them is movable, we are in the previous situation, otherwise we mimic the approach of Case&#x000a0;2ii of head move (b). Assume without loss of generality that <italic>y</italic> is at the side of a triangle. We either move the bottom edge of the triangle up to the root, or we use a child edge of a tree node to subdivide the bottom edge of the triangle. In the latter case, we can take, for example, <inline-formula id="IEq103"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathrm{LCA}}}(x,u)$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:mi mathvariant="normal">LCA</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq103.gif"/></alternatives></inline-formula>, which is a tree node because <italic>x</italic> and <italic>u</italic> are both directly above <italic>v</italic>, and which is not above <italic>y</italic>.</p></list-item><list-item><p id="Par81"><bold>Both</bold>
<inline-formula id="IEq104"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u}$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq104.gif"/></alternatives></inline-formula>
<bold>and</bold>
<inline-formula id="IEq105"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{y}$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq105.gif"/></alternatives></inline-formula>
<bold>are reticulations</bold> In this case, we try to recreate the situation of Case&#x000a0;1 by adding a tail on one of the edges (<italic>u</italic>,&#x000a0;<italic>v</italic>) and (<italic>y</italic>,&#x000a0;<italic>z</italic>).<list list-type="simple"><list-item><label>(i)</label><p id="Par82"><bold>The network contains at least two leaves</bold> We can pick two distinct leaves, at least one of which is below <italic>w</italic>. Suppose first that both of these leaves are below <italic>w</italic>, then an LCA of the leaves is also below the reticulation and one of its child edges can be used as the extra tail by Lemma&#x000a0;<xref ref-type="sec" rid="FPar12">2.12</xref>. If only one of the leaves is below the reticulation, then any LCA of the leaves has one edge that is not above <italic>w</italic>. If this edge can be moved, we can directly use it; otherwise, we first move the lower part of the triangle to the root, and then still use this edge.</p></list-item><list-item><label>(ii)</label><p id="Par83"><bold>The network contains one leaf, and</bold>
<inline-formula id="IEq106"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq106.gif"/></alternatives></inline-formula>
<bold>is not this leaf</bold> The only leaf is below the lowest reticulation <italic>r</italic> of the network, which is not <italic>z</italic>. Let the parents of <italic>r</italic> be <inline-formula id="IEq107"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_1$$\end{document}</tex-math><mml:math id="M216"><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq107.gif"/></alternatives></inline-formula> and <inline-formula id="IEq108"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_2$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq108.gif"/></alternatives></inline-formula>. To find a usable extra tail, we use the same argument as in Case&#x000a0;3i but now with <inline-formula id="IEq109"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_1$$\end{document}</tex-math><mml:math id="M220"><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq109.gif"/></alternatives></inline-formula> and <inline-formula id="IEq110"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_2$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq110.gif"/></alternatives></inline-formula> instead of the two leaves. Note that <inline-formula id="IEq111"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathrm{LCA}}}(p_1,p_2)$$\end{document}</tex-math><mml:math id="M224"><mml:mrow><mml:mi mathvariant="normal">LCA</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq111.gif"/></alternatives></inline-formula> is a tree node because both <inline-formula id="IEq112"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_1$$\end{document}</tex-math><mml:math id="M226"><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq112.gif"/></alternatives></inline-formula> and <inline-formula id="IEq113"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_2$$\end{document}</tex-math><mml:math id="M228"><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq113.gif"/></alternatives></inline-formula> are directly above <italic>r</italic>.</p></list-item><list-item><label>(iii)</label><p id="Par84"><bold>The only leaf in the network is</bold>
<inline-formula id="IEq114"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{w}$$\end{document}</tex-math><mml:math id="M230"><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq114.gif"/></alternatives></inline-formula> We have not found a way to solve this case &#x02018;locally&#x02019; as we did before. Go up from these reticulations to some nearest tree node. The idea, then, is to use one tree edge to do the switch as in the case we discussed previously (Fig.&#x000a0;<xref rid="Fig10" ref-type="fig">10</xref>).</p><p id="Par85">The result is that all reticulations on the path to the nearest tree node move with the tree edge. These reticulations can be moved back to the other side using the previously discussed moves. In particular, we move the heads sideways using head move (b), and then we move them up using head move (f) where the main reticulation (<italic>z</italic>) is not the lowest reticulation in the network.</p></list-item></list>
</p></list-item></list><inline-formula id="IEq115"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M232"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq115.gif"/></alternatives></inline-formula></p><p>
<fig id="Fig10"><label>Fig. 10</label><caption><p>(Color figure online) Proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar17">3.3</xref>: the sequence of tail moves used to simulate head move (d) in Case&#x000a0;3iii. All reticulations on the path to the nearest tree node above it move with it to the other side</p></caption><graphic xlink:href="11538_2018_452_Fig10_HTML" id="MO49"/></fig>
</p><p>Using Theorem&#x000a0;<xref ref-type="sec" rid="FPar14">2.13</xref> and the above lemma, we directly get the connectivity result for tail moves.</p></sec><sec id="FPar19"><title>Theorem 3.4</title><p id="Par88">Let <italic>N</italic> and <inline-formula id="IEq116"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M234"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq116.gif"/></alternatives></inline-formula> be two networks in the <italic>k</italic>th tier on&#x000a0;<italic>X</italic>. Then there exists a sequence of tail moves turning <italic>N</italic> into <inline-formula id="IEq117"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M236"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq117.gif"/></alternatives></inline-formula>, except if <inline-formula id="IEq118"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=1$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq118.gif"/></alternatives></inline-formula> and <inline-formula id="IEq119"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X|=2$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq119.gif"/></alternatives></inline-formula>.</p></sec></sec><sec id="Sec7"><title>Distances and Diameter Bounds</title><p id="Par89">Given a class of moves <inline-formula id="IEq120"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {M}$$\end{document}</tex-math><mml:math id="M242"><mml:mi mathvariant="script">M</mml:mi></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq120.gif"/></alternatives></inline-formula> and two networks <inline-formula id="IEq121"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N,N'$$\end{document}</tex-math><mml:math id="M244"><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq121.gif"/></alternatives></inline-formula>, define the <inline-formula id="IEq122"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {M}$$\end{document}</tex-math><mml:math id="M246"><mml:mi mathvariant="script">M</mml:mi></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq122.gif"/></alternatives></inline-formula><italic>-distance</italic>
<inline-formula id="IEq123"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{\mathcal {M}}(N,N')$$\end{document}</tex-math><mml:math id="M248"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="script">M</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq123.gif"/></alternatives></inline-formula> to be the minimum length of a sequence of moves in <inline-formula id="IEq124"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {M}$$\end{document}</tex-math><mml:math id="M250"><mml:mi mathvariant="script">M</mml:mi></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq124.gif"/></alternatives></inline-formula> turning <italic>N</italic> into <inline-formula id="IEq125"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M252"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq125.gif"/></alternatives></inline-formula>, or <inline-formula id="IEq126"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\infty $$\end{document}</tex-math><mml:math id="M254"><mml:mi>&#x0221e;</mml:mi></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq126.gif"/></alternatives></inline-formula> if no such sequence exists. Also, denote by <inline-formula id="IEq127"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta _k^{\mathcal {M}}(n)$$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="script">M</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq127.gif"/></alternatives></inline-formula> the <italic>diameter</italic> of the <italic>k</italic>th tier with <italic>n</italic> leaves with respect to <inline-formula id="IEq128"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {M}$$\end{document}</tex-math><mml:math id="M258"><mml:mi mathvariant="script">M</mml:mi></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq128.gif"/></alternatives></inline-formula>; that is, the maximum value of <inline-formula id="IEq129"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{\mathcal {M}}(N,N')$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="script">M</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq129.gif"/></alternatives></inline-formula> over any pair of networks <inline-formula id="IEq130"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N,N'$$\end{document}</tex-math><mml:math id="M262"><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq130.gif"/></alternatives></inline-formula> belonging to the <italic>k</italic>th tier on a fixed leaf set <italic>X</italic> with <inline-formula id="IEq131"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X|=n$$\end{document}</tex-math><mml:math id="M264"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq131.gif"/></alternatives></inline-formula>. In this section, we mostly focus on the tail distance, studying its diameter and the complexity of computing such a distance between two networks. Interestingly enough, the findings on the tail distance will also yield results for the rNNI, rSPR and SPR distances. Indeed, tail moves are related to other types of moves such as rNNI and rSPR, which has implications for their induced metrics and diameters. There are obvious bounds when a class of moves contains another class of moves, by which we mean that each move of the second class is equivalent to a move of the first class (e.g. <inline-formula id="IEq132"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {rNNI}\subseteq \text {rSPR}$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mtext>rNNI</mml:mtext><mml:mo>&#x02286;</mml:mo><mml:mtext>rSPR</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq132.gif"/></alternatives></inline-formula>). Then, we have that <inline-formula id="IEq133"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {M}\subseteq \mathcal {M}'$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo>&#x02286;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq133.gif"/></alternatives></inline-formula> implies <inline-formula id="IEq134"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta _k^{\mathcal {M}}(n)\ge \varDelta _k^{\mathcal {M}'}(n)$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="script">M</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02265;</mml:mo><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq134.gif"/></alternatives></inline-formula>. This observation will be very useful in the rest of this section.</p><sec id="Sec8"><title>The Complexity of Computing the Tail Distance and the rSPR Distance</title><p id="Par90">In this subsection, we prove that computation of the tail and rSPR distance between two networks is NP-hard:</p><sec id="FPar20"><title>Theorem 4.1</title><p id="Par91">Computing the rSPR distance and the tail distance between two networks is NP-hard for any tier of phylogenetic network space.</p><p>To prove the theorem, we shall introduce several new concepts.</p></sec><sec id="FPar21"><title>Definition 4.2</title><p id="Par93">A <italic>mycorrhizal forest</italic><xref ref-type="fn" rid="Fn1">1</xref> with leaves <italic>X</italic> is a network <inline-formula id="IEq135"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=(\mathcal {T},R)$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq135.gif"/></alternatives></inline-formula> defined by:<list list-type="bullet"><list-item><p id="Par95">A set of <italic>t</italic> trees <inline-formula id="IEq136"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {T} = (T_1,\ldots ,T_t)$$\end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq136.gif"/></alternatives></inline-formula> with leaf sets&#x000a0;<inline-formula id="IEq137"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_1,\ldots ,X_t$$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq137.gif"/></alternatives></inline-formula>, respectively (the <italic>tree components</italic>),</p></list-item><list-item><p id="Par96">A rooted binary phylogenetic network <italic>R</italic> (the <italic>root component</italic>) with <italic>t</italic> leaves&#x000a0;<inline-formula id="IEq138"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_1,\ldots ,x_t$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq138.gif"/></alternatives></inline-formula>, such that deleting all these leaves and the root makes&#x000a0;<italic>R</italic> biconnected.</p></list-item></list>The mycorrhizal forest is the network where the root edge of <inline-formula id="IEq139"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M280"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq139.gif"/></alternatives></inline-formula> is identified with the edge leading to leaf <inline-formula id="IEq140"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_i$$\end{document}</tex-math><mml:math id="M282"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq140.gif"/></alternatives></inline-formula> in <italic>R</italic> (see Fig.&#x000a0;<xref rid="Fig11" ref-type="fig">11</xref> for an example). A mycorrhizal forest with&#x000a0;<inline-formula id="IEq141"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=1$$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq141.gif"/></alternatives></inline-formula> is called a <italic>mycorrhizal tree</italic>.</p><p id="Par97">If <italic>M</italic> and <inline-formula id="IEq142"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M'$$\end{document}</tex-math><mml:math id="M286"><mml:msup><mml:mi>M</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq142.gif"/></alternatives></inline-formula> are mycorrhizal forests with tree components&#x000a0;<inline-formula id="IEq143"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_1,\ldots ,T_t$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq143.gif"/></alternatives></inline-formula> and&#x000a0;<inline-formula id="IEq144"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'_1,\ldots ,T'_t$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mi>t</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq144.gif"/></alternatives></inline-formula>, respectively, both having leaf sets <inline-formula id="IEq145"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_1,\ldots ,X_t$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq145.gif"/></alternatives></inline-formula>, then we denote <inline-formula id="IEq146"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{\text {treeSPR}}(M,M'):=\sum _{i}d_{\text {rSPR}}(T_i,T_i')$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>treeSPR</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>M</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mtext>rSPR</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq146.gif"/></alternatives></inline-formula>, which is the distance induced by rSPR moves only within tree components (treeSPR moves).</p><p>
<fig id="Fig11"><label>Fig. 11</label><caption><p>From left to right: a mycorrhizal forest <inline-formula id="IEq147"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=(\mathcal {T},R)$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq147.gif"/></alternatives></inline-formula>, its tree components <inline-formula id="IEq148"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {T} = (T_1,T_2)$$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq148.gif"/></alternatives></inline-formula> and the root component <italic>R</italic></p></caption><graphic xlink:href="11538_2018_452_Fig11_HTML" id="MO50"/></fig>
</p></sec><sec id="FPar22"><title>Definition 4.3</title><p id="Par99">Let <italic>T</italic> be a tree on <italic>X</italic> and let <inline-formula id="IEq149"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y\subseteq X\cup \{\rho \}$$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>&#x02286;</mml:mo><mml:mi>X</mml:mi><mml:mo>&#x0222a;</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq149.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq150"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho $$\end{document}</tex-math><mml:math id="M302"><mml:mi>&#x003c1;</mml:mi></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq150.gif"/></alternatives></inline-formula> denotes the root of <italic>T</italic>. Then, <inline-formula id="IEq151"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T|_Y$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>Y</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq151.gif"/></alternatives></inline-formula> is the subtree of <italic>T</italic> induced by <italic>Y</italic>: Take the union of all shortest paths between nodes of <italic>Y</italic>, and then suppress all indegree-1 outdegree-1 vertices.</p></sec><sec id="FPar23"><title>Definition 4.4</title><p id="Par100">Let <inline-formula id="IEq152"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {T}=\{T_i\}_{1\le i\le t}$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq152.gif"/></alternatives></inline-formula> be a set of trees with labels <italic>X</italic>. An <italic>agreement forest</italic> (AF) of <inline-formula id="IEq153"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {T}$$\end{document}</tex-math><mml:math id="M308"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq153.gif"/></alternatives></inline-formula> is a partition <inline-formula id="IEq154"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{X_j\}$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq154.gif"/></alternatives></inline-formula> of <inline-formula id="IEq155"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X\cup \{\rho \}$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x0222a;</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq155.gif"/></alternatives></inline-formula> (where <inline-formula id="IEq156"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho $$\end{document}</tex-math><mml:math id="M314"><mml:mi>&#x003c1;</mml:mi></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq156.gif"/></alternatives></inline-formula> denotes the root), such that all <inline-formula id="IEq157"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i|_{X_j}$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq157.gif"/></alternatives></inline-formula> are isomorphic for each fixed <italic>j</italic> and all <inline-formula id="IEq158"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i|_{X_j}$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq158.gif"/></alternatives></inline-formula> are node-disjoint for a fixed <italic>i</italic>.</p></sec><sec id="FPar24"><title>Lemma 4.5</title><p id="Par101">Let <italic>M</italic> and <inline-formula id="IEq159"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M'$$\end{document}</tex-math><mml:math id="M320"><mml:msup><mml:mi>M</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq159.gif"/></alternatives></inline-formula> be two mycorrhizal forests with the same root component and tree sets <inline-formula id="IEq160"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{T_i\}_{1\le i\le n}$$\end{document}</tex-math><mml:math id="M322"><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq160.gif"/></alternatives></inline-formula> and <inline-formula id="IEq161"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{T'_i\}_{1\le i\le n}$$\end{document}</tex-math><mml:math id="M324"><mml:msub><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq161.gif"/></alternatives></inline-formula> with leaf sets <inline-formula id="IEq162"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_i=X_i'$$\end{document}</tex-math><mml:math id="M326"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq162.gif"/></alternatives></inline-formula>. Then,<disp-formula id="Equ2"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} d_\mathrm{tail}(M,M')=d_\mathrm{rSPR}(M,M')=d_\mathrm{treeSPR}(M,M'). \end{aligned}$$\end{document}</tex-math><mml:math id="M328" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">tail</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>M</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">rSPR</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>M</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">treeSPR</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>M</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2018_452_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>
</p></sec><sec id="FPar25"><title>Proof</title><p id="Par102">Clearly, <inline-formula id="IEq163"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_\mathrm{rSPR}\le d_\mathrm{treeSPR}$$\end{document}</tex-math><mml:math id="M330"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">rSPR</mml:mi></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">treeSPR</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq163.gif"/></alternatives></inline-formula> and <inline-formula id="IEq164"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_\mathrm{tail}\le d_\mathrm{treeSPR}$$\end{document}</tex-math><mml:math id="M332"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">tail</mml:mi></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">treeSPR</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq164.gif"/></alternatives></inline-formula>, because a treeSPR sequence is also a tail sequence and a rSPR sequence.</p><p id="Par103">Now suppose we have a sequence of tail moves or rSPR moves from <italic>M</italic> to <inline-formula id="IEq165"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M'$$\end{document}</tex-math><mml:math id="M334"><mml:msup><mml:mi>M</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq165.gif"/></alternatives></inline-formula>. Because both networks have all reticulations in the root component, deleting all moving edges gives agreement forests on the trees <inline-formula id="IEq166"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M336"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq166.gif"/></alternatives></inline-formula> and <inline-formula id="IEq167"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i'$$\end{document}</tex-math><mml:math id="M338"><mml:msubsup><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq167.gif"/></alternatives></inline-formula> for each <italic>i</italic>. These agreement forests each have size larger than or equal to the corresponding maximum agreement forest (MAF). Because the rSPR distance is equal to the size of a MAF (Bordewich and Semple <xref ref-type="bibr" rid="CR3">2005</xref>) minus one, we conclude that the number of moves in the rSPR or tail sequence is larger than or equal to the needed number of moves in all treeSPR sequences between <inline-formula id="IEq168"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M340"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq168.gif"/></alternatives></inline-formula> and <inline-formula id="IEq169"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i'$$\end{document}</tex-math><mml:math id="M342"><mml:msubsup><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq169.gif"/></alternatives></inline-formula> together. Hence, we conclude <inline-formula id="IEq170"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_\mathrm{rSPR}\ge d_\mathrm{treeSPR}$$\end{document}</tex-math><mml:math id="M344"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">rSPR</mml:mi></mml:msub><mml:mo>&#x02265;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">treeSPR</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq170.gif"/></alternatives></inline-formula> and <inline-formula id="IEq171"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_\mathrm{tail}\ge d_\mathrm{treeSPR}$$\end{document}</tex-math><mml:math id="M346"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">tail</mml:mi></mml:msub><mml:mo>&#x02265;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">treeSPR</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq171.gif"/></alternatives></inline-formula>. <inline-formula id="IEq172"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M348"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq172.gif"/></alternatives></inline-formula></p><p>Theorem&#x000a0;<xref ref-type="sec" rid="FPar20">4.1</xref> follows directly from this lemma, because computing treeSPR distance is NP-hard (Bordewich and Semple <xref ref-type="bibr" rid="CR3">2005</xref>). Indeed, for any <italic>k</italic> we can let <italic>R</italic> be a network with <italic>k</italic> reticulations that becomes biconnected after deleting the root and all leaves. Then calculating the rSPR or tail distance between <inline-formula id="IEq173"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M = (\mathcal {T},R)$$\end{document}</tex-math><mml:math id="M350"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq173.gif"/></alternatives></inline-formula> and <inline-formula id="IEq174"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M' = (\mathcal {T}',R)$$\end{document}</tex-math><mml:math id="M352"><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq174.gif"/></alternatives></inline-formula> is equivalent to calculating the rSPR distance between <inline-formula id="IEq175"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i$$\end{document}</tex-math><mml:math id="M354"><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq175.gif"/></alternatives></inline-formula> and <inline-formula id="IEq176"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_i'$$\end{document}</tex-math><mml:math id="M356"><mml:msubsup><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq176.gif"/></alternatives></inline-formula> for each <italic>i</italic>, and <italic>M</italic> and <inline-formula id="IEq177"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M'$$\end{document}</tex-math><mml:math id="M358"><mml:msup><mml:mi>M</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq177.gif"/></alternatives></inline-formula> are in the <italic>k</italic>th tier.</p></sec></sec><sec id="Sec9"><title>The Diameter of Tail and rSPR Moves</title><p id="Par105">In this subsection, we study the diameter bounds of tail move operations, i.e. the maximum value of <inline-formula id="IEq178"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_\mathrm{Tail}(N,N')$$\end{document}</tex-math><mml:math id="M360"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">Tail</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq178.gif"/></alternatives></inline-formula> over all possible networks <italic>N</italic> and <inline-formula id="IEq179"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M362"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq179.gif"/></alternatives></inline-formula> with the same reticulation number. In the following, we shall use the convention of naming <inline-formula id="IEq180"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_1$$\end{document}</tex-math><mml:math id="M364"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq180.gif"/></alternatives></inline-formula> the new tail node created when moving an edge with tail <italic>t</italic>, and naming <inline-formula id="IEq181"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{i+1}$$\end{document}</tex-math><mml:math id="M366"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq181.gif"/></alternatives></inline-formula> the node created when moving an edge with tail <inline-formula id="IEq182"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_i$$\end{document}</tex-math><mml:math id="M368"><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq182.gif"/></alternatives></inline-formula>.</p><p id="Par106">Given a network <italic>N</italic> and a set of nodes <italic>Y</italic> in <italic>N</italic>, we say <italic>Y</italic> is <italic>downward-closed</italic> if for any <inline-formula id="IEq183"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u \in Y$$\end{document}</tex-math><mml:math id="M370"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq183.gif"/></alternatives></inline-formula>, every child of <italic>u</italic> is in <italic>Y</italic>.</p><sec id="FPar26"><title>Lemma 4.6</title><p id="Par107">Let <italic>N</italic> and <inline-formula id="IEq184"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M372"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq184.gif"/></alternatives></inline-formula> be networks in the <italic>k</italic>th tier on <italic>X</italic> such that <italic>N</italic> and <inline-formula id="IEq185"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M374"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq185.gif"/></alternatives></inline-formula> are not the networks depicted in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>. Let <inline-formula id="IEq186"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y \subseteq V(N), Y' \subseteq V(N')$$\end{document}</tex-math><mml:math id="M376"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>&#x02286;</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02286;</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq186.gif"/></alternatives></inline-formula> be downward-closed sets of nodes such that <inline-formula id="IEq187"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L(N)\subseteq Y, L(N') \subseteq Y'$$\end{document}</tex-math><mml:math id="M378"><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02286;</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02286;</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq187.gif"/></alternatives></inline-formula>, and <italic>N</italic>[<italic>Y</italic>] is isomorphic to <inline-formula id="IEq188"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y']}$$\end{document}</tex-math><mml:math id="M380"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq188.gif"/></alternatives></inline-formula>. Then there is a sequence of at most <inline-formula id="IEq189"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N\setminus Y|$$\end{document}</tex-math><mml:math id="M382"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq189.gif"/></alternatives></inline-formula> tail moves turning <italic>N</italic> into <inline-formula id="IEq190"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M384"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq190.gif"/></alternatives></inline-formula>.</p></sec><sec id="FPar27"><title>Proof</title><p id="Par108">We first observe that any isomorphism between <italic>N</italic>[<italic>Y</italic>] and <inline-formula id="IEq191"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y']}$$\end{document}</tex-math><mml:math id="M386"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq191.gif"/></alternatives></inline-formula> maps reticulations (tree nodes) of <italic>N</italic> to reticulations (tree nodes) of <inline-formula id="IEq192"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M388"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq192.gif"/></alternatives></inline-formula>. Indeed, every node in <italic>N</italic>[<italic>Y</italic>] is mapped to a node in <inline-formula id="IEq193"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y']}$$\end{document}</tex-math><mml:math id="M390"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq193.gif"/></alternatives></inline-formula> of the same outdegree, and the tree nodes are exactly those with outdegree 2. It follows that <italic>Y</italic> and <inline-formula id="IEq194"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M392"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq194.gif"/></alternatives></inline-formula> contain the same number of reticulations and the same number of tree nodes. As <italic>N</italic> and <inline-formula id="IEq195"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M394"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq195.gif"/></alternatives></inline-formula> have the same number of nodes and reticulations by Observation&#x000a0;<xref ref-type="sec" rid="FPar4">2.4</xref>, it also follows that <inline-formula id="IEq196"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V(N)\setminus Y$$\end{document}</tex-math><mml:math id="M396"><mml:mrow><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq196.gif"/></alternatives></inline-formula> and <inline-formula id="IEq197"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V(N')\setminus Y'$$\end{document}</tex-math><mml:math id="M398"><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq197.gif"/></alternatives></inline-formula> contain the same number of reticulations and the same number of tree nodes.</p><p id="Par109">We prove the claim by induction on <inline-formula id="IEq198"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|N \setminus Y|$$\end{document}</tex-math><mml:math id="M400"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq198.gif"/></alternatives></inline-formula>. If <inline-formula id="IEq199"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|N \setminus Y| = 0$$\end{document}</tex-math><mml:math id="M402"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq199.gif"/></alternatives></inline-formula>, then <inline-formula id="IEq200"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N = N[Y]$$\end{document}</tex-math><mml:math id="M404"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq200.gif"/></alternatives></inline-formula>, which is isomorphic to <inline-formula id="IEq201"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y']} = N'$$\end{document}</tex-math><mml:math id="M406"><mml:mrow><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq201.gif"/></alternatives></inline-formula>, and so there is a sequence of 0 moves turning <italic>N</italic> into <inline-formula id="IEq202"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M408"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq202.gif"/></alternatives></inline-formula>.</p><p id="Par110">If <inline-formula id="IEq203"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|N \setminus Y| = 1$$\end{document}</tex-math><mml:math id="M410"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq203.gif"/></alternatives></inline-formula>, then as <italic>Y</italic> is downward-closed, <inline-formula id="IEq204"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \setminus Y$$\end{document}</tex-math><mml:math id="M412"><mml:mrow><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq204.gif"/></alternatives></inline-formula> consists of <inline-formula id="IEq205"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _N$$\end{document}</tex-math><mml:math id="M414"><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq205.gif"/></alternatives></inline-formula>, the root of <italic>N</italic>, and by a similar argument <inline-formula id="IEq206"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N '\setminus Y'$$\end{document}</tex-math><mml:math id="M416"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq206.gif"/></alternatives></inline-formula> consists of <inline-formula id="IEq207"><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _{N'}$$\end{document}</tex-math><mml:math id="M418"><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq207.gif"/></alternatives></inline-formula>. Let <italic>x</italic> be the only child of <inline-formula id="IEq208"><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _N$$\end{document}</tex-math><mml:math id="M420"><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq208.gif"/></alternatives></inline-formula>, and note that in <italic>N</italic>[<italic>Y</italic>], <italic>x</italic> is the only node of indegree 0, outdegree 2. It follows that in the isomorphism between <italic>N</italic>[<italic>Y</italic>] and <inline-formula id="IEq209"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y']}$$\end{document}</tex-math><mml:math id="M422"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq209.gif"/></alternatives></inline-formula>, <italic>x</italic> is mapped to the only node in <inline-formula id="IEq210"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y']}$$\end{document}</tex-math><mml:math id="M424"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq210.gif"/></alternatives></inline-formula> of indegree 0, outdegree 2, and this node is necessarily the child of <inline-formula id="IEq211"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _{N'}$$\end{document}</tex-math><mml:math id="M426"><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq211.gif"/></alternatives></inline-formula>. Thus, we can extend the isomorphism between <italic>N</italic>[<italic>Y</italic>] and <inline-formula id="IEq212"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y']}$$\end{document}</tex-math><mml:math id="M428"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq212.gif"/></alternatives></inline-formula> to an isomorphism between <italic>N</italic> and <inline-formula id="IEq213"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M430"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq213.gif"/></alternatives></inline-formula> by letting <inline-formula id="IEq214"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _N$$\end{document}</tex-math><mml:math id="M432"><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq214.gif"/></alternatives></inline-formula> be mapped to <inline-formula id="IEq215"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _{N'}$$\end{document}</tex-math><mml:math id="M434"><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq215.gif"/></alternatives></inline-formula>. Thus, again there is a sequence of 0 moves turning <italic>N</italic> into <inline-formula id="IEq216"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M436"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq216.gif"/></alternatives></inline-formula>.<fig id="Fig12"><label>Fig. 12</label><caption><p>Proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar26">4.6</xref>, Case&#x000a0;1a: If <inline-formula id="IEq217"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M438"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq217.gif"/></alternatives></inline-formula> is a lowest reticulation in <inline-formula id="IEq218"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N' \setminus Y'$$\end{document}</tex-math><mml:math id="M440"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq218.gif"/></alternatives></inline-formula> with child <inline-formula id="IEq219"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M442"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq219.gif"/></alternatives></inline-formula>, and the node <inline-formula id="IEq220"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in Y$$\end{document}</tex-math><mml:math id="M444"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq220.gif"/></alternatives></inline-formula> corresponding to <inline-formula id="IEq221"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M446"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq221.gif"/></alternatives></inline-formula> has a reticulation parent <italic>z</italic> in <inline-formula id="IEq222"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \setminus Y$$\end{document}</tex-math><mml:math id="M448"><mml:mrow><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq222.gif"/></alternatives></inline-formula>, then we may add <italic>z</italic> to <italic>Y</italic> and <inline-formula id="IEq223"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M450"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq223.gif"/></alternatives></inline-formula> to <inline-formula id="IEq224"><alternatives><tex-math id="M451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M452"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq224.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="11538_2018_452_Fig12_HTML" id="MO51"/></fig>
</p><p id="Par111">So now assume that <inline-formula id="IEq225"><alternatives><tex-math id="M453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|N \setminus Y| &#x0003e; 1$$\end{document}</tex-math><mml:math id="M454"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq225.gif"/></alternatives></inline-formula>. We consider three cases, which split into further subcases. In what follows, a <italic>lowest node of</italic>
<inline-formula id="IEq226"><alternatives><tex-math id="M455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \setminus Y$$\end{document}</tex-math><mml:math id="M456"><mml:mrow><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq226.gif"/></alternatives></inline-formula> (<italic>or</italic>
<inline-formula id="IEq227"><alternatives><tex-math id="M457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N' \setminus Y'$$\end{document}</tex-math><mml:math id="M458"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq227.gif"/></alternatives></inline-formula>) is a node <italic>u</italic> in <inline-formula id="IEq228"><alternatives><tex-math id="M459">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V(N)\setminus Y$$\end{document}</tex-math><mml:math id="M460"><mml:mrow><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq228.gif"/></alternatives></inline-formula> (or <inline-formula id="IEq229"><alternatives><tex-math id="M461">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V(N')\setminus Y'$$\end{document}</tex-math><mml:math id="M462"><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq229.gif"/></alternatives></inline-formula>) such that all descendants of <italic>u</italic> are in <italic>Y</italic> (<inline-formula id="IEq230"><alternatives><tex-math id="M463">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M464"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq230.gif"/></alternatives></inline-formula>). Note that such a node always exists, as <italic>Y</italic> (<inline-formula id="IEq231"><alternatives><tex-math id="M465">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M466"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq231.gif"/></alternatives></inline-formula>) is downward-closed and <inline-formula id="IEq232"><alternatives><tex-math id="M467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L(N)\subseteq Y$$\end{document}</tex-math><mml:math id="M468"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02286;</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq232.gif"/></alternatives></inline-formula> (<inline-formula id="IEq233"><alternatives><tex-math id="M469">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L(N') \subseteq Y'$$\end{document}</tex-math><mml:math id="M470"><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02286;</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq233.gif"/></alternatives></inline-formula>).<list list-type="order"><list-item><p id="Par112"><bold>There exists a lowest node</bold>
<inline-formula id="IEq234"><alternatives><tex-math id="M471">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u}'$$\end{document}</tex-math><mml:math id="M472"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq234.gif"/></alternatives></inline-formula>
<bold>of</bold>
<inline-formula id="IEq235"><alternatives><tex-math id="M473">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{N' \setminus Y'}$$\end{document}</tex-math><mml:math id="M474"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mo mathvariant="bold">&#x02032;</mml:mo></mml:msup><mml:mo lspace="0.15em" mathvariant="bold" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo mathvariant="bold">&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq235.gif"/></alternatives></inline-formula>
<bold>such that</bold>
<inline-formula id="IEq236"><alternatives><tex-math id="M475">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u'}$$\end{document}</tex-math><mml:math id="M476"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo mathvariant="bold">&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq236.gif"/></alternatives></inline-formula>
<bold>is a reticulation</bold> In this case, let <inline-formula id="IEq237"><alternatives><tex-math id="M477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M478"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq237.gif"/></alternatives></inline-formula> be the single child of <inline-formula id="IEq238"><alternatives><tex-math id="M479">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M480"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq238.gif"/></alternatives></inline-formula>. Then, <inline-formula id="IEq239"><alternatives><tex-math id="M481">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M482"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq239.gif"/></alternatives></inline-formula> is in <inline-formula id="IEq240"><alternatives><tex-math id="M483">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M484"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq240.gif"/></alternatives></inline-formula>, and therefore there exists a node <inline-formula id="IEq241"><alternatives><tex-math id="M485">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in Y$$\end{document}</tex-math><mml:math id="M486"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq241.gif"/></alternatives></inline-formula> such that <italic>x</italic> is mapped to <inline-formula id="IEq242"><alternatives><tex-math id="M487">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M488"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq242.gif"/></alternatives></inline-formula> by the isomorphism between <italic>N</italic>[<italic>Y</italic>] and <inline-formula id="IEq243"><alternatives><tex-math id="M489">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y']}$$\end{document}</tex-math><mml:math id="M490"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq243.gif"/></alternatives></inline-formula>. Furthermore, <italic>x</italic> has the same number of parents in <italic>N</italic> as <inline-formula id="IEq244"><alternatives><tex-math id="M491">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M492"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq244.gif"/></alternatives></inline-formula> does in <inline-formula id="IEq245"><alternatives><tex-math id="M493">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M494"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq245.gif"/></alternatives></inline-formula> (because the networks are binary and <italic>x</italic> has the same number of children in <italic>N</italic> as <inline-formula id="IEq246"><alternatives><tex-math id="M495">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M496"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq246.gif"/></alternatives></inline-formula> does in <inline-formula id="IEq247"><alternatives><tex-math id="M497">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M498"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq247.gif"/></alternatives></inline-formula> by the isomorphism between <italic>N</italic>[<italic>Y</italic>] and <inline-formula id="IEq248"><alternatives><tex-math id="M499">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y']}$$\end{document}</tex-math><mml:math id="M500"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq248.gif"/></alternatives></inline-formula>), and the same number of parents in <italic>Y</italic> as <inline-formula id="IEq249"><alternatives><tex-math id="M501">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M502"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq249.gif"/></alternatives></inline-formula> has in <inline-formula id="IEq250"><alternatives><tex-math id="M503">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M504"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq250.gif"/></alternatives></inline-formula>. Thus, <italic>x</italic> has at least one parent <italic>z</italic> such that <italic>z</italic> is not in <italic>Y</italic>.</p><p id="Par113">We now split into two subcases:<list list-type="alpha-lower"><list-item><p id="Par114"><inline-formula id="IEq251"><alternatives><tex-math id="M505">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{z}$$\end{document}</tex-math><mml:math id="M506"><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq251.gif"/></alternatives></inline-formula>
<bold>is a reticulation</bold> in this case, let <inline-formula id="IEq252"><alternatives><tex-math id="M507">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_1 = Y \cup \{z\}$$\end{document}</tex-math><mml:math id="M508"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>Y</mml:mi><mml:mo>&#x0222a;</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq252.gif"/></alternatives></inline-formula> and <inline-formula id="IEq253"><alternatives><tex-math id="M509">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_1' = Y' \cup \{u'\}$$\end{document}</tex-math><mml:math id="M510"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x0222a;</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq253.gif"/></alternatives></inline-formula>, and extend the isomorphism between <italic>N</italic>[<italic>Y</italic>] and <inline-formula id="IEq254"><alternatives><tex-math id="M511">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y']}$$\end{document}</tex-math><mml:math id="M512"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq254.gif"/></alternatives></inline-formula> to an isomorphism between <inline-formula id="IEq255"><alternatives><tex-math id="M513">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N[Y_1]$$\end{document}</tex-math><mml:math id="M514"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq255.gif"/></alternatives></inline-formula> and <inline-formula id="IEq256"><alternatives><tex-math id="M515">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y_1']}$$\end{document}</tex-math><mml:math id="M516"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq256.gif"/></alternatives></inline-formula>, by letting <italic>z</italic> be mapped to <inline-formula id="IEq257"><alternatives><tex-math id="M517">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M518"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq257.gif"/></alternatives></inline-formula> (see Fig.&#x000a0;<xref rid="Fig12" ref-type="fig">12</xref>). We now have that <inline-formula id="IEq258"><alternatives><tex-math id="M519">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_1$$\end{document}</tex-math><mml:math id="M520"><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq258.gif"/></alternatives></inline-formula> and <inline-formula id="IEq259"><alternatives><tex-math id="M521">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_1'$$\end{document}</tex-math><mml:math id="M522"><mml:msubsup><mml:mi>Y</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq259.gif"/></alternatives></inline-formula> are downward-closed sets of nodes such that <inline-formula id="IEq260"><alternatives><tex-math id="M523">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N[Y_1]$$\end{document}</tex-math><mml:math id="M524"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq260.gif"/></alternatives></inline-formula> is isomorphic to <inline-formula id="IEq261"><alternatives><tex-math id="M525">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N[Y_1']$$\end{document}</tex-math><mml:math id="M526"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq261.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq262"><alternatives><tex-math id="M527">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L(N)\subseteq Y_1, L(N') \subseteq Y_1'$$\end{document}</tex-math><mml:math id="M528"><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02286;</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02286;</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq262.gif"/></alternatives></inline-formula>. Furthermore, <inline-formula id="IEq263"><alternatives><tex-math id="M529">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|N \setminus Y_1| = |N \setminus Y|-1$$\end{document}</tex-math><mml:math id="M530"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq263.gif"/></alternatives></inline-formula>. Thus, by the inductive hypothesis, there is a sequence of <inline-formula id="IEq264"><alternatives><tex-math id="M531">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N \setminus Y_1| = 3|N \setminus Y|-3$$\end{document}</tex-math><mml:math id="M532"><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq264.gif"/></alternatives></inline-formula> tail moves turning <italic>N</italic> into <inline-formula id="IEq265"><alternatives><tex-math id="M533">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M534"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq265.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par115"><inline-formula id="IEq266"><alternatives><tex-math id="M535">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{z}$$\end{document}</tex-math><mml:math id="M536"><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq266.gif"/></alternatives></inline-formula>
<bold>is not a reticulation</bold> then <italic>z</italic> cannot be the root of <italic>N</italic> (as this would imply <inline-formula id="IEq267"><alternatives><tex-math id="M537">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|N \setminus Y| = 1$$\end{document}</tex-math><mml:math id="M538"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq267.gif"/></alternatives></inline-formula>), so <italic>z</italic> is a tree node. It follows that the edge (<italic>z</italic>,&#x000a0;<italic>x</italic>) is movable, unless the removal of (<italic>z</italic>,&#x000a0;<italic>x</italic>) followed by suppressing <italic>z</italic> creates parallel edges.<list list-type="simple"><list-item><label>(i)</label><p id="Par116"><inline-formula id="IEq268"><alternatives><tex-math id="M539">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{(z,x)}$$\end{document}</tex-math><mml:math id="M540"><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq268.gif"/></alternatives></inline-formula>
<bold>is movable</bold> In this case, let <italic>u</italic> be any reticulation in <inline-formula id="IEq269"><alternatives><tex-math id="M541">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \setminus Y$$\end{document}</tex-math><mml:math id="M542"><mml:mrow><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq269.gif"/></alternatives></inline-formula> (such a node must exist, as <inline-formula id="IEq270"><alternatives><tex-math id="M543">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M544"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq270.gif"/></alternatives></inline-formula> exists and <inline-formula id="IEq271"><alternatives><tex-math id="M545">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \setminus Y$$\end{document}</tex-math><mml:math id="M546"><mml:mrow><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq271.gif"/></alternatives></inline-formula>, <inline-formula id="IEq272"><alternatives><tex-math id="M547">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N' \setminus Y'$$\end{document}</tex-math><mml:math id="M548"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq272.gif"/></alternatives></inline-formula> have the same number of reticulations). Let <italic>v</italic> be the child of <italic>u</italic> (which may be in <italic>Y</italic>), and observe that the edge (<italic>u</italic>,&#x000a0;<italic>v</italic>) is not below <italic>x</italic> (as <inline-formula id="IEq273"><alternatives><tex-math id="M549">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in Y$$\end{document}</tex-math><mml:math id="M550"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq273.gif"/></alternatives></inline-formula> and <inline-formula id="IEq274"><alternatives><tex-math id="M551">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u \notin Y$$\end{document}</tex-math><mml:math id="M552"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&#x02209;</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq274.gif"/></alternatives></inline-formula>). If <inline-formula id="IEq275"><alternatives><tex-math id="M553">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v = x$$\end{document}</tex-math><mml:math id="M554"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq275.gif"/></alternatives></inline-formula>, then <italic>u</italic> is a reticulation parent of <italic>x</italic> that is not in <italic>Y</italic>, and by substituting <italic>v</italic> for <italic>z</italic>, we have case&#x000a0;1a. So we may assume <inline-formula id="IEq276"><alternatives><tex-math id="M555">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v \ne x$$\end{document}</tex-math><mml:math id="M556"><mml:mrow><mml:mi>v</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq276.gif"/></alternatives></inline-formula>. Then, it follows from Observation&#x000a0;<xref ref-type="sec" rid="FPar11">2.11</xref> that the tail of (<italic>z</italic>,&#x000a0;<italic>x</italic>) can be moved to (<italic>u</italic>,&#x000a0;<italic>v</italic>). Let <inline-formula id="IEq277"><alternatives><tex-math id="M557">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M558"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq277.gif"/></alternatives></inline-formula> be the network derived from <italic>N</italic> by applying this tail move, and let <inline-formula id="IEq278"><alternatives><tex-math id="M559">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_1$$\end{document}</tex-math><mml:math id="M560"><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq278.gif"/></alternatives></inline-formula> be the new node created by subdividing (<italic>u</italic>,&#x000a0;<italic>v</italic>) during the tail move (see Fig.&#x000a0;<xref rid="Fig13" ref-type="fig">13</xref>).</p><p id="Par117">Thus, <inline-formula id="IEq279"><alternatives><tex-math id="M561">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M562"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq279.gif"/></alternatives></inline-formula> contains the edges <inline-formula id="IEq280"><alternatives><tex-math id="M563">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(u,z_1), (z_1,v), (z_1,x)$$\end{document}</tex-math><mml:math id="M564"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq280.gif"/></alternatives></inline-formula>. (Note that if <italic>z</italic> is immediately below <italic>u</italic> in <italic>N</italic> i.e. <inline-formula id="IEq281"><alternatives><tex-math id="M565">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z=v$$\end{document}</tex-math><mml:math id="M566"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq281.gif"/></alternatives></inline-formula>, then in fact <inline-formula id="IEq282"><alternatives><tex-math id="M567">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1 = N$$\end{document}</tex-math><mml:math id="M568"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq282.gif"/></alternatives></inline-formula>. In this case, we may skip the move from <italic>N</italic> to <inline-formula id="IEq283"><alternatives><tex-math id="M569">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M570"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq283.gif"/></alternatives></inline-formula>, and in what follows substitute <italic>z</italic> for <inline-formula id="IEq284"><alternatives><tex-math id="M571">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_1$$\end{document}</tex-math><mml:math id="M572"><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq284.gif"/></alternatives></inline-formula>.)</p><p id="Par118">Note that <inline-formula id="IEq285"><alternatives><tex-math id="M573">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_1,v)$$\end{document}</tex-math><mml:math id="M574"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq285.gif"/></alternatives></inline-formula> is movable in <inline-formula id="IEq286"><alternatives><tex-math id="M575">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M576"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq286.gif"/></alternatives></inline-formula>, since the parent <italic>u</italic> of <italic>z</italic> is a reticulation node, and therefore deleting <inline-formula id="IEq287"><alternatives><tex-math id="M577">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_1,v)$$\end{document}</tex-math><mml:math id="M578"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq287.gif"/></alternatives></inline-formula> and suppressing <inline-formula id="IEq288"><alternatives><tex-math id="M579">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_1$$\end{document}</tex-math><mml:math id="M580"><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq288.gif"/></alternatives></inline-formula> cannot create parallel edges. Let <italic>w</italic> be one of the parents of <italic>u</italic> in <inline-formula id="IEq289"><alternatives><tex-math id="M581">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M582"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq289.gif"/></alternatives></inline-formula>. Then, the tail of <inline-formula id="IEq290"><alternatives><tex-math id="M583">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_1,v)$$\end{document}</tex-math><mml:math id="M584"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq290.gif"/></alternatives></inline-formula> can be moved to (<italic>w</italic>,&#x000a0;<italic>u</italic>) (as <inline-formula id="IEq291"><alternatives><tex-math id="M585">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u \ne v$$\end{document}</tex-math><mml:math id="M586"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq291.gif"/></alternatives></inline-formula>, and (<italic>w</italic>,&#x000a0;<italic>u</italic>) is not below <italic>v</italic> as this would imply a cycle in <inline-formula id="IEq292"><alternatives><tex-math id="M587">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M588"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq292.gif"/></alternatives></inline-formula>).</p><p id="Par119">So now let <inline-formula id="IEq293"><alternatives><tex-math id="M589">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_2$$\end{document}</tex-math><mml:math id="M590"><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq293.gif"/></alternatives></inline-formula> be the network derived from <inline-formula id="IEq294"><alternatives><tex-math id="M591">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M592"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq294.gif"/></alternatives></inline-formula> by applying this tail move (again see Fig.&#x000a0;<xref rid="Fig13" ref-type="fig">13</xref>). In <inline-formula id="IEq295"><alternatives><tex-math id="M593">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_2$$\end{document}</tex-math><mml:math id="M594"><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq295.gif"/></alternatives></inline-formula>, the reticulation <italic>u</italic> is the parent of <italic>x</italic> (as <inline-formula id="IEq296"><alternatives><tex-math id="M595">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_1$$\end{document}</tex-math><mml:math id="M596"><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq296.gif"/></alternatives></inline-formula> was suppressed), and thus Case&#x000a0;1a applies to <inline-formula id="IEq297"><alternatives><tex-math id="M597">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_2$$\end{document}</tex-math><mml:math id="M598"><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq297.gif"/></alternatives></inline-formula> and <inline-formula id="IEq298"><alternatives><tex-math id="M599">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M600"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq298.gif"/></alternatives></inline-formula>. Therefore, there exists a sequence of <inline-formula id="IEq299"><alternatives><tex-math id="M601">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N \setminus Y|-3$$\end{document}</tex-math><mml:math id="M602"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq299.gif"/></alternatives></inline-formula> tail moves turning <inline-formula id="IEq300"><alternatives><tex-math id="M603">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_2$$\end{document}</tex-math><mml:math id="M604"><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq300.gif"/></alternatives></inline-formula> into <inline-formula id="IEq301"><alternatives><tex-math id="M605">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M606"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq301.gif"/></alternatives></inline-formula>. As <inline-formula id="IEq302"><alternatives><tex-math id="M607">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_2$$\end{document}</tex-math><mml:math id="M608"><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq302.gif"/></alternatives></inline-formula> is derived from <italic>N</italic> by two tail moves, there exists a sequence of <inline-formula id="IEq303"><alternatives><tex-math id="M609">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N \setminus Y|-1$$\end{document}</tex-math><mml:math id="M610"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq303.gif"/></alternatives></inline-formula> tail moves turning <italic>N</italic> into <inline-formula id="IEq304"><alternatives><tex-math id="M611">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M612"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq304.gif"/></alternatives></inline-formula>.</p></list-item><list-item><label>(ii)</label><p id="Par120"><bold>The removal of</bold>
<inline-formula id="IEq305"><alternatives><tex-math id="M613">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{(z,x)}$$\end{document}</tex-math><mml:math id="M614"><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq305.gif"/></alternatives></inline-formula>
<bold>followed by suppressing</bold>
<inline-formula id="IEq306"><alternatives><tex-math id="M615">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{z}$$\end{document}</tex-math><mml:math id="M616"><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq306.gif"/></alternatives></inline-formula>
<bold>creates parallel edges</bold> Then, there exists nodes <inline-formula id="IEq307"><alternatives><tex-math id="M617">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c \ne x, d \ne x$$\end{document}</tex-math><mml:math id="M618"><mml:mrow><mml:mi>c</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq307.gif"/></alternatives></inline-formula> such that <italic>c</italic>,&#x000a0;<italic>d</italic>,&#x000a0;<italic>z</italic> form a triangle with long edge (<italic>c</italic>,&#x000a0;<italic>d</italic>). As <italic>c</italic> has outdegree 2 it is not the root of <italic>N</italic>, so let <italic>b</italic> denote the parent of <italic>c</italic>. <list list-type="simple"><list-item><label>(A)</label><p id="Par121"><inline-formula id="IEq308"><alternatives><tex-math id="M619">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{b}$$\end{document}</tex-math><mml:math id="M620"><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq308.gif"/></alternatives></inline-formula>
<bold>is not the root of</bold>
<inline-formula id="IEq309"><alternatives><tex-math id="M621">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{N}$$\end{document}</tex-math><mml:math id="M622"><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq309.gif"/></alternatives></inline-formula> In this case, let <italic>a</italic> be a parent of <italic>b</italic> in <italic>N</italic>. Observe that the edge (<italic>a</italic>,&#x000a0;<italic>b</italic>) is not below <italic>d</italic> and that <inline-formula id="IEq310"><alternatives><tex-math id="M623">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b \ne d$$\end{document}</tex-math><mml:math id="M624"><mml:mrow><mml:mi>b</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq310.gif"/></alternatives></inline-formula>. Furthermore, (<italic>c</italic>,&#x000a0;<italic>d</italic>) is movable since <italic>c</italic> is not a reticulation or the root. Moreover, there is no edge (<italic>b</italic>,&#x000a0;<italic>z</italic>): The existence of such an edge would imply that <italic>z</italic> has indegree 2, as the edge (<italic>c</italic>,&#x000a0;<italic>z</italic>) exists, but this is not possible because <italic>z</italic> is a tree node with child edges (<italic>z</italic>,&#x000a0;<italic>x</italic>) and (<italic>z</italic>,&#x000a0;<italic>c</italic>). It follows that the tail of (<italic>c</italic>,&#x000a0;<italic>d</italic>) can be moved to (<italic>a</italic>,&#x000a0;<italic>b</italic>) (again using Observation&#x000a0;<xref ref-type="sec" rid="FPar11">2.11</xref>). Let <inline-formula id="IEq311"><alternatives><tex-math id="M625">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M626"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq311.gif"/></alternatives></inline-formula> be the network derived from <italic>N</italic> by applying this tail move (see Fig.&#x000a0;<xref rid="Fig14" ref-type="fig">14</xref>).</p><p id="Par122">Observe that in <inline-formula id="IEq312"><alternatives><tex-math id="M627">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M628"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq312.gif"/></alternatives></inline-formula> we now have the edge (<italic>b</italic>,&#x000a0;<italic>z</italic>) (as <italic>c</italic> was suppressed), and still have the edge (<italic>z</italic>,&#x000a0;<italic>d</italic>) but not the edge (<italic>b</italic>,&#x000a0;<italic>d</italic>) (such an edge would mean <italic>d</italic> has indegree 3, as the edges (<italic>c</italic>,&#x000a0;<italic>d</italic>) and (<italic>z</italic>,&#x000a0;<italic>d</italic>) exist). Thus, deleting (<italic>z</italic>,&#x000a0;<italic>x</italic>) and suppressing <italic>z</italic> will not create parallel edges, and so (<italic>z</italic>,&#x000a0;<italic>x</italic>) is movable in <inline-formula id="IEq313"><alternatives><tex-math id="M629">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M630"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq313.gif"/></alternatives></inline-formula>. Thus Case&#x000a0;1(b)i applies to <inline-formula id="IEq314"><alternatives><tex-math id="M631">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M632"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq314.gif"/></alternatives></inline-formula> and <inline-formula id="IEq315"><alternatives><tex-math id="M633">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M634"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq315.gif"/></alternatives></inline-formula>, and so there exists a sequence of <inline-formula id="IEq316"><alternatives><tex-math id="M635">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N \setminus Y|-1$$\end{document}</tex-math><mml:math id="M636"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq316.gif"/></alternatives></inline-formula> tail moves turning <inline-formula id="IEq317"><alternatives><tex-math id="M637">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M638"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq317.gif"/></alternatives></inline-formula> into <inline-formula id="IEq318"><alternatives><tex-math id="M639">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M640"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq318.gif"/></alternatives></inline-formula>. As <inline-formula id="IEq319"><alternatives><tex-math id="M641">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M642"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq319.gif"/></alternatives></inline-formula> is derived from <italic>N</italic> by a single tail move, there exists a sequence of <inline-formula id="IEq320"><alternatives><tex-math id="M643">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N \setminus Y|$$\end{document}</tex-math><mml:math id="M644"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq320.gif"/></alternatives></inline-formula> tail moves turning <italic>N</italic> into <inline-formula id="IEq321"><alternatives><tex-math id="M645">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M646"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq321.gif"/></alternatives></inline-formula>.</p></list-item><list-item><label>(B)</label><p id="Par123"><inline-formula id="IEq322"><alternatives><tex-math id="M647">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{b}$$\end{document}</tex-math><mml:math id="M648"><mml:mrow><mml:mi mathvariant="bold-italic">b</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq322.gif"/></alternatives></inline-formula>
<bold>is the root of</bold>
<inline-formula id="IEq323"><alternatives><tex-math id="M649">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{N}$$\end{document}</tex-math><mml:math id="M650"><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq323.gif"/></alternatives></inline-formula> In this case, we observe that if <inline-formula id="IEq324"><alternatives><tex-math id="M651">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d \in Y$$\end{document}</tex-math><mml:math id="M652"><mml:mrow><mml:mi>d</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq324.gif"/></alternatives></inline-formula> then every reticulation in <italic>N</italic> is in <italic>Y</italic>. This contradicts the fact that <inline-formula id="IEq325"><alternatives><tex-math id="M653">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\setminus Y$$\end{document}</tex-math><mml:math id="M654"><mml:mrow><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq325.gif"/></alternatives></inline-formula> and <inline-formula id="IEq326"><alternatives><tex-math id="M655">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'\setminus Y'$$\end{document}</tex-math><mml:math id="M656"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq326.gif"/></alternatives></inline-formula> contain the same number of reticulations. Therefore, we may assume that <inline-formula id="IEq327"><alternatives><tex-math id="M657">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d \notin Y$$\end{document}</tex-math><mml:math id="M658"><mml:mrow><mml:mi>d</mml:mi><mml:mo>&#x02209;</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq327.gif"/></alternatives></inline-formula>. Then, we may proceed as follows. Let <inline-formula id="IEq328"><alternatives><tex-math id="M659">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_3$$\end{document}</tex-math><mml:math id="M660"><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq328.gif"/></alternatives></inline-formula> be the network derived from <italic>Y</italic> by moving the <italic>head</italic> of (<italic>c</italic>,&#x000a0;<italic>d</italic>) to (<italic>z</italic>,&#x000a0;<italic>x</italic>). As this is a head move of type (a), it can be replaced with a sequence of four tail moves (see Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>). However, we show that in this particular case, it is possible to replace it with a sequence of only three tail moves.</p><p id="Par124">Let <italic>e</italic> be the child of <italic>d</italic> in <italic>N</italic>. We note that if <italic>e</italic> is a reticulation, then one of the parents of <italic>e</italic> is a descendant of <italic>x</italic> (otherwise <italic>z</italic>,&#x000a0;<italic>b</italic> or <italic>c</italic> would have to be a parent of <italic>e</italic>, which is not the case). Thus if <italic>e</italic> is a reticulation then it is a descendant of <italic>x</italic>, and by a similar argument if <italic>x</italic> is a reticulation then it is a descendant of <italic>e</italic>. Thus, we may assume that one of <italic>e</italic>,&#x000a0;<italic>x</italic> is not a reticulation, and that furthermore at least one of <italic>e</italic>,&#x000a0;<italic>x</italic> is a tree node (if both are leaves, then <italic>N</italic> and <inline-formula id="IEq329"><alternatives><tex-math id="M661">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M662"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq329.gif"/></alternatives></inline-formula> are the network depicted in the second part of Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref> and the network resulting from applying head move (a) in this network; and if one of <italic>e</italic> and <italic>x</italic> is a reticulation, then the other must be an ancestor of it, and is therefore a tree node).</p><p id="Par125">Our approach in this case will be to &#x0201c;swap&#x0201d; the positions of <italic>e</italic> and <italic>x</italic> via a series of tail moves. We will assume that <italic>x</italic> is a tree node, with children <italic>s</italic> and <italic>t</italic>. (The case that <italic>e</italic> is a tree node can be handled in a similar manner.) Then we apply the sequence of tail moves depicted in Fig.&#x000a0;<xref rid="Fig15" ref-type="fig">15</xref>.</p><p id="Par126">Observe that in <inline-formula id="IEq330"><alternatives><tex-math id="M663">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_3$$\end{document}</tex-math><mml:math id="M664"><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq330.gif"/></alternatives></inline-formula>, <italic>x</italic> has a parent not in <italic>Y</italic> which is a reticulation, and that <inline-formula id="IEq331"><alternatives><tex-math id="M665">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_3[Y] = N[Y]$$\end{document}</tex-math><mml:math id="M666"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq331.gif"/></alternatives></inline-formula>. Then Case&#x000a0;1a applies to <inline-formula id="IEq332"><alternatives><tex-math id="M667">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_3$$\end{document}</tex-math><mml:math id="M668"><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq332.gif"/></alternatives></inline-formula> and <inline-formula id="IEq333"><alternatives><tex-math id="M669">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M670"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq333.gif"/></alternatives></inline-formula>, and so there exists a sequence of <inline-formula id="IEq334"><alternatives><tex-math id="M671">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N \setminus Y|-3$$\end{document}</tex-math><mml:math id="M672"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq334.gif"/></alternatives></inline-formula> tail moves turning <inline-formula id="IEq335"><alternatives><tex-math id="M673">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_3$$\end{document}</tex-math><mml:math id="M674"><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq335.gif"/></alternatives></inline-formula> into <inline-formula id="IEq336"><alternatives><tex-math id="M675">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M676"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq336.gif"/></alternatives></inline-formula>. As <inline-formula id="IEq337"><alternatives><tex-math id="M677">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_3$$\end{document}</tex-math><mml:math id="M678"><mml:msub><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq337.gif"/></alternatives></inline-formula> can be derived from <italic>N</italic> by a sequence of 3 tail moves, it follows that there exists a sequence of <inline-formula id="IEq338"><alternatives><tex-math id="M679">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N \setminus Y|$$\end{document}</tex-math><mml:math id="M680"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq338.gif"/></alternatives></inline-formula> tail moves turning <italic>N</italic> into <inline-formula id="IEq339"><alternatives><tex-math id="M681">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M682"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq339.gif"/></alternatives></inline-formula>.</p></list-item></list>
</p></list-item></list>
</p></list-item></list>
</p><p id="Par127">
<fig id="Fig13"><label>Fig. 13</label><caption><p>(Color figure online) Proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar26">4.6</xref>, Case&#x000a0;1(b)i: If (<italic>z</italic>,&#x000a0;<italic>x</italic>) is movable, we may move the tail of (<italic>z</italic>,&#x000a0;<italic>x</italic>) to (<italic>u</italic>,&#x000a0;<italic>v</italic>) so that the parent <inline-formula id="IEq340"><alternatives><tex-math id="M683">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_1$$\end{document}</tex-math><mml:math id="M684"><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq340.gif"/></alternatives></inline-formula> of <italic>x</italic> is below <italic>u</italic>, then move the tail of <inline-formula id="IEq341"><alternatives><tex-math id="M685">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_1,v)$$\end{document}</tex-math><mml:math id="M686"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq341.gif"/></alternatives></inline-formula> so that the reticulation <italic>u</italic> becomes a parent of <italic>x</italic></p></caption><graphic xlink:href="11538_2018_452_Fig13_HTML" id="MO19"/></fig>
<fig id="Fig14"><label>Fig. 14</label><caption><p>(Color figure online) Proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar26">4.6</xref>, Case&#x000a0;1(b)iiA: If (<italic>z</italic>,&#x000a0;<italic>x</italic>) is not movable because of the triangle with long edge (<italic>c</italic>,&#x000a0;<italic>d</italic>), and the parent of <italic>c</italic> is not the root of <italic>N</italic>, then we move the tail of (<italic>c</italic>,&#x000a0;<italic>d</italic>) &#x02018;further up&#x02019; in order to make (<italic>z</italic>,&#x000a0;<italic>x</italic>) movable</p></caption><graphic xlink:href="11538_2018_452_Fig14_HTML" id="MO20"/></fig>
<fig id="Fig15"><label>Fig. 15</label><caption><p>(Color figure online) Proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar26">4.6</xref>, Case&#x000a0;1(b)iiB: Note that the set of tail moves depicted is equivalent to moving the head of (<italic>c</italic>,&#x000a0;<italic>d</italic>) to (<italic>z</italic>,&#x000a0;<italic>x</italic>). After this sequence of moves, <italic>x</italic> now has a reticulation parent</p></caption><graphic xlink:href="11538_2018_452_Fig15_HTML" id="MO52"/></fig>
<fig id="Fig16"><label>Fig. 16</label><caption><p>(Color figure online) Proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar26">4.6</xref>, Case&#x000a0;3a: If <inline-formula id="IEq342"><alternatives><tex-math id="M687">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M688"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq342.gif"/></alternatives></inline-formula> is a lowest reticulation in <inline-formula id="IEq343"><alternatives><tex-math id="M689">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N' \setminus Y'$$\end{document}</tex-math><mml:math id="M690"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq343.gif"/></alternatives></inline-formula> with children <inline-formula id="IEq344"><alternatives><tex-math id="M691">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x',y'$$\end{document}</tex-math><mml:math id="M692"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq344.gif"/></alternatives></inline-formula>, and the nodes <inline-formula id="IEq345"><alternatives><tex-math id="M693">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x,y \in Y$$\end{document}</tex-math><mml:math id="M694"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq345.gif"/></alternatives></inline-formula> corresponding to <inline-formula id="IEq346"><alternatives><tex-math id="M695">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x',y'$$\end{document}</tex-math><mml:math id="M696"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq346.gif"/></alternatives></inline-formula> share a reticulation parent <italic>u</italic> in <inline-formula id="IEq347"><alternatives><tex-math id="M697">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \setminus Y$$\end{document}</tex-math><mml:math id="M698"><mml:mrow><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq347.gif"/></alternatives></inline-formula>, then we may add <italic>u</italic> to <italic>Y</italic> and <inline-formula id="IEq348"><alternatives><tex-math id="M699">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M700"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq348.gif"/></alternatives></inline-formula> to <inline-formula id="IEq349"><alternatives><tex-math id="M701">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M702"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq349.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="11538_2018_452_Fig16_HTML" id="MO53"/></fig>
</p></list-item><list-item><p id="Par128"><bold>There exists a lowest node</bold>
<inline-formula id="IEq350"><alternatives><tex-math id="M703">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u}$$\end{document}</tex-math><mml:math id="M704"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq350.gif"/></alternatives></inline-formula>
<bold>of</bold>
<inline-formula id="IEq351"><alternatives><tex-math id="M705">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{N \setminus Y}$$\end{document}</tex-math><mml:math id="M706"><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mo lspace="0.15em" mathvariant="bold" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq351.gif"/></alternatives></inline-formula>
<bold>such that</bold>
<inline-formula id="IEq352"><alternatives><tex-math id="M707">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u}$$\end{document}</tex-math><mml:math id="M708"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq352.gif"/></alternatives></inline-formula>
<bold>is a reticulation</bold> By symmetric arguments to Case&#x000a0;1, we have that there is a sequence of at most <inline-formula id="IEq353"><alternatives><tex-math id="M709">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N\setminus Y|$$\end{document}</tex-math><mml:math id="M710"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq353.gif"/></alternatives></inline-formula> tail moves turning <inline-formula id="IEq354"><alternatives><tex-math id="M711">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M712"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq354.gif"/></alternatives></inline-formula> into <italic>N</italic>. As all tail moves are reversible, there is also a sequence of at most <inline-formula id="IEq355"><alternatives><tex-math id="M713">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N\setminus Y|$$\end{document}</tex-math><mml:math id="M714"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq355.gif"/></alternatives></inline-formula> tail moves turning <italic>N</italic> into <inline-formula id="IEq356"><alternatives><tex-math id="M715">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M716"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq356.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par129"><bold>No lowest node of</bold>
<inline-formula id="IEq357"><alternatives><tex-math id="M717">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{N \setminus Y}$$\end{document}</tex-math><mml:math id="M718"><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mo lspace="0.15em" mathvariant="bold" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq357.gif"/></alternatives></inline-formula>
<bold>nor any lowest node of</bold>
<inline-formula id="IEq358"><alternatives><tex-math id="M719">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{N'\setminus Y'}$$\end{document}</tex-math><mml:math id="M720"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mo mathvariant="bold">&#x02032;</mml:mo></mml:msup><mml:mo lspace="0.15em" mathvariant="bold" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo mathvariant="bold">&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq358.gif"/></alternatives></inline-formula>
<bold>is a reticulation</bold> As <inline-formula id="IEq359"><alternatives><tex-math id="M721">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|N \setminus Y| &#x0003e; 1$$\end{document}</tex-math><mml:math id="M722"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq359.gif"/></alternatives></inline-formula>, we have that in fact every lowest node of <inline-formula id="IEq360"><alternatives><tex-math id="M723">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \setminus Y$$\end{document}</tex-math><mml:math id="M724"><mml:mrow><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq360.gif"/></alternatives></inline-formula> and every lowest node of <inline-formula id="IEq361"><alternatives><tex-math id="M725">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'\setminus Y'$$\end{document}</tex-math><mml:math id="M726"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq361.gif"/></alternatives></inline-formula> is a tree node. Then, we proceed as follows. Let <inline-formula id="IEq362"><alternatives><tex-math id="M727">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M728"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq362.gif"/></alternatives></inline-formula> be an arbitrary lowest node of <inline-formula id="IEq363"><alternatives><tex-math id="M729">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N' \setminus Y'$$\end{document}</tex-math><mml:math id="M730"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq363.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq364"><alternatives><tex-math id="M731">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M732"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq364.gif"/></alternatives></inline-formula> and <inline-formula id="IEq365"><alternatives><tex-math id="M733">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y'$$\end{document}</tex-math><mml:math id="M734"><mml:msup><mml:mi>y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq365.gif"/></alternatives></inline-formula> its children.</p><p id="Par130">Then <inline-formula id="IEq366"><alternatives><tex-math id="M735">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x',y'$$\end{document}</tex-math><mml:math id="M736"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq366.gif"/></alternatives></inline-formula> are in <inline-formula id="IEq367"><alternatives><tex-math id="M737">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M738"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq367.gif"/></alternatives></inline-formula>, and therefore there exist nodes <inline-formula id="IEq368"><alternatives><tex-math id="M739">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x,y \in Y$$\end{document}</tex-math><mml:math id="M740"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq368.gif"/></alternatives></inline-formula> such that <italic>x</italic> (<italic>y</italic>) is mapped to <inline-formula id="IEq369"><alternatives><tex-math id="M741">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M742"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq369.gif"/></alternatives></inline-formula> (<inline-formula id="IEq370"><alternatives><tex-math id="M743">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y'$$\end{document}</tex-math><mml:math id="M744"><mml:msup><mml:mi>y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq370.gif"/></alternatives></inline-formula>) by the isomorphism between <italic>N</italic>[<italic>Y</italic>] and <inline-formula id="IEq371"><alternatives><tex-math id="M745">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y']}$$\end{document}</tex-math><mml:math id="M746"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq371.gif"/></alternatives></inline-formula>. Furthermore, <italic>x</italic> has the same number of parents in <italic>N</italic> as <inline-formula id="IEq372"><alternatives><tex-math id="M747">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M748"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq372.gif"/></alternatives></inline-formula> does in <inline-formula id="IEq373"><alternatives><tex-math id="M749">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M750"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq373.gif"/></alternatives></inline-formula>, and the same number of parents in <italic>Y</italic> as <inline-formula id="IEq374"><alternatives><tex-math id="M751">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M752"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq374.gif"/></alternatives></inline-formula> has in <inline-formula id="IEq375"><alternatives><tex-math id="M753">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M754"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq375.gif"/></alternatives></inline-formula> (again because the networks are binary and <italic>x</italic> has the same number of children in <italic>N</italic> as <inline-formula id="IEq376"><alternatives><tex-math id="M755">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M756"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq376.gif"/></alternatives></inline-formula> does in <inline-formula id="IEq377"><alternatives><tex-math id="M757">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M758"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq377.gif"/></alternatives></inline-formula> by the isomorphism between <italic>N</italic>[<italic>Y</italic>] and <inline-formula id="IEq378"><alternatives><tex-math id="M759">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y']}$$\end{document}</tex-math><mml:math id="M760"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq378.gif"/></alternatives></inline-formula>). Thus, <italic>x</italic> has at least one parent not in <italic>Y</italic>. Similarly, <italic>y</italic> has at least one parent not in <italic>Y</italic>.<list list-type="alpha-lower"><list-item><p id="Par131"><inline-formula id="IEq379"><alternatives><tex-math id="M761">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{x}$$\end{document}</tex-math><mml:math id="M762"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq379.gif"/></alternatives></inline-formula>
<bold>and</bold>
<inline-formula id="IEq380"><alternatives><tex-math id="M763">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{y}$$\end{document}</tex-math><mml:math id="M764"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq380.gif"/></alternatives></inline-formula>
<bold>have a common parent</bold>
<inline-formula id="IEq381"><alternatives><tex-math id="M765">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{u}$$\end{document}</tex-math><mml:math id="M766"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq381.gif"/></alternatives></inline-formula>
<bold>not in</bold>
<inline-formula id="IEq382"><alternatives><tex-math id="M767">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{Y}$$\end{document}</tex-math><mml:math id="M768"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq382.gif"/></alternatives></inline-formula> In this case, let <inline-formula id="IEq383"><alternatives><tex-math id="M769">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_1 = Y \cup \{u\}$$\end{document}</tex-math><mml:math id="M770"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>Y</mml:mi><mml:mo>&#x0222a;</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq383.gif"/></alternatives></inline-formula> and <inline-formula id="IEq384"><alternatives><tex-math id="M771">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_1' = Y' \cup \{u'\}$$\end{document}</tex-math><mml:math id="M772"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x0222a;</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq384.gif"/></alternatives></inline-formula>, and extend the isomorphism between <italic>N</italic>[<italic>Y</italic>] and <inline-formula id="IEq385"><alternatives><tex-math id="M773">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y']}$$\end{document}</tex-math><mml:math id="M774"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq385.gif"/></alternatives></inline-formula> to an isomorphism between <inline-formula id="IEq386"><alternatives><tex-math id="M775">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N[Y_1]$$\end{document}</tex-math><mml:math id="M776"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq386.gif"/></alternatives></inline-formula> and <inline-formula id="IEq387"><alternatives><tex-math id="M777">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y_1']}$$\end{document}</tex-math><mml:math id="M778"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq387.gif"/></alternatives></inline-formula>, by letting <italic>u</italic> be mapped to <inline-formula id="IEq388"><alternatives><tex-math id="M779">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M780"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq388.gif"/></alternatives></inline-formula> (see Fig.&#x000a0;<xref rid="Fig16" ref-type="fig">16</xref>). We now have that <inline-formula id="IEq389"><alternatives><tex-math id="M781">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_1$$\end{document}</tex-math><mml:math id="M782"><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq389.gif"/></alternatives></inline-formula> and <inline-formula id="IEq390"><alternatives><tex-math id="M783">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_1'$$\end{document}</tex-math><mml:math id="M784"><mml:msubsup><mml:mi>Y</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq390.gif"/></alternatives></inline-formula> are downward-closed sets of nodes such that <inline-formula id="IEq391"><alternatives><tex-math id="M785">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N[Y_1]$$\end{document}</tex-math><mml:math id="M786"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq391.gif"/></alternatives></inline-formula> is isomorphic to <inline-formula id="IEq392"><alternatives><tex-math id="M787">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y_1']}$$\end{document}</tex-math><mml:math id="M788"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq392.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq393"><alternatives><tex-math id="M789">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L(N)\subseteq Y_1, L(N') \subseteq Y_1'$$\end{document}</tex-math><mml:math id="M790"><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02286;</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02286;</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq393.gif"/></alternatives></inline-formula>. Furthermore, <inline-formula id="IEq394"><alternatives><tex-math id="M791">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|N \setminus Y_1| &#x0003c; |N \setminus Y|$$\end{document}</tex-math><mml:math id="M792"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x0003c;</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq394.gif"/></alternatives></inline-formula>. Thus by the inductive hypothesis, there is a sequence of <inline-formula id="IEq395"><alternatives><tex-math id="M793">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N \setminus Y_1| = 3|N \setminus Y|-3$$\end{document}</tex-math><mml:math id="M794"><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo></mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq395.gif"/></alternatives></inline-formula> tail moves turning <italic>N</italic> into <inline-formula id="IEq396"><alternatives><tex-math id="M795">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M796"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq396.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par132"><inline-formula id="IEq397"><alternatives><tex-math id="M797">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{x}$$\end{document}</tex-math><mml:math id="M798"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq397.gif"/></alternatives></inline-formula>
<bold>and</bold>
<inline-formula id="IEq398"><alternatives><tex-math id="M799">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{y}$$\end{document}</tex-math><mml:math id="M800"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq398.gif"/></alternatives></inline-formula>
<bold>do not have a common parent not in</bold>
<inline-formula id="IEq399"><alternatives><tex-math id="M801">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{Y}$$\end{document}</tex-math><mml:math id="M802"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq399.gif"/></alternatives></inline-formula> In this case, let <inline-formula id="IEq400"><alternatives><tex-math id="M803">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_x$$\end{document}</tex-math><mml:math id="M804"><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq400.gif"/></alternatives></inline-formula> be a parent of <italic>x</italic> not in <italic>Y</italic>, and let <inline-formula id="IEq401"><alternatives><tex-math id="M805">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_y$$\end{document}</tex-math><mml:math id="M806"><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq401.gif"/></alternatives></inline-formula> be a parent of <italic>y</italic> not in <italic>Y</italic>. Recall that <inline-formula id="IEq402"><alternatives><tex-math id="M807">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_x$$\end{document}</tex-math><mml:math id="M808"><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq402.gif"/></alternatives></inline-formula> and <inline-formula id="IEq403"><alternatives><tex-math id="M809">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_y$$\end{document}</tex-math><mml:math id="M810"><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq403.gif"/></alternatives></inline-formula> are both tree nodes. It follows that either one of <inline-formula id="IEq404"><alternatives><tex-math id="M811">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_x,x), (z_y,y)$$\end{document}</tex-math><mml:math id="M812"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq404.gif"/></alternatives></inline-formula> is movable, or deleting <inline-formula id="IEq405"><alternatives><tex-math id="M813">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_x,x)$$\end{document}</tex-math><mml:math id="M814"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq405.gif"/></alternatives></inline-formula> and suppressing <italic>x</italic> (deleting <inline-formula id="IEq406"><alternatives><tex-math id="M815">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_y,y)$$\end{document}</tex-math><mml:math id="M816"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq406.gif"/></alternatives></inline-formula> and suppressing <italic>y</italic>) would create parallel edges.<list list-type="simple"><list-item><label>(i)</label><p id="Par133"><inline-formula id="IEq407"><alternatives><tex-math id="M817">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{(z_x,x)}$$\end{document}</tex-math><mml:math id="M818"><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq407.gif"/></alternatives></inline-formula>
<bold>is movable</bold> in this case, observe that the edge <inline-formula id="IEq408"><alternatives><tex-math id="M819">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_y,y)$$\end{document}</tex-math><mml:math id="M820"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq408.gif"/></alternatives></inline-formula> is not below <italic>x</italic> (as <inline-formula id="IEq409"><alternatives><tex-math id="M821">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in Y$$\end{document}</tex-math><mml:math id="M822"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq409.gif"/></alternatives></inline-formula> and <inline-formula id="IEq410"><alternatives><tex-math id="M823">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_y \notin Y$$\end{document}</tex-math><mml:math id="M824"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>&#x02209;</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq410.gif"/></alternatives></inline-formula>), and that <inline-formula id="IEq411"><alternatives><tex-math id="M825">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \ne y$$\end{document}</tex-math><mml:math id="M826"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq411.gif"/></alternatives></inline-formula>. Then, by Observation&#x000a0;<xref ref-type="sec" rid="FPar11">2.11</xref>, the tail of <inline-formula id="IEq412"><alternatives><tex-math id="M827">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_x,x)$$\end{document}</tex-math><mml:math id="M828"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq412.gif"/></alternatives></inline-formula> can be moved to <inline-formula id="IEq413"><alternatives><tex-math id="M829">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_y,y)$$\end{document}</tex-math><mml:math id="M830"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq413.gif"/></alternatives></inline-formula>.</p><p id="Par134">Let <inline-formula id="IEq414"><alternatives><tex-math id="M831">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M832"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq414.gif"/></alternatives></inline-formula> be the network derived from <italic>N</italic> by applying this tail move (see Fig.&#x000a0;<xref rid="Fig17" ref-type="fig">17</xref>). Then, as <italic>x</italic> and <italic>y</italic> have a common parent in <inline-formula id="IEq415"><alternatives><tex-math id="M833">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M834"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq415.gif"/></alternatives></inline-formula> not in <italic>Y</italic>, and as <inline-formula id="IEq416"><alternatives><tex-math id="M835">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1[Y] = N[Y]$$\end{document}</tex-math><mml:math id="M836"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq416.gif"/></alternatives></inline-formula>, we may apply the arguments of Case&#x000a0;3a to show that there exists a sequence of <inline-formula id="IEq417"><alternatives><tex-math id="M837">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N \setminus Y|-3$$\end{document}</tex-math><mml:math id="M838"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq417.gif"/></alternatives></inline-formula> tail moves turning <inline-formula id="IEq418"><alternatives><tex-math id="M839">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M840"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq418.gif"/></alternatives></inline-formula> into <inline-formula id="IEq419"><alternatives><tex-math id="M841">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M842"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq419.gif"/></alternatives></inline-formula>. As <inline-formula id="IEq420"><alternatives><tex-math id="M843">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M844"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq420.gif"/></alternatives></inline-formula> is derived from <italic>N</italic> by a single tail move, there exists a sequence of <inline-formula id="IEq421"><alternatives><tex-math id="M845">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N \setminus Y|-2$$\end{document}</tex-math><mml:math id="M846"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq421.gif"/></alternatives></inline-formula> tail moves turning <italic>N</italic> into <inline-formula id="IEq422"><alternatives><tex-math id="M847">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M848"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq422.gif"/></alternatives></inline-formula>.</p></list-item><list-item><label>(ii)</label><p id="Par135"><inline-formula id="IEq423"><alternatives><tex-math id="M849">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{(z_y,y)}$$\end{document}</tex-math><mml:math id="M850"><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq423.gif"/></alternatives></inline-formula>
<bold>is movable</bold> By symmetric arguments to Case&#x000a0;3(b)i, we have that there is a sequence of at most <inline-formula id="IEq424"><alternatives><tex-math id="M851">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N \setminus Y|-2$$\end{document}</tex-math><mml:math id="M852"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq424.gif"/></alternatives></inline-formula> tail moves turning <italic>N</italic> into <inline-formula id="IEq425"><alternatives><tex-math id="M853">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M854"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq425.gif"/></alternatives></inline-formula>.</p></list-item><list-item><label>(iii)</label><p id="Par136"><bold>Neither</bold>
<inline-formula id="IEq426"><alternatives><tex-math id="M855">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{(z_x,x)}$$\end{document}</tex-math><mml:math id="M856"><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq426.gif"/></alternatives></inline-formula>
<bold>nor</bold>
<inline-formula id="IEq427"><alternatives><tex-math id="M857">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{(z_y,y)}$$\end{document}</tex-math><mml:math id="M858"><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq427.gif"/></alternatives></inline-formula>
<bold>is movable</bold> In this case, there must exist nodes <inline-formula id="IEq428"><alternatives><tex-math id="M859">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_x,c_x, d_y, c_y$$\end{document}</tex-math><mml:math id="M860"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq428.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq429"><alternatives><tex-math id="M861">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_x,d_x,z_x$$\end{document}</tex-math><mml:math id="M862"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq429.gif"/></alternatives></inline-formula> form a triangle with long edge <inline-formula id="IEq430"><alternatives><tex-math id="M863">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(c_x,d_x)$$\end{document}</tex-math><mml:math id="M864"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq430.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq431"><alternatives><tex-math id="M865">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_y,d_y,z_y$$\end{document}</tex-math><mml:math id="M866"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq431.gif"/></alternatives></inline-formula> form a triangle with long edge <inline-formula id="IEq432"><alternatives><tex-math id="M867">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(c_y,d_y)$$\end{document}</tex-math><mml:math id="M868"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq432.gif"/></alternatives></inline-formula>. Moreover, as <inline-formula id="IEq433"><alternatives><tex-math id="M869">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_x,z_y$$\end{document}</tex-math><mml:math id="M870"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq433.gif"/></alternatives></inline-formula> are different nodes with one parent each, <inline-formula id="IEq434"><alternatives><tex-math id="M871">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_x \ne c_y$$\end{document}</tex-math><mml:math id="M872"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>&#x02260;</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq434.gif"/></alternatives></inline-formula>. It follows that one of <inline-formula id="IEq435"><alternatives><tex-math id="M873">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_x,c_y$$\end{document}</tex-math><mml:math id="M874"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq435.gif"/></alternatives></inline-formula> is not the child of the root of <italic>N</italic>. Suppose without loss of generality that <inline-formula id="IEq436"><alternatives><tex-math id="M875">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_x$$\end{document}</tex-math><mml:math id="M876"><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq436.gif"/></alternatives></inline-formula> is not the child of the root. Then, there exist nodes <inline-formula id="IEq437"><alternatives><tex-math id="M877">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_x,b_x$$\end{document}</tex-math><mml:math id="M878"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq437.gif"/></alternatives></inline-formula> and edges <inline-formula id="IEq438"><alternatives><tex-math id="M879">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(a_x,b_x), (b_x,c_x)$$\end{document}</tex-math><mml:math id="M880"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq438.gif"/></alternatives></inline-formula>.</p><p id="Par137">By similar arguments to those used in Case&#x000a0;1(b)iiA, the tail of <inline-formula id="IEq439"><alternatives><tex-math id="M881">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(c_x,d_x)$$\end{document}</tex-math><mml:math id="M882"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq439.gif"/></alternatives></inline-formula> can be moved to <inline-formula id="IEq440"><alternatives><tex-math id="M883">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(a_x,b_x)$$\end{document}</tex-math><mml:math id="M884"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq440.gif"/></alternatives></inline-formula>, and in the resulting network <inline-formula id="IEq441"><alternatives><tex-math id="M885">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M886"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq441.gif"/></alternatives></inline-formula>, <inline-formula id="IEq442"><alternatives><tex-math id="M887">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_x,x)$$\end{document}</tex-math><mml:math id="M888"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq442.gif"/></alternatives></inline-formula> is movable (see Fig.&#x000a0;<xref rid="Fig18" ref-type="fig">18</xref>). Thus, Case&#x000a0;3(b)i applies to <inline-formula id="IEq443"><alternatives><tex-math id="M889">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M890"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq443.gif"/></alternatives></inline-formula> and <inline-formula id="IEq444"><alternatives><tex-math id="M891">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M892"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq444.gif"/></alternatives></inline-formula>, and so there exists a sequence of <inline-formula id="IEq445"><alternatives><tex-math id="M893">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N\setminus Y|-2$$\end{document}</tex-math><mml:math id="M894"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq445.gif"/></alternatives></inline-formula> tail moves turning <inline-formula id="IEq446"><alternatives><tex-math id="M895">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M896"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq446.gif"/></alternatives></inline-formula> into <inline-formula id="IEq447"><alternatives><tex-math id="M897">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M898"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq447.gif"/></alternatives></inline-formula>. As <inline-formula id="IEq448"><alternatives><tex-math id="M899">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_1$$\end{document}</tex-math><mml:math id="M900"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq448.gif"/></alternatives></inline-formula> is derived from <italic>N</italic> by a single tail move, there exists a sequence of <inline-formula id="IEq449"><alternatives><tex-math id="M901">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|N\setminus Y|-1$$\end{document}</tex-math><mml:math id="M902"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq449.gif"/></alternatives></inline-formula> tail moves turning <italic>N</italic> into <inline-formula id="IEq450"><alternatives><tex-math id="M903">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M904"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq450.gif"/></alternatives></inline-formula>.</p></list-item></list>
</p></list-item></list>
</p></list-item></list><inline-formula id="IEq451"><alternatives><tex-math id="M905">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M906"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq451.gif"/></alternatives></inline-formula></p><p>
<fig id="Fig17"><label>Fig. 17</label><caption><p>(Color figure online) Proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar26">4.6</xref>, Case&#x000a0;3(b)i: If <inline-formula id="IEq452"><alternatives><tex-math id="M907">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_x,x)$$\end{document}</tex-math><mml:math id="M908"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq452.gif"/></alternatives></inline-formula> is movable, we may move the tail of <inline-formula id="IEq453"><alternatives><tex-math id="M909">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_x,x)$$\end{document}</tex-math><mml:math id="M910"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq453.gif"/></alternatives></inline-formula> to <inline-formula id="IEq454"><alternatives><tex-math id="M911">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_y,y)$$\end{document}</tex-math><mml:math id="M912"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq454.gif"/></alternatives></inline-formula> so that <italic>x</italic> and <italic>y</italic> share a parent</p></caption><graphic xlink:href="11538_2018_452_Fig17_HTML" id="MO54"/></fig>
<fig id="Fig18"><label>Fig. 18</label><caption><p>(Color figure online) Proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar26">4.6</xref>, Case&#x000a0;3(b)iii: If neither <inline-formula id="IEq455"><alternatives><tex-math id="M913">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_x,x)$$\end{document}</tex-math><mml:math id="M914"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq455.gif"/></alternatives></inline-formula> or <inline-formula id="IEq456"><alternatives><tex-math id="M915">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_y,y)$$\end{document}</tex-math><mml:math id="M916"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq456.gif"/></alternatives></inline-formula> is movable, we can make at least one of them movable by moving the long edge of its triangle &#x0201c;further up&#x0201d;</p></caption><graphic xlink:href="11538_2018_452_Fig18_HTML" id="MO55"/></fig>
</p><p>By setting <inline-formula id="IEq457"><alternatives><tex-math id="M917">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y = L(N)$$\end{document}</tex-math><mml:math id="M918"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq457.gif"/></alternatives></inline-formula> and <inline-formula id="IEq458"><alternatives><tex-math id="M919">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y' = L(N')$$\end{document}</tex-math><mml:math id="M920"><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq458.gif"/></alternatives></inline-formula>, we have the following:</p></sec><sec id="FPar28"><title>Theorem 4.7</title><p id="Par140">Let <italic>N</italic> and <inline-formula id="IEq459"><alternatives><tex-math id="M921">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M922"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq459.gif"/></alternatives></inline-formula> be networks in the <italic>k</italic>th tier on <italic>X</italic> such that <italic>N</italic> and <inline-formula id="IEq460"><alternatives><tex-math id="M923">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M924"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq460.gif"/></alternatives></inline-formula> are not the networks depicted in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>. Then, there is a sequence of at most <inline-formula id="IEq461"><alternatives><tex-math id="M925">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3(|N|-|X|)=3(|X|+2k)$$\end{document}</tex-math><mml:math id="M926"><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq461.gif"/></alternatives></inline-formula> tail moves turning <italic>N</italic> into <inline-formula id="IEq462"><alternatives><tex-math id="M927">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M928"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq462.gif"/></alternatives></inline-formula>.</p><p>As rSPR moves consist of head moves and tail moves, Theorem&#x000a0;<xref ref-type="sec" rid="FPar28">4.7</xref> also gives us an upper bound on the number of rSPR moves needed to turn <italic>N</italic> into <inline-formula id="IEq463"><alternatives><tex-math id="M929">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M930"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq463.gif"/></alternatives></inline-formula>. By modifying these arguments slightly, we can improve this bound in the case of rSPR moves.</p></sec><sec id="FPar29"><title>Theorem 4.8</title><p id="Par142">Let <italic>N</italic> and <inline-formula id="IEq464"><alternatives><tex-math id="M931">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M932"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq464.gif"/></alternatives></inline-formula> be networks in the <italic>k</italic>th tier on <italic>X</italic>. Then, there is a sequence of at most <inline-formula id="IEq465"><alternatives><tex-math id="M933">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2|X|+3k-1$$\end{document}</tex-math><mml:math id="M934"><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq465.gif"/></alternatives></inline-formula> rSPR moves turning <italic>N</italic> into <inline-formula id="IEq466"><alternatives><tex-math id="M935">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M936"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq466.gif"/></alternatives></inline-formula>.</p></sec><sec id="FPar30"><title>Proof</title><p id="Par143">Recall that the proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar26">4.6</xref> works by gradually expanding two downward-closed subsets <inline-formula id="IEq467"><alternatives><tex-math id="M937">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y \subseteq V(N), Y' \subseteq V(N')$$\end{document}</tex-math><mml:math id="M938"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>&#x02286;</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02286;</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq467.gif"/></alternatives></inline-formula> for which <italic>N</italic>[<italic>Y</italic>] is isomorphic to <inline-formula id="IEq468"><alternatives><tex-math id="M939">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N'[Y']}$$\end{document}</tex-math><mml:math id="M940"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq468.gif"/></alternatives></inline-formula>, using at most 3 tail moves each time the size of <italic>Y</italic> and <inline-formula id="IEq469"><alternatives><tex-math id="M941">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M942"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq469.gif"/></alternatives></inline-formula> is increased. We show that in Cases&#x000a0;1 and&#x000a0;2 of the proof of Lemma&#x000a0;<xref ref-type="sec" rid="FPar26">4.6</xref>, we may instead use one head move. Indeed, in Case&#x000a0;1 there is a lowest node <inline-formula id="IEq470"><alternatives><tex-math id="M943">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M944"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq470.gif"/></alternatives></inline-formula> of <inline-formula id="IEq471"><alternatives><tex-math id="M945">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'\setminus Y'$$\end{document}</tex-math><mml:math id="M946"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq471.gif"/></alternatives></inline-formula> that is a reticulation with child <inline-formula id="IEq472"><alternatives><tex-math id="M947">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x' \in Y$$\end{document}</tex-math><mml:math id="M948"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq472.gif"/></alternatives></inline-formula>, and the node <inline-formula id="IEq473"><alternatives><tex-math id="M949">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in Y$$\end{document}</tex-math><mml:math id="M950"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq473.gif"/></alternatives></inline-formula> corresponding to <inline-formula id="IEq474"><alternatives><tex-math id="M951">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M952"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq474.gif"/></alternatives></inline-formula> has parent <italic>z</italic>. If <italic>z</italic> is a reticulation (Case&#x000a0;1a), then as before there is no need for any move, we simply add <italic>z</italic> to <italic>Y</italic> and <inline-formula id="IEq475"><alternatives><tex-math id="M953">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M954"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq475.gif"/></alternatives></inline-formula> to <inline-formula id="IEq476"><alternatives><tex-math id="M955">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M956"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq476.gif"/></alternatives></inline-formula>. If <italic>z</italic> is not a reticulation, we proceed as follows. There exists some reticulation node in <inline-formula id="IEq477"><alternatives><tex-math id="M957">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v \in N\setminus Y$$\end{document}</tex-math><mml:math id="M958"><mml:mrow><mml:mi>v</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq477.gif"/></alternatives></inline-formula> (again, such a node must exist, as <inline-formula id="IEq478"><alternatives><tex-math id="M959">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M960"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq478.gif"/></alternatives></inline-formula> exists and <inline-formula id="IEq479"><alternatives><tex-math id="M961">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\setminus Y$$\end{document}</tex-math><mml:math id="M962"><mml:mrow><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq479.gif"/></alternatives></inline-formula> and <inline-formula id="IEq480"><alternatives><tex-math id="M963">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'\setminus Y'$$\end{document}</tex-math><mml:math id="M964"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq480.gif"/></alternatives></inline-formula> have the same number of reticulations). Moving one of its parent edges (<italic>u</italic>,&#x000a0;<italic>v</italic>) to (<italic>z</italic>,&#x000a0;<italic>x</italic>) will not create a cycle, as <italic>Y</italic> is downward-closed. It cannot create any parallel edges, unless either <inline-formula id="IEq481"><alternatives><tex-math id="M965">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u = z$$\end{document}</tex-math><mml:math id="M966"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq481.gif"/></alternatives></inline-formula>, or the other parent edge (<italic>w</italic>,&#x000a0;<italic>v</italic>) is part of a triangle on <italic>w</italic>,&#x000a0;<italic>v</italic> and the child of <italic>v</italic>. If <inline-formula id="IEq482"><alternatives><tex-math id="M967">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u = z$$\end{document}</tex-math><mml:math id="M968"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq482.gif"/></alternatives></inline-formula>, then we can move (<italic>w</italic>,&#x000a0;<italic>v</italic>) to (<italic>z</italic>,&#x000a0;<italic>x</italic>) and this will not create parallel edges unless <italic>z</italic>,&#x000a0;<italic>v</italic>,&#x000a0;<italic>x</italic> form a triangle. But in this case, <italic>x</italic> is a child of <italic>v</italic> and thus <italic>x</italic> already has a parent in <inline-formula id="IEq483"><alternatives><tex-math id="M969">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \setminus Y$$\end{document}</tex-math><mml:math id="M970"><mml:mrow><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq483.gif"/></alternatives></inline-formula> that is a reticulation. This implies that, after at most one head move, <italic>x</italic> has a reticulation parent, and we may proceed as in Case&#x000a0;1a. (Case&#x000a0;2 is handled symmetrically.)</p><p id="Par144">The other cases use at most one tail move (and thus at most one rSPR move), apart from Case&#x000a0;3(b)iii that may require 2 rSPR moves. This case can come up as many times as there are tree nodes in the network. Hence, the number of moves needed to add a node to <italic>Y</italic> is at most one for each reticulation node, and at most two for each tree node. This means at most <inline-formula id="IEq484"><alternatives><tex-math id="M971">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|V|-|X|+t$$\end{document}</tex-math><mml:math id="M972"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq484.gif"/></alternatives></inline-formula> moves are needed, where <italic>t</italic> denotes the number of tree nodes in <italic>N</italic> (and thus in <inline-formula id="IEq485"><alternatives><tex-math id="M973">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M974"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq485.gif"/></alternatives></inline-formula>).</p><p id="Par145">Recall from Observation&#x000a0;<xref ref-type="sec" rid="FPar4">2.4</xref> that <inline-formula id="IEq486"><alternatives><tex-math id="M975">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|V|=2(|X|+k)$$\end{document}</tex-math><mml:math id="M976"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq486.gif"/></alternatives></inline-formula> for any binary tier <italic>k</italic> network. As <italic>k</italic> nodes are reticulations, |<italic>X</italic>| are leaves and 1 is the root, we have <inline-formula id="IEq487"><alternatives><tex-math id="M977">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = |X|+k-1$$\end{document}</tex-math><mml:math id="M978"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq487.gif"/></alternatives></inline-formula>. This shows that we need at most <inline-formula id="IEq488"><alternatives><tex-math id="M979">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2(|X|+k)-|X|+|X|+k-1=2|X|+3k-1$$\end{document}</tex-math><mml:math id="M980"><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq488.gif"/></alternatives></inline-formula> rSPR moves to turn <italic>N</italic> into <inline-formula id="IEq489"><alternatives><tex-math id="M981">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M982"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq489.gif"/></alternatives></inline-formula>. <inline-formula id="IEq490"><alternatives><tex-math id="M983">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M984"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq490.gif"/></alternatives></inline-formula></p><p>In practice, we expect the distance between most pairs of networks to be less than <inline-formula id="IEq491"><alternatives><tex-math id="M985">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X|+3k-1$$\end{document}</tex-math><mml:math id="M986"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq491.gif"/></alternatives></inline-formula> because only one case needs two rSPR moves, and this case might not come up very often.</p><p>The next observation will be useful for obtaining lower bounds for the diameter of tail and rSPR moves.</p></sec><sec id="FPar31"><title>Observation 4.9</title><p id="Par148">Let <italic>N</italic> and <inline-formula id="IEq492"><alternatives><tex-math id="M987">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M988"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq492.gif"/></alternatives></inline-formula> be networks in the <italic>k</italic>th tier on <italic>X</italic>, and let <inline-formula id="IEq493"><alternatives><tex-math id="M989">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n:=|X|$$\end{document}</tex-math><mml:math id="M990"><mml:mrow><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq493.gif"/></alternatives></inline-formula> be the number of leaves. The observation that <inline-formula id="IEq494"><alternatives><tex-math id="M991">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{Tail}_1\subseteq \mathrm{rNNI}\subseteq \mathrm{rSPR}$$\end{document}</tex-math><mml:math id="M992"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Tail</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02286;</mml:mo><mml:mi mathvariant="normal">rNNI</mml:mi><mml:mo>&#x02286;</mml:mo><mml:mi mathvariant="normal">rSPR</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq494.gif"/></alternatives></inline-formula> (where <inline-formula id="IEq495"><alternatives><tex-math id="M993">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{Tail}_1$$\end{document}</tex-math><mml:math id="M994"><mml:msub><mml:mi mathvariant="normal">Tail</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq495.gif"/></alternatives></inline-formula> denotes the class of distance-1 tail moves) implies that<disp-formula id="Equ3"><alternatives><tex-math id="M995">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} d_{\mathrm{Tail}_1}(N,N')\ge d_{\mathrm{rNNI}}(N,N')\ge d_{\mathrm{rSPR}}(N,N'), \end{aligned}$$\end{document}</tex-math><mml:math id="M996" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi mathvariant="normal">Tail</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02265;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">rNNI</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02265;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">rSPR</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2018_452_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>and<disp-formula id="Equ4"><alternatives><tex-math id="M997">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varDelta _k^{\mathrm{Tail}_1}(n)\ge \varDelta _k^{\mathrm{rNNI}}(n)\ge \varDelta _k^{\mathrm{rSPR}}(n). \end{aligned}$$\end{document}</tex-math><mml:math id="M998" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:msub><mml:mi mathvariant="normal">Tail</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02265;</mml:mo><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">rNNI</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02265;</mml:mo><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">rSPR</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2018_452_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>Similarly, <inline-formula id="IEq496"><alternatives><tex-math id="M999">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{Tail}_1\subseteq \mathrm{Tail}\subseteq \mathrm{rSPR}$$\end{document}</tex-math><mml:math id="M1000"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Tail</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02286;</mml:mo><mml:mi mathvariant="normal">Tail</mml:mi><mml:mo>&#x02286;</mml:mo><mml:mi mathvariant="normal">rSPR</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq496.gif"/></alternatives></inline-formula> implies that<disp-formula id="Equ5"><alternatives><tex-math id="M1001">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} d_{\mathrm{Tail}_1}(N,N')\ge d_{\mathrm{Tail}}(N,N')\ge d_{\mathrm{rSPR}}(N,N'), \end{aligned}$$\end{document}</tex-math><mml:math id="M1002" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi mathvariant="normal">Tail</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02265;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">Tail</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02265;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">rSPR</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2018_452_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>and<disp-formula id="Equ6"><alternatives><tex-math id="M1003">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varDelta _k^{\mathrm{Tail}_1}(n)\ge \varDelta _k^{\mathrm{Tail}}(n)\ge \varDelta _k^{\mathrm{rSPR}}(n). \end{aligned}$$\end{document}</tex-math><mml:math id="M1004" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:msub><mml:mi mathvariant="normal">Tail</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02265;</mml:mo><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">Tail</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02265;</mml:mo><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">rSPR</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2018_452_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>
</p><p>Diameters of move-induced metrics on tree space are well studied. A few relevant bounds are <inline-formula id="IEq497"><alternatives><tex-math id="M1005">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta _0^{\mathrm{rSPR}}=n-\varTheta (\sqrt{n})$$\end{document}</tex-math><mml:math id="M1006"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">rSPR</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq497.gif"/></alternatives></inline-formula> (Ding et&#x000a0;al. <xref ref-type="bibr" rid="CR6">2011</xref>; Atkins and McDiarmid <xref ref-type="bibr" rid="CR2">2015</xref>) and <inline-formula id="IEq498"><alternatives><tex-math id="M1007">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta _0^{\mathrm{rNNI}}=\varTheta (n\log (n))$$\end{document}</tex-math><mml:math id="M1008"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">rNNI</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq498.gif"/></alternatives></inline-formula> (Li et&#x000a0;al. <xref ref-type="bibr" rid="CR13">1996</xref>). We extend these results to higher tiers of network space.</p><p>Lemma&#x000a0;<xref ref-type="sec" rid="FPar24">4.5</xref> gives lower bounds of order <inline-formula id="IEq499"><alternatives><tex-math id="M1009">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-\varOmega (\sqrt{n})$$\end{document}</tex-math><mml:math id="M1010"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>&#x003a9;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq499.gif"/></alternatives></inline-formula> on diameters for rSPR and tail moves, by reducing to trees and using the corresponding diameter bound. Theorem&#x000a0;<xref ref-type="sec" rid="FPar28">4.7</xref> and Theorem&#x000a0;<xref ref-type="sec" rid="FPar29">4.8</xref> give upper bounds of order <italic>n</italic>. More precisely, <inline-formula id="IEq500"><alternatives><tex-math id="M1011">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta _k^{\mathrm{Tail}}(n)\le 3(n+2k)$$\end{document}</tex-math><mml:math id="M1012"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">Tail</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02264;</mml:mo><mml:mn>3</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq500.gif"/></alternatives></inline-formula> and <inline-formula id="IEq501"><alternatives><tex-math id="M1013">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta _k^{\mathrm{rSPR}}(n)\le 2n+3k$$\end{document}</tex-math><mml:math id="M1014"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">rSPR</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02264;</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq501.gif"/></alternatives></inline-formula> from Observation&#x000a0;<xref ref-type="sec" rid="FPar31">4.9</xref>. The following theorem summarizes this discussion:</p></sec><sec id="FPar32"><title>Theorem 4.10</title><p id="Par151">The diameter of tiers of network space for metrics induced by rSPR and tail moves satisfy<disp-formula id="Equ7"><alternatives><tex-math id="M1015">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} n-\varTheta (\sqrt{n})&#x00026;\le \varDelta _k^{\mathrm{Tail}}(n)\le 3(n+2k),\\ n-\varTheta (\sqrt{n})&#x00026;\le \varDelta _k^{\mathrm{rSPR}}(n)\le 2n+3k. \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="M1016" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>&#x02264;</mml:mo><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">Tail</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02264;</mml:mo><mml:mn>3</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>&#x02264;</mml:mo><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">rSPR</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02264;</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2018_452_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>
</p><p>Additionally, going back through the proof of Theorem&#x000a0;<xref ref-type="sec" rid="FPar19">3.4</xref>, we see that any distance one head move can be replaced by at most four tail moves if the network has more than one leaf, so <inline-formula id="IEq502"><alternatives><tex-math id="M1017">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{\mathrm{Tail}}(N,N')\le 4 d_{\mathrm{rNNI}}(N,N')$$\end{document}</tex-math><mml:math id="M1018"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">Tail</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02264;</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">rNNI</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq502.gif"/></alternatives></inline-formula> for any pair of networks <inline-formula id="IEq503"><alternatives><tex-math id="M1019">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N,N'$$\end{document}</tex-math><mml:math id="M1020"><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq503.gif"/></alternatives></inline-formula> with more than one leaf. Note that this does not give us new information regarding the diameters, but it does give bounds on the distances when we are given two networks.</p></sec></sec><sec id="Sec10"><title>The Diameter of Tail<sub>1</sub> and rNNI Moves</title><p id="Par153">Comparing rNNI and tail moves directly is complicated by the fact that rNNI moves are more local. To make the comparison easier, we consider local tail moves: tail moves over small distance. The following lemma indicates how restricting to distance-1 tail moves influences our results.</p><sec id="FPar33"><title>Lemma 4.11</title><p id="Par154">Let <inline-formula id="IEq504"><alternatives><tex-math id="M1021">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e=(u,v)$$\end{document}</tex-math><mml:math id="M1022"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq504.gif"/></alternatives></inline-formula> to <inline-formula id="IEq505"><alternatives><tex-math id="M1023">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f=(s,t)$$\end{document}</tex-math><mml:math id="M1024"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq505.gif"/></alternatives></inline-formula> be a valid tail move in a tier <italic>k</italic> network <italic>N</italic> on <italic>X</italic>. Then, there is a sequence of at most <inline-formula id="IEq506"><alternatives><tex-math id="M1025">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X|+3k-1$$\end{document}</tex-math><mml:math id="M1026"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq506.gif"/></alternatives></inline-formula> distance-1 tail moves resulting in the same network.</p></sec><sec id="FPar34"><title>Proof</title><p id="Par155">Note that there exist directed paths <inline-formula id="IEq507"><alternatives><tex-math id="M1027">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathrm{LCA}}}(u,s)\rightarrow ~s$$\end{document}</tex-math><mml:math id="M1028"><mml:mrow><mml:mi mathvariant="normal">LCA</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mspace width="3.33333pt"/><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq507.gif"/></alternatives></inline-formula> and <inline-formula id="IEq508"><alternatives><tex-math id="M1029">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathrm{LCA}}}(u,s)\rightarrow ~u$$\end{document}</tex-math><mml:math id="M1030"><mml:mrow><mml:mi mathvariant="normal">LCA</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mspace width="3.33333pt"/><mml:mi>u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq508.gif"/></alternatives></inline-formula> (which are not necessarily unique) for any choice of <inline-formula id="IEq509"><alternatives><tex-math id="M1031">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathrm{LCA}}}(u,s)$$\end{document}</tex-math><mml:math id="M1032"><mml:mrow><mml:mi mathvariant="normal">LCA</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq509.gif"/></alternatives></inline-formula>. We prove that a tail move of <italic>e</italic> to any edge on either path is valid, and this gives a sequence of distance-1 tail moves: Indeed, for any edges <italic>f</italic> and <italic>g</italic> that share a node, if there is a valid tail move <italic>e</italic> to <italic>f</italic> resulting in network <inline-formula id="IEq510"><alternatives><tex-math id="M1033">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_f$$\end{document}</tex-math><mml:math id="M1034"><mml:msub><mml:mi>N</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq510.gif"/></alternatives></inline-formula>, and a valid tail move <italic>e</italic> to <italic>g</italic> resulting in network <inline-formula id="IEq511"><alternatives><tex-math id="M1035">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_g$$\end{document}</tex-math><mml:math id="M1036"><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq511.gif"/></alternatives></inline-formula>, then there is a distance-1 tail move <italic>f</italic> to <italic>g</italic> that transforms <inline-formula id="IEq512"><alternatives><tex-math id="M1037">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_f$$\end{document}</tex-math><mml:math id="M1038"><mml:msub><mml:mi>N</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq512.gif"/></alternatives></inline-formula> into <inline-formula id="IEq513"><alternatives><tex-math id="M1039">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_g$$\end{document}</tex-math><mml:math id="M1040"><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq513.gif"/></alternatives></inline-formula>, and furthermore as <inline-formula id="IEq514"><alternatives><tex-math id="M1041">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_g$$\end{document}</tex-math><mml:math id="M1042"><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq514.gif"/></alternatives></inline-formula> has no cycles or parallel edges, this is a valid tail move.</p><p id="Par156">Let <inline-formula id="IEq515"><alternatives><tex-math id="M1043">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g=(x,y)$$\end{document}</tex-math><mml:math id="M1044"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq515.gif"/></alternatives></inline-formula> be an edge of one of these two paths. We first use a proof by contradiction to show that the move to <italic>g</italic> cannot create cycles, then we prove that we do not create parallel edges.</p><p id="Par157">Suppose moving <italic>e</italic> to <italic>g</italic> creates a cycle, then this cycle must involve the new edge <inline-formula id="IEq516"><alternatives><tex-math id="M1045">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e'$$\end{document}</tex-math><mml:math id="M1046"><mml:msup><mml:mi>e</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq516.gif"/></alternatives></inline-formula> from <italic>g</italic> to <italic>v</italic>. This means there is a path from <italic>v</italic> to <italic>x</italic>. However, <italic>x</italic> is above <italic>u</italic> or above <italic>s</italic>, which means that either the starting graph is not a phylogenetic network, or the move <italic>e</italic> to <italic>f</italic> is not valid. From this contradiction, we conclude that the move of <italic>e</italic> to <italic>g</italic> does not create cycles.</p><p id="Par158">Note that <italic>e</italic> is movable, because the move of <italic>e</italic> to <italic>f</italic> is valid. Hence, the only way to create parallel edges is by moving <inline-formula id="IEq517"><alternatives><tex-math id="M1047">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e=(u,v)$$\end{document}</tex-math><mml:math id="M1048"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq517.gif"/></alternatives></inline-formula> to an edge <inline-formula id="IEq518"><alternatives><tex-math id="M1049">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g=(x,y)$$\end{document}</tex-math><mml:math id="M1050"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq518.gif"/></alternatives></inline-formula> with <inline-formula id="IEq519"><alternatives><tex-math id="M1051">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y=v$$\end{document}</tex-math><mml:math id="M1052"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq519.gif"/></alternatives></inline-formula>. It is clear that <italic>g</italic> is not in the path <inline-formula id="IEq520"><alternatives><tex-math id="M1053">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathrm{LCA}}}(u,s)\rightarrow u$$\end{document}</tex-math><mml:math id="M1054"><mml:mrow><mml:mi mathvariant="normal">LCA</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq520.gif"/></alternatives></inline-formula>, as this would imply the existence of a cycle in the original network. Hence, <italic>g</italic> must be on the other path. If <inline-formula id="IEq521"><alternatives><tex-math id="M1055">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f=g$$\end{document}</tex-math><mml:math id="M1056"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq521.gif"/></alternatives></inline-formula>, then the original move of <italic>e</italic> to <italic>f</italic> would create parallel edges, and if <italic>g</italic> is above <italic>f</italic>, the original move moves <italic>e</italic> to below <italic>e</italic> creating a cycle. We conclude that there cannot be an edge <inline-formula id="IEq522"><alternatives><tex-math id="M1057">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g=(x,y)$$\end{document}</tex-math><mml:math id="M1058"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq522.gif"/></alternatives></inline-formula> on either path such that <inline-formula id="IEq523"><alternatives><tex-math id="M1059">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y=v$$\end{document}</tex-math><mml:math id="M1060"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq523.gif"/></alternatives></inline-formula>; hence, we do not create parallel edges.</p><p id="Par159">Noting that a path between two nodes uses at most <inline-formula id="IEq524"><alternatives><tex-math id="M1061">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|E|-|X|$$\end{document}</tex-math><mml:math id="M1062"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq524.gif"/></alternatives></inline-formula> edges, we see that we need at most <inline-formula id="IEq525"><alternatives><tex-math id="M1063">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|E|-|X|=|X|+3k-1$$\end{document}</tex-math><mml:math id="M1064"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq525.gif"/></alternatives></inline-formula> distance-1 tail moves to simulate a long distance tail move (the last equivalence holds by Observation <xref ref-type="sec" rid="FPar4">2.4</xref>). <inline-formula id="IEq526"><alternatives><tex-math id="M1065">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M1066"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq526.gif"/></alternatives></inline-formula></p><p>Note that a distance-<italic>d</italic> tail move cannot necessarily be simulated with a sequence of <italic>d</italic> distance-1 tail moves. The path of length <italic>d</italic> defining the distance of the tail move might not be a path over which we can move the tail, if for example some of its edges are below the head.</p><p>Lemma&#x000a0;<xref ref-type="sec" rid="FPar33">4.11</xref> directly gives us upper bounds on <inline-formula id="IEq527"><alternatives><tex-math id="M1067">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {Tail}_1$$\end{document}</tex-math><mml:math id="M1068"><mml:msub><mml:mtext>Tail</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq527.gif"/></alternatives></inline-formula> and rNNI diameters in terms of the tail diameter: each tail move is replaced by distance-1 tail moves, giving an upper bound of <inline-formula id="IEq528"><alternatives><tex-math id="M1069">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(3n+6k)(n+3k-1)$$\end{document}</tex-math><mml:math id="M1070"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq528.gif"/></alternatives></inline-formula> for tier <italic>k</italic> networks on <italic>n</italic> leaves. As we are mostly interested in the effect of the number of leaves, we denote these bounds <inline-formula id="IEq529"><alternatives><tex-math id="M1071">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta _k^{\text {Tail}_1}(n)=O(n^2)$$\end{document}</tex-math><mml:math id="M1072"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:msub><mml:mtext>Tail</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq529.gif"/></alternatives></inline-formula> and <inline-formula id="IEq530"><alternatives><tex-math id="M1073">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta _k^{\mathrm{rNNI}}(n)=O(n^2)$$\end{document}</tex-math><mml:math id="M1074"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">rNNI</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq530.gif"/></alternatives></inline-formula> (because <inline-formula id="IEq531"><alternatives><tex-math id="M1075">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {Tail}_1\subseteq \text {rNNI}$$\end{document}</tex-math><mml:math id="M1076"><mml:mrow><mml:msub><mml:mtext>Tail</mml:mtext><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02286;</mml:mo><mml:mtext>rNNI</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq531.gif"/></alternatives></inline-formula>).</p><p>Francis et al. (<xref ref-type="bibr" rid="CR8">2017</xref>) proved diameter bounds for <inline-formula id="IEq532"><alternatives><tex-math id="M1077">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{\mathrm{NNI}}$$\end{document}</tex-math><mml:math id="M1078"><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">NNI</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq532.gif"/></alternatives></inline-formula> on <italic>unrooted</italic> networks. These moves do not have to account for the orientation of edges. Therefore, they generally define larger classes of moves. More precisely, given a rooted network <italic>N</italic> with unrooted underlying graph <italic>U</italic>(<italic>N</italic>), the set of unrooted networks that can be reached with one NNI move from <italic>U</italic>(<italic>N</italic>) contains the set of unrooted networks we get by applying one rNNI move to <italic>N</italic> and then taking the underlying graph. Francis et al. give the following lower bound on NNI diameters using Echidna graphs&#x000a0;(Francis et&#x000a0;al. <xref ref-type="bibr" rid="CR8">2017</xref>,&#x000a0;Theorem&#x000a0;4.3):<disp-formula id="Equ8"><alternatives><tex-math id="M1079">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left[ (v_k^n-3)\log _6\left( \frac{v_k^n}{2}-2\right) -(2k-1)\log _6(k-1)-\left( v_k^n-2k\right) \log _6 e -2v_k^n\right] , \end{aligned}$$\end{document}</tex-math><mml:math id="M1080" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mn>6</mml:mn></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mn>2</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mfenced><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mn>6</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mfenced><mml:msub><mml:mo>log</mml:mo><mml:mn>6</mml:mn></mml:msub><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2018_452_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq533"><alternatives><tex-math id="M1081">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_k^n$$\end{document}</tex-math><mml:math id="M1082"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq533.gif"/></alternatives></inline-formula> is the number of nodes in an unrooted network with <inline-formula id="IEq534"><alternatives><tex-math id="M1083">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n+1$$\end{document}</tex-math><mml:math id="M1084"><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq534.gif"/></alternatives></inline-formula> leaves and <italic>k</italic> reticulation nodes. This lower bound is <inline-formula id="IEq535"><alternatives><tex-math id="M1085">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varOmega (n \log (n))$$\end{document}</tex-math><mml:math id="M1086"><mml:mrow><mml:mi>&#x003a9;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq535.gif"/></alternatives></inline-formula> for fixed <italic>k</italic>. As Echidna graphs are rootable (i.e., for each Echidna graph there exists some rooted network with this Echidna graph as underlying unrooted network), the argument of Francis et al. easily extends to rooted networks and we get the same lower bound for <inline-formula id="IEq536"><alternatives><tex-math id="M1087">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta _k^{\mathrm{rNNI}}(n)$$\end{document}</tex-math><mml:math id="M1088"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">rNNI</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq536.gif"/></alternatives></inline-formula>. The preceding discussion proves the following theorem:</p></sec><sec id="FPar35"><title>Theorem 4.12</title><p id="Par163">The diameter of tiers of network space for metrics induced by rNNI and distance-1 tail moves satisfy<disp-formula id="Equ9"><alternatives><tex-math id="M1089">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\varDelta _k^{\mathrm{rNNI}}(n)=\varOmega (n \log (n))\quad \mathrm{and }\quad \varDelta _k^{\mathrm{rNNI}}(n)=O(n^2),\\&#x00026;\varDelta _k^{\mathrm{Tail}_1}(n)=\varOmega (n \log (n))\quad \mathrm{and }\quad \varDelta _k^{\mathrm{Tail}_1}(n)=O(n^2). \end{aligned}$$\end{document}</tex-math><mml:math id="M1090" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">rNNI</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>&#x003a9;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="1em"/><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">rNNI</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:msub><mml:mi mathvariant="normal">Tail</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>&#x003a9;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="1em"/><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:msub><mml:mi mathvariant="normal">Tail</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2018_452_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>
</p></sec></sec><sec id="Sec11"><title>The Diameter of SPR Moves</title><p id="Par164">In this subsection, we will give a new upper bound on the diameter of SPR moves on unrooted networks, using results for rSPR moves on rooted networks. This linear bound improves on the previously best quadratic bound: <inline-formula id="IEq537"><alternatives><tex-math id="M1091">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(v_k^n)^2+4v_k^n$$\end{document}</tex-math><mml:math id="M1092"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq537.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq538"><alternatives><tex-math id="M1093">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_k^n$$\end{document}</tex-math><mml:math id="M1094"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq538.gif"/></alternatives></inline-formula> denotes the number of nodes in a tier <italic>k</italic> network with <italic>n</italic> leaves (Francis et&#x000a0;al. <xref ref-type="bibr" rid="CR8">2017</xref>).</p><p id="Par165">The underlying unrooted network of a rooted network <italic>N</italic> is denoted <italic>U</italic>(<italic>N</italic>). An unrooted network <italic>U</italic> is called <italic>rootable</italic> if there exists a rooted network <italic>N</italic> such that <inline-formula id="IEq539"><alternatives><tex-math id="M1095">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U(N)=U$$\end{document}</tex-math><mml:math id="M1096"><mml:mrow><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>U</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq539.gif"/></alternatives></inline-formula>. Note that as the root <italic>r</italic> of <italic>N</italic> has out degree 1 in <italic>N</italic>, <italic>r</italic> will be a leaf in <italic>U</italic>. As mentioned at the end of Sect.&#x000a0;<xref rid="Sec4" ref-type="sec">2.2</xref>, not all unrooted networks are rootable (see Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>).</p><p id="Par166">Any edge of an unrooted network whose removal disconnects the network is called a <italic>cut-edge</italic>. If only one of the components contains leaves, the edge is called a <italic>redundant cut-edge</italic>. A <italic>blob</italic> of an unrooted network is a non-trivial biconnected component, i.e. a maximal subgraph with at least two vertices and no cut-edges. The next lemma characterizes rootable networks via redundant cut-edges:</p><sec id="FPar36"><title>Lemma 4.13</title><p id="Par167">An unrooted network is rootable if and only if it has no redundant cut-edges.</p></sec><sec id="FPar37"><title>Proof</title><p id="Par168">First let&#x000a0;<italic>U</italic> be some unrooted network with no redundant cut-edges. To show that&#x000a0;<italic>U</italic> is rootable, we pick any leaf <italic>r</italic> of <italic>U</italic> and show how to construct a rooted network with <italic>U</italic> as underlying graph and <italic>r</italic> as root. First, orient all cut-edges &#x0201c;away&#x0201d; from&#x000a0;<italic>r</italic>. Then, it only remains to find a valid orientation of every blob. To this end, let <italic>B</italic> be a blob. After orienting all cut-edges, <italic>B</italic> has only one incoming edge (<italic>s</italic>,&#x000a0;<italic>t</italic>) and, as (<italic>s</italic>,&#x000a0;<italic>t</italic>) is not redundant, <italic>B</italic> has at least one outgoing edge (<italic>x</italic>,&#x000a0;<italic>y</italic>). Since <italic>B</italic> is biconnected, there is a bipolar (i.e. acyclic) orientation of <italic>B</italic> with <italic>t</italic> as source and <italic>x</italic> as sink (Lempel et&#x000a0;al. <xref ref-type="bibr" rid="CR12">1967</xref>). Doing the same for all biconnected components, we get an acyclic orientation of <italic>U</italic> rooted at <italic>r</italic>.</p><p id="Par169">Conversely, suppose that <italic>U</italic> has a redundant cut-edge&#x000a0;<italic>e</italic>. Deleting&#x000a0;<italic>e</italic> creates a component&#x000a0;<italic>C</italic> without leaves. If we direct&#x000a0;<italic>e</italic> towards&#x000a0;<italic>C</italic>, then&#x000a0;<italic>C</italic> has one source and no possible sinks (no leaves). If we direct&#x000a0;<italic>e</italic> away from&#x000a0;<italic>C</italic>, then&#x000a0;<italic>C</italic> has one sink but no possible sources (since the root is also a leaf). This implies there is no valid orientation of the edges in&#x000a0;<italic>C</italic> and therefore in <italic>U</italic>. <inline-formula id="IEq540"><alternatives><tex-math id="M1097">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M1098"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq540.gif"/></alternatives></inline-formula></p><p>A <italic>redundant terminal component</italic> of an unrooted network <italic>U</italic> is a non-trivial biconnected component that is incident to exactly one cut-edge (which must be a redundant cut-edge). The next lemma, which follows directly from Lemma&#x000a0;<xref ref-type="sec" rid="FPar36">4.13</xref>, characterizes rootable networks via redundant terminal components.</p></sec><sec id="FPar38"><title>Lemma 4.14</title><p id="Par171">An unrooted network is rootable if and only if it has no redundant terminal components.</p><p>We now give a formal definition of a SPR move:</p></sec><sec id="FPar39"><title>Definition 4.15</title><p id="Par173">Let <italic>U</italic> be an unrooted network, and let <inline-formula id="IEq541"><alternatives><tex-math id="M1099">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{u,v\}$$\end{document}</tex-math><mml:math id="M1100"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq541.gif"/></alternatives></inline-formula>, <inline-formula id="IEq542"><alternatives><tex-math id="M1101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{x,u\}$$\end{document}</tex-math><mml:math id="M1102"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq542.gif"/></alternatives></inline-formula>, <inline-formula id="IEq543"><alternatives><tex-math id="M1103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{u,y\}$$\end{document}</tex-math><mml:math id="M1104"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq543.gif"/></alternatives></inline-formula> and <italic>e</italic> be edges of <italic>U</italic>. The <italic>SPR move</italic> of the <italic>u</italic>-end of <inline-formula id="IEq544"><alternatives><tex-math id="M1105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{u,v\}$$\end{document}</tex-math><mml:math id="M1106"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq544.gif"/></alternatives></inline-formula> to <italic>e</italic> consists of the subdivision of <italic>e</italic> with <inline-formula id="IEq545"><alternatives><tex-math id="M1107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'$$\end{document}</tex-math><mml:math id="M1108"><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq545.gif"/></alternatives></inline-formula>, the removal of <inline-formula id="IEq546"><alternatives><tex-math id="M1109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{u,v\}$$\end{document}</tex-math><mml:math id="M1110"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq546.gif"/></alternatives></inline-formula>, the suppression of <italic>u</italic>, and the addition of edge <inline-formula id="IEq547"><alternatives><tex-math id="M1111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{u',v\}$$\end{document}</tex-math><mml:math id="M1112"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq547.gif"/></alternatives></inline-formula>. The move is only valid if the resulting graph is an unrooted network, i.e. if it is connected and has no parallel edges.</p><p>The next two lemmas give upper bounds for the number of redundant terminal components in an unrooted network with reticulation number <inline-formula id="IEq548"><alternatives><tex-math id="M1113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=|E|-|V|+1$$\end{document}</tex-math><mml:math id="M1114"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq548.gif"/></alternatives></inline-formula>, and for the number of SPR moves needed to get to an unrooted network without redundant terminal components.</p></sec><sec id="FPar40"><title>Lemma 4.16</title><p id="Par175">Let <italic>U</italic> be an unrooted network in the <italic>k</italic>th tier. Then <italic>U</italic> has at most <italic>k</italic>&#x000a0;/&#x000a0;3 redundant terminal components.</p></sec><sec id="FPar41"><title>Proof</title><p id="Par176">Let <inline-formula id="IEq549"><alternatives><tex-math id="M1115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V'$$\end{document}</tex-math><mml:math id="M1116"><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq549.gif"/></alternatives></inline-formula> be the nodes in a redundant terminal component, and <inline-formula id="IEq550"><alternatives><tex-math id="M1117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E'$$\end{document}</tex-math><mml:math id="M1118"><mml:msup><mml:mi>E</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq550.gif"/></alternatives></inline-formula> the edges with at least one endpoint in <inline-formula id="IEq551"><alternatives><tex-math id="M1119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V'$$\end{document}</tex-math><mml:math id="M1120"><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq551.gif"/></alternatives></inline-formula>. Then, every node in <inline-formula id="IEq552"><alternatives><tex-math id="M1121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V'$$\end{document}</tex-math><mml:math id="M1122"><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq552.gif"/></alternatives></inline-formula> has degree 3 with respect to&#x000a0;<inline-formula id="IEq553"><alternatives><tex-math id="M1123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E'$$\end{document}</tex-math><mml:math id="M1124"><mml:msup><mml:mi>E</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq553.gif"/></alternatives></inline-formula> and every edge in <inline-formula id="IEq554"><alternatives><tex-math id="M1125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E'$$\end{document}</tex-math><mml:math id="M1126"><mml:msup><mml:mi>E</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq554.gif"/></alternatives></inline-formula> except one has both endpoints in <inline-formula id="IEq555"><alternatives><tex-math id="M1127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V'$$\end{document}</tex-math><mml:math id="M1128"><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq555.gif"/></alternatives></inline-formula>, which implies that <inline-formula id="IEq556"><alternatives><tex-math id="M1129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3|V'| = 2|E'|- 1$$\end{document}</tex-math><mml:math id="M1130"><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq556.gif"/></alternatives></inline-formula>. It follows that <inline-formula id="IEq557"><alternatives><tex-math id="M1131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|V'|$$\end{document}</tex-math><mml:math id="M1132"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq557.gif"/></alternatives></inline-formula> is odd. Furthermore,&#x000a0;<inline-formula id="IEq558"><alternatives><tex-math id="M1133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V'$$\end{document}</tex-math><mml:math id="M1134"><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq558.gif"/></alternatives></inline-formula> must be greater than&#x000a0;3 in order for every node to have degree 3. Thus, <inline-formula id="IEq559"><alternatives><tex-math id="M1135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|V'|\ge 5$$\end{document}</tex-math><mml:math id="M1136"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02265;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq559.gif"/></alternatives></inline-formula>, and hence <inline-formula id="IEq560"><alternatives><tex-math id="M1137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|E'|-|V'| = (3|V'|+1)/2 - |V'| = (|V'|+1)/2 \ge (5+1)/2 = 3$$\end{document}</tex-math><mml:math id="M1138"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x02265;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq560.gif"/></alternatives></inline-formula>. Now observe that every node and edge of the network appear in at most one such set <inline-formula id="IEq561"><alternatives><tex-math id="M1139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V'$$\end{document}</tex-math><mml:math id="M1140"><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq561.gif"/></alternatives></inline-formula> or <inline-formula id="IEq562"><alternatives><tex-math id="M1141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E'$$\end{document}</tex-math><mml:math id="M1142"><mml:msup><mml:mi>E</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq562.gif"/></alternatives></inline-formula>. Furthermore, if all nodes and edges in all such sets <inline-formula id="IEq563"><alternatives><tex-math id="M1143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V'$$\end{document}</tex-math><mml:math id="M1144"><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq563.gif"/></alternatives></inline-formula> and <inline-formula id="IEq564"><alternatives><tex-math id="M1145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E'$$\end{document}</tex-math><mml:math id="M1146"><mml:msup><mml:mi>E</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq564.gif"/></alternatives></inline-formula> are deleted, the resulting graph <inline-formula id="IEq565"><alternatives><tex-math id="M1147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(V'',E'')$$\end{document}</tex-math><mml:math id="M1148"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq565.gif"/></alternatives></inline-formula> is still connected because only redundant terminal components are removed. Hence, the remaining part satisfies <inline-formula id="IEq566"><alternatives><tex-math id="M1149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|E''| - |V''| \ge -1$$\end{document}</tex-math><mml:math id="M1150"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02265;</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq566.gif"/></alternatives></inline-formula>. Note that <inline-formula id="IEq567"><alternatives><tex-math id="M1151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|E| - |V|$$\end{document}</tex-math><mml:math id="M1152"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq567.gif"/></alternatives></inline-formula> is equal to <inline-formula id="IEq568"><alternatives><tex-math id="M1153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|E''|-|V''|$$\end{document}</tex-math><mml:math id="M1154"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq568.gif"/></alternatives></inline-formula> plus the sum of all <inline-formula id="IEq569"><alternatives><tex-math id="M1155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|E'|-|V'|$$\end{document}</tex-math><mml:math id="M1156"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq569.gif"/></alternatives></inline-formula> for every redundant terminal component with nodes <inline-formula id="IEq570"><alternatives><tex-math id="M1157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V'$$\end{document}</tex-math><mml:math id="M1158"><mml:msup><mml:mi>V</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq570.gif"/></alternatives></inline-formula> and incident edges <inline-formula id="IEq571"><alternatives><tex-math id="M1159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E'$$\end{document}</tex-math><mml:math id="M1160"><mml:msup><mml:mi>E</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq571.gif"/></alternatives></inline-formula>. Thus, if <italic>U</italic> has <italic>t</italic> redundant terminal components, then<disp-formula id="Equ10"><alternatives><tex-math id="M1161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} |E|-|V| ={ |E''|-|V''| + \sum _{i=1}^{t}\Big (|E'_i|-|V'_i|\Big ) \ge |E''|-|V''| + 3t \ge 3t-1,} \end{aligned}$$\end{document}</tex-math><mml:math id="M1162" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo></mml:mrow><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>&#x02265;</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>t</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>3</mml:mn><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2018_452_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq572"><alternatives><tex-math id="M1163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_i$$\end{document}</tex-math><mml:math id="M1164"><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq572.gif"/></alternatives></inline-formula> and <inline-formula id="IEq573"><alternatives><tex-math id="M1165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_i$$\end{document}</tex-math><mml:math id="M1166"><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq573.gif"/></alternatives></inline-formula> denote the nodes and the edges of the <italic>i</italic>th redundant terminal component of <italic>U</italic>. It follows that if <italic>U</italic> has more than <inline-formula id="IEq574"><alternatives><tex-math id="M1167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=k/3$$\end{document}</tex-math><mml:math id="M1168"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq574.gif"/></alternatives></inline-formula> redundant terminal components, then the reticulation number of <italic>U</italic> is <inline-formula id="IEq575"><alternatives><tex-math id="M1169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|E|-|V|+1 &#x0003e; 3(k/3)$$\end{document}</tex-math><mml:math id="M1170"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x0003e;</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq575.gif"/></alternatives></inline-formula>, a contradiction. <inline-formula id="IEq576"><alternatives><tex-math id="M1171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M1172"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq576.gif"/></alternatives></inline-formula></p></sec><sec id="FPar42"><title>Lemma 4.17</title><p id="Par177">Let <italic>N</italic> be an unrooted network in the <italic>k</italic>th tier with <italic>c</italic> redundant terminal components. Then, there exists an unrooted network <inline-formula id="IEq577"><alternatives><tex-math id="M1173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M1174"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq577.gif"/></alternatives></inline-formula> in the <italic>k</italic>th tier with at most <inline-formula id="IEq578"><alternatives><tex-math id="M1175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c-1$$\end{document}</tex-math><mml:math id="M1176"><mml:mrow><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq578.gif"/></alternatives></inline-formula> redundant terminal components such that <inline-formula id="IEq579"><alternatives><tex-math id="M1177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{\mathrm{SPR}}(N,N')=1$$\end{document}</tex-math><mml:math id="M1178"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">SPR</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq579.gif"/></alternatives></inline-formula>.</p></sec><sec id="FPar43"><title>Proof</title><p id="Par178">Pick any redundant terminal component <italic>B</italic> and let <inline-formula id="IEq580"><alternatives><tex-math id="M1179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{u,v\}$$\end{document}</tex-math><mml:math id="M1180"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq580.gif"/></alternatives></inline-formula> be the unique edge for which <inline-formula id="IEq581"><alternatives><tex-math id="M1181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u \notin B$$\end{document}</tex-math><mml:math id="M1182"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&#x02209;</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq581.gif"/></alternatives></inline-formula>, <inline-formula id="IEq582"><alternatives><tex-math id="M1183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v \in B$$\end{document}</tex-math><mml:math id="M1184"><mml:mrow><mml:mi>v</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq582.gif"/></alternatives></inline-formula>. Let <italic>x</italic> and <italic>y</italic> be the other neighbours of <italic>v</italic>. Now SPR move the <italic>v</italic>-end of edge <inline-formula id="IEq583"><alternatives><tex-math id="M1185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{v,x\}$$\end{document}</tex-math><mml:math id="M1186"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq583.gif"/></alternatives></inline-formula> to a leaf edge of <italic>U</italic>. Suppressing <italic>v</italic> cannot give parallel edges, because <inline-formula id="IEq584"><alternatives><tex-math id="M1187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{u,v\}$$\end{document}</tex-math><mml:math id="M1188"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq584.gif"/></alternatives></inline-formula> is a cut-edge (Fig.&#x000a0;<xref rid="Fig19" ref-type="fig">19</xref>). In the resulting unrooted network, <italic>B</italic> is extended to a biconnected component with a pendant leaf, and because no new cut-edges have been created, the network has at most <inline-formula id="IEq585"><alternatives><tex-math id="M1189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c-1$$\end{document}</tex-math><mml:math id="M1190"><mml:mrow><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq585.gif"/></alternatives></inline-formula> redundant terminal components and is one SPR move away from the original unrooted network. Note that the networks are in the same tier because an SPR move does not change the number of edges nor the number of vertices. <inline-formula id="IEq586"><alternatives><tex-math id="M1191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M1192"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq586.gif"/></alternatives></inline-formula></p><p>
<fig id="Fig19"><label>Fig. 19</label><caption><p>The SPR move used to remove redundant terminal component <italic>B</italic>. The big circle represents all of <italic>U</italic> except for <italic>B</italic>. Note that in the unrooted network on the right, <italic>B</italic> is not a redundant terminal component anymore, and no extra redundant terminal components have been created</p></caption><graphic xlink:href="11538_2018_452_Fig19_HTML" id="MO56"/></fig>
</p><p>Lemmas&#x000a0;<xref ref-type="sec" rid="FPar38">4.14</xref>,&#x000a0;<xref ref-type="sec" rid="FPar40">4.16</xref> and&#x000a0;<xref ref-type="sec" rid="FPar42">4.17</xref> imply the following:</p></sec><sec id="FPar44"><title>Corollary 4.18</title><p id="Par181">Any tier <italic>k</italic> unrooted network is at most <italic>k</italic>&#x000a0;/&#x000a0;3 SPR moves away from a rootable network.</p><p>The next two results relate a set of rSPR moves between two rooted networks and the corresponding set of SPR moves between their underlying unrooted networks.</p></sec><sec id="FPar45"><title>Lemma 4.19</title><p id="Par183">Any rSPR move transforming a rooted network <italic>N</italic> into another rooted network <inline-formula id="IEq587"><alternatives><tex-math id="M1193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M1194"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq587.gif"/></alternatives></inline-formula> has a corresponding SPR move transforming <italic>U</italic>(<italic>N</italic>) into <inline-formula id="IEq588"><alternatives><tex-math id="M1195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U(N')$$\end{document}</tex-math><mml:math id="M1196"><mml:mrow><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq588.gif"/></alternatives></inline-formula>.</p></sec><sec id="FPar46"><title>Proof</title><p id="Par184">Suppose that the rSPR move is a head move of (<italic>u</italic>,&#x000a0;<italic>v</italic>) to <italic>e</italic>. Then, <inline-formula id="IEq589"><alternatives><tex-math id="M1197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U(N')$$\end{document}</tex-math><mml:math id="M1198"><mml:mrow><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq589.gif"/></alternatives></inline-formula> is the unrooted network we get by doing the SPR move of the <italic>v</italic>-end of <inline-formula id="IEq590"><alternatives><tex-math id="M1199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{u,v\}$$\end{document}</tex-math><mml:math id="M1200"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq590.gif"/></alternatives></inline-formula> to <italic>e</italic>. This SPR move is valid because <inline-formula id="IEq591"><alternatives><tex-math id="M1201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M1202"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq591.gif"/></alternatives></inline-formula>, and therefore <inline-formula id="IEq592"><alternatives><tex-math id="M1203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U(N')$$\end{document}</tex-math><mml:math id="M1204"><mml:mrow><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq592.gif"/></alternatives></inline-formula> is connected with no parallel edges. Similarly, a tail move of&#x000a0;(<italic>u</italic>,&#x000a0;<italic>v</italic>) to&#x000a0;<italic>e</italic> has a corresponding SPR move moving the <italic>u</italic>-end of&#x000a0;<inline-formula id="IEq593"><alternatives><tex-math id="M1205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{u,v\}$$\end{document}</tex-math><mml:math id="M1206"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq593.gif"/></alternatives></inline-formula> to&#x000a0;<italic>e</italic>. <inline-formula id="IEq594"><alternatives><tex-math id="M1207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M1208"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq594.gif"/></alternatives></inline-formula></p></sec><sec id="FPar47"><title>Corollary 4.20</title><p id="Par185">Any rSPR sequence transforming a rooted network <italic>N</italic> into another rooted network <inline-formula id="IEq595"><alternatives><tex-math id="M1209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M1210"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq595.gif"/></alternatives></inline-formula> has a corresponding SPR sequence transforming <italic>U</italic>(<italic>N</italic>) into <inline-formula id="IEq596"><alternatives><tex-math id="M1211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U(N')$$\end{document}</tex-math><mml:math id="M1212"><mml:mrow><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq596.gif"/></alternatives></inline-formula>.</p><p>Moreover, since any rootable network is the underlying graph <italic>U</italic>(<italic>N</italic>) of some rooted network <italic>N</italic>, the diameter for rSPR on rooted networks gives an upper bound for the diameter of SPR moves on unrooted rootable networks.</p><p>We do not apply the following proposition here, but it may become useful when a better bound on <inline-formula id="IEq597"><alternatives><tex-math id="M1213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta _k^{\text {rSPR}}(n)$$\end{document}</tex-math><mml:math id="M1214"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mtext>rSPR</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq597.gif"/></alternatives></inline-formula> is found in future research.</p></sec><sec id="FPar48"><title>Proposition 4.21</title><p id="Par188">The diameter of the <italic>k</italic>th tier of unrooted network space has upper bound<disp-formula id="Equ11"><alternatives><tex-math id="M1215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varDelta _k^{\mathrm{SPR}}(n)\le \varDelta _k^{\mathrm{rSPR}}(n)+2M, \end{aligned}$$\end{document}</tex-math><mml:math id="M1216" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">SPR</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02264;</mml:mo><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">rSPR</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>M</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2018_452_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where <italic>M</italic> denotes the maximal SPR distance from any unrooted network to a rootable network.</p></sec><sec id="FPar49"><title>Proof</title><p id="Par189">Let <italic>N</italic> and <inline-formula id="IEq598"><alternatives><tex-math id="M1217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M1218"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq598.gif"/></alternatives></inline-formula> be tier <italic>k</italic> unrooted networks. Then, we can do <italic>M</italic> moves from <italic>N</italic> and <italic>M</italic> moves from <inline-formula id="IEq599"><alternatives><tex-math id="M1219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M1220"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq599.gif"/></alternatives></inline-formula> to get to rootable networks <inline-formula id="IEq600"><alternatives><tex-math id="M1221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_r$$\end{document}</tex-math><mml:math id="M1222"><mml:msub><mml:mi>N</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq600.gif"/></alternatives></inline-formula> and <inline-formula id="IEq601"><alternatives><tex-math id="M1223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'_r$$\end{document}</tex-math><mml:math id="M1224"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq601.gif"/></alternatives></inline-formula>. Choose a root for both these rootable networks, then by Corollary&#x000a0;<xref ref-type="sec" rid="FPar47">4.20</xref> there is a sequence of at most <inline-formula id="IEq602"><alternatives><tex-math id="M1225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta _k^{\text {rSPR}}(n)$$\end{document}</tex-math><mml:math id="M1226"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mtext>rSPR</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq602.gif"/></alternatives></inline-formula> moves to go from <inline-formula id="IEq603"><alternatives><tex-math id="M1227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_r$$\end{document}</tex-math><mml:math id="M1228"><mml:msub><mml:mi>N</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq603.gif"/></alternatives></inline-formula> to <inline-formula id="IEq604"><alternatives><tex-math id="M1229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'_r$$\end{document}</tex-math><mml:math id="M1230"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq604.gif"/></alternatives></inline-formula>. Because all moves are reversible, there is a sequence of moves:<disp-formula id="Equ13"><graphic xlink:href="11538_2018_452_Equ13_HTML.gif" position="anchor"/></disp-formula>of length at most <inline-formula id="IEq605"><alternatives><tex-math id="M1231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varDelta _k^{\text {rSPR}}(n)+2M$$\end{document}</tex-math><mml:math id="M1232"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mtext>rSPR</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq605.gif"/></alternatives></inline-formula> from <italic>N</italic> to <inline-formula id="IEq606"><alternatives><tex-math id="M1233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M1234"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq606.gif"/></alternatives></inline-formula>. <inline-formula id="IEq607"><alternatives><tex-math id="M1235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M1236"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq607.gif"/></alternatives></inline-formula></p><p>This proposition together with Corollary&#x000a0;<xref ref-type="sec" rid="FPar44">4.18</xref> and Theorem&#x000a0;<xref ref-type="sec" rid="FPar29">4.8</xref> gives a reasonable bound on the diameter of unrooted networks, namely <inline-formula id="IEq608"><alternatives><tex-math id="M1237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2|X|+3k+\frac{2}{3}k$$\end{document}</tex-math><mml:math id="M1238"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq608.gif"/></alternatives></inline-formula>. However, using the (lack of) structure in an unrooted network, we can do better. The next theorem again uses rooted networks, but dynamically re-orientates the network during the induction.</p></sec><sec id="FPar50"><title>Theorem 4.22</title><p id="Par191">The SPR diameter of the <italic>k</italic>-tier of unrooted network space has upper bound<disp-formula id="Equ12"><alternatives><tex-math id="M1239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \varDelta _k^{\mathrm{SPR}}(n) \le n+\frac{8}{3}k. \end{aligned}$$\end{document}</tex-math><mml:math id="M1240" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>&#x00394;</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">SPR</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02264;</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>8</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2018_452_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>
</p></sec><sec id="FPar51"><title>Proof</title><p id="Par192">Let <italic>N</italic> and <inline-formula id="IEq609"><alternatives><tex-math id="M1241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M1242"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq609.gif"/></alternatives></inline-formula> be tier <italic>k</italic> unrooted networks. As before, we use <inline-formula id="IEq610"><alternatives><tex-math id="M1243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{2}{3}k$$\end{document}</tex-math><mml:math id="M1244"><mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq610.gif"/></alternatives></inline-formula> moves to produce rootable networks <inline-formula id="IEq611"><alternatives><tex-math id="M1245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_r$$\end{document}</tex-math><mml:math id="M1246"><mml:msub><mml:mi>N</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq611.gif"/></alternatives></inline-formula> and <inline-formula id="IEq612"><alternatives><tex-math id="M1247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'_r$$\end{document}</tex-math><mml:math id="M1248"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq612.gif"/></alternatives></inline-formula>. Now we do induction as in the proof of the rooted rSPR diameter (Theorem&#x000a0;<xref ref-type="sec" rid="FPar29">4.8</xref>). Choose a network orientation on both rootable networks. As before, we construct the downward-closed subsets <italic>Y</italic> and <inline-formula id="IEq613"><alternatives><tex-math id="M1249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M1250"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq613.gif"/></alternatives></inline-formula> of <inline-formula id="IEq614"><alternatives><tex-math id="M1251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_r$$\end{document}</tex-math><mml:math id="M1252"><mml:msub><mml:mi>N</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq614.gif"/></alternatives></inline-formula> and <inline-formula id="IEq615"><alternatives><tex-math id="M1253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'_r$$\end{document}</tex-math><mml:math id="M1254"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq615.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq616"><alternatives><tex-math id="M1255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_r|_{Y}$$\end{document}</tex-math><mml:math id="M1256"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>Y</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq616.gif"/></alternatives></inline-formula> and <inline-formula id="IEq617"><alternatives><tex-math id="M1257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'_r|_{Y'}$$\end{document}</tex-math><mml:math id="M1258"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq617.gif"/></alternatives></inline-formula> are isomorphic. We prove that we need at most <inline-formula id="IEq618"><alternatives><tex-math id="M1259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n+2k$$\end{document}</tex-math><mml:math id="M1260"><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq618.gif"/></alternatives></inline-formula> moves in total to produce the rootable network <inline-formula id="IEq619"><alternatives><tex-math id="M1261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'_r$$\end{document}</tex-math><mml:math id="M1262"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq619.gif"/></alternatives></inline-formula> from <inline-formula id="IEq620"><alternatives><tex-math id="M1263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_r$$\end{document}</tex-math><mml:math id="M1264"><mml:msub><mml:mi>N</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq620.gif"/></alternatives></inline-formula> by inductively increasing the size of <italic>Y</italic> and <inline-formula id="IEq621"><alternatives><tex-math id="M1265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M1266"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq621.gif"/></alternatives></inline-formula>.</p><p id="Par193">As in the proof of Theorem&#x000a0;<xref ref-type="sec" rid="FPar29">4.8</xref>, we can add a node to <italic>Y</italic> and <inline-formula id="IEq622"><alternatives><tex-math id="M1267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M1268"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq622.gif"/></alternatives></inline-formula> using at most one move, except in the case that all lowest nodes are tree nodes and the nodes corresponding to their child nodes have unmovable incoming edges. We now show how this case can be treated differently if we consider SPR moves on unrooted networks.<fig id="Fig20"><label>Fig. 20</label><caption><p>The re-orientation of the bottom edge of a triangle, all of whose nodes are above <italic>Y</italic></p></caption><graphic xlink:href="11538_2018_452_Fig20_HTML" id="MO57"/></fig>
</p><p id="Par194">Suppose we are in the situation of Case&#x000a0;3(b)iii. We shortly recall the situation: <italic>Every lowest node of</italic>
<inline-formula id="IEq623"><alternatives><tex-math id="M1269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \setminus Y$$\end{document}</tex-math><mml:math id="M1270"><mml:mrow><mml:mi>N</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq623.gif"/></alternatives></inline-formula>
<italic>and every lowest node of</italic>
<inline-formula id="IEq624"><alternatives><tex-math id="M1271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'\setminus Y'$$\end{document}</tex-math><mml:math id="M1272"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq624.gif"/></alternatives></inline-formula>
<italic>is not a reticulation, so there exists a node</italic>
<inline-formula id="IEq625"><alternatives><tex-math id="M1273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u'\in N'\setminus Y'$$\end{document}</tex-math><mml:math id="M1274"><mml:mrow><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq625.gif"/></alternatives></inline-formula>
<italic>with children</italic>
<inline-formula id="IEq626"><alternatives><tex-math id="M1275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x',y'\in Y'$$\end{document}</tex-math><mml:math id="M1276"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq626.gif"/></alternatives></inline-formula>. <italic>Let</italic>
<italic>x</italic>,&#x000a0;<italic>y</italic>
<italic>be the nodes in</italic>
<italic>Y</italic>
<italic>corresponding to</italic>
<inline-formula id="IEq627"><alternatives><tex-math id="M1277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M1278"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq627.gif"/></alternatives></inline-formula>
<italic>and</italic>
<inline-formula id="IEq628"><alternatives><tex-math id="M1279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y'$$\end{document}</tex-math><mml:math id="M1280"><mml:msup><mml:mi>y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq628.gif"/></alternatives></inline-formula>. <italic>The nodes</italic>
<italic>x</italic>
<italic>and</italic>
<italic>y</italic>
<italic>do not have a common parent not in</italic>
<italic>Y</italic>. <italic>Let</italic>
<inline-formula id="IEq629"><alternatives><tex-math id="M1281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_x$$\end{document}</tex-math><mml:math id="M1282"><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq629.gif"/></alternatives></inline-formula>
<italic>and</italic>
<inline-formula id="IEq630"><alternatives><tex-math id="M1283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_y$$\end{document}</tex-math><mml:math id="M1284"><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq630.gif"/></alternatives></inline-formula>
<italic>be parents of</italic>
<italic>x</italic>
<italic>and</italic>
<italic>y</italic>
<italic>not contained in</italic>
<italic>Y</italic>. <italic>Neither</italic>
<inline-formula id="IEq631"><alternatives><tex-math id="M1285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_x,x)$$\end{document}</tex-math><mml:math id="M1286"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq631.gif"/></alternatives></inline-formula>
<italic>nor</italic>
<inline-formula id="IEq632"><alternatives><tex-math id="M1287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_y,y)$$\end{document}</tex-math><mml:math id="M1288"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq632.gif"/></alternatives></inline-formula>
<italic>is movable, so</italic>
<inline-formula id="IEq633"><alternatives><tex-math id="M1289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_x$$\end{document}</tex-math><mml:math id="M1290"><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq633.gif"/></alternatives></inline-formula>
<italic>forms a triangle together with its parent</italic>
<inline-formula id="IEq634"><alternatives><tex-math id="M1291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_x$$\end{document}</tex-math><mml:math id="M1292"><mml:msub><mml:mi>c</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq634.gif"/></alternatives></inline-formula>
<italic>and its other child</italic>
<inline-formula id="IEq635"><alternatives><tex-math id="M1293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_x$$\end{document}</tex-math><mml:math id="M1294"><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq635.gif"/></alternatives></inline-formula>, <italic>and similarly</italic>
<inline-formula id="IEq636"><alternatives><tex-math id="M1295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(c_y,z_y,d_y)$$\end{document}</tex-math><mml:math id="M1296"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq636.gif"/></alternatives></inline-formula>
<italic>also forms a triangle.</italic> We distinguish three subcases:<list list-type="order"><list-item><p id="Par195"><inline-formula id="IEq637"><alternatives><tex-math id="M1297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{d_y\not \in Y}$$\end{document}</tex-math><mml:math id="M1298"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo mathvariant="bold">&#x02209;</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq637.gif"/></alternatives></inline-formula> Inverting the orientation of <inline-formula id="IEq638"><alternatives><tex-math id="M1299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_y,d_y)$$\end{document}</tex-math><mml:math id="M1300"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq638.gif"/></alternatives></inline-formula> gives a valid orientation with the same underlying unrooted network, and conserves the downward-closedness of <italic>Y</italic> and the isomorphism between <italic>Y</italic> and <inline-formula id="IEq639"><alternatives><tex-math id="M1301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M1302"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq639.gif"/></alternatives></inline-formula> (Fig.&#x000a0;<xref rid="Fig20" ref-type="fig">20</xref>). The resulting rooted network has a reticulation node directly above <italic>Y</italic>, so we can add a node to <italic>Y</italic> and <inline-formula id="IEq640"><alternatives><tex-math id="M1303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M1304"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq640.gif"/></alternatives></inline-formula> with at most one move.</p></list-item><list-item><p id="Par196"><inline-formula id="IEq641"><alternatives><tex-math id="M1305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{d_x\not \in Y}$$\end{document}</tex-math><mml:math id="M1306"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub><mml:mo mathvariant="bold">&#x02209;</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq641.gif"/></alternatives></inline-formula> This case is handled symmetrically to Case&#x000a0;1 by inverting the orientation of <inline-formula id="IEq642"><alternatives><tex-math id="M1307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_x,d_x)$$\end{document}</tex-math><mml:math id="M1308"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq642.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par197"><inline-formula id="IEq643"><alternatives><tex-math id="M1309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{d_x,d_y\in Y}$$\end{document}</tex-math><mml:math id="M1310"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mi mathvariant="bold-italic">x</mml:mi></mml:msub><mml:mo mathvariant="bold">,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">d</mml:mi><mml:mi mathvariant="bold-italic">y</mml:mi></mml:msub><mml:mo mathvariant="bold">&#x02208;</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq643.gif"/></alternatives></inline-formula> Note that one of <inline-formula id="IEq644"><alternatives><tex-math id="M1311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(u',x')$$\end{document}</tex-math><mml:math id="M1312"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq644.gif"/></alternatives></inline-formula> and <inline-formula id="IEq645"><alternatives><tex-math id="M1313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(u',y')$$\end{document}</tex-math><mml:math id="M1314"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq645.gif"/></alternatives></inline-formula> is movable (Observation&#x000a0;<xref ref-type="sec" rid="FPar10">2.10</xref>).<list list-type="alpha-lower"><list-item><p id="Par198"><inline-formula id="IEq646"><alternatives><tex-math id="M1315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{(u',x')}$$\end{document}</tex-math><mml:math id="M1316"><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo mathvariant="bold">&#x02032;</mml:mo></mml:msup><mml:mo mathvariant="bold">,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold">&#x02032;</mml:mo></mml:msup><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq646.gif"/></alternatives></inline-formula>
<bold>is movable</bold> Tail moving <inline-formula id="IEq647"><alternatives><tex-math id="M1317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(u',x')$$\end{document}</tex-math><mml:math id="M1318"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq647.gif"/></alternatives></inline-formula> to an incoming edge of <inline-formula id="IEq648"><alternatives><tex-math id="M1319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_x'$$\end{document}</tex-math><mml:math id="M1320"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq648.gif"/></alternatives></inline-formula>, the node in <inline-formula id="IEq649"><alternatives><tex-math id="M1321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M1322"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq649.gif"/></alternatives></inline-formula> corresponding to <inline-formula id="IEq650"><alternatives><tex-math id="M1323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_x$$\end{document}</tex-math><mml:math id="M1324"><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq650.gif"/></alternatives></inline-formula>, we create a lowest tree node <inline-formula id="IEq651"><alternatives><tex-math id="M1325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_x'$$\end{document}</tex-math><mml:math id="M1326"><mml:msubsup><mml:mi>z</mml:mi><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq651.gif"/></alternatives></inline-formula> with children <inline-formula id="IEq652"><alternatives><tex-math id="M1327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M1328"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq652.gif"/></alternatives></inline-formula> and <inline-formula id="IEq653"><alternatives><tex-math id="M1329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_x'$$\end{document}</tex-math><mml:math id="M1330"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq653.gif"/></alternatives></inline-formula> in <inline-formula id="IEq654"><alternatives><tex-math id="M1331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M1332"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq654.gif"/></alternatives></inline-formula> (Fig.&#x000a0;<xref rid="Fig21" ref-type="fig">21</xref>). We can add <inline-formula id="IEq655"><alternatives><tex-math id="M1333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_x$$\end{document}</tex-math><mml:math id="M1334"><mml:msub><mml:mi>z</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq655.gif"/></alternatives></inline-formula> (with children <italic>x</italic> and <inline-formula id="IEq656"><alternatives><tex-math id="M1335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_x$$\end{document}</tex-math><mml:math id="M1336"><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq656.gif"/></alternatives></inline-formula>) and <inline-formula id="IEq657"><alternatives><tex-math id="M1337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z_x'$$\end{document}</tex-math><mml:math id="M1338"><mml:msubsup><mml:mi>z</mml:mi><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq657.gif"/></alternatives></inline-formula> (with children <inline-formula id="IEq658"><alternatives><tex-math id="M1339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x'$$\end{document}</tex-math><mml:math id="M1340"><mml:msup><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq658.gif"/></alternatives></inline-formula> and <inline-formula id="IEq659"><alternatives><tex-math id="M1341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_x'$$\end{document}</tex-math><mml:math id="M1342"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq659.gif"/></alternatives></inline-formula>) to <italic>Y</italic> and <inline-formula id="IEq660"><alternatives><tex-math id="M1343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M1344"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq660.gif"/></alternatives></inline-formula> at the cost of one move.</p></list-item><list-item><p id="Par199"><inline-formula id="IEq661"><alternatives><tex-math id="M1345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{(u',y')}$$\end{document}</tex-math><mml:math id="M1346"><mml:mrow><mml:mo mathvariant="bold" stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo mathvariant="bold">&#x02032;</mml:mo></mml:msup><mml:mo mathvariant="bold">,</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo mathvariant="bold">&#x02032;</mml:mo></mml:msup><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq661.gif"/></alternatives></inline-formula>
<bold>is movable</bold> This case is handled symmetrically to the previous case by interchanging the roles of <italic>x</italic> and <italic>y</italic>.</p></list-item></list>
</p></list-item></list>This proves that we can always add a node to <italic>Y</italic> and <inline-formula id="IEq662"><alternatives><tex-math id="M1347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y'$$\end{document}</tex-math><mml:math id="M1348"><mml:msup><mml:mi>Y</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq662.gif"/></alternatives></inline-formula> using at most one SPR move. Hence, the number of SPR moves needed to transform <inline-formula id="IEq663"><alternatives><tex-math id="M1349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_r$$\end{document}</tex-math><mml:math id="M1350"><mml:msub><mml:mi>N</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq663.gif"/></alternatives></inline-formula> into <inline-formula id="IEq664"><alternatives><tex-math id="M1351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_r'$$\end{document}</tex-math><mml:math id="M1352"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq664.gif"/></alternatives></inline-formula> is at most <inline-formula id="IEq665"><alternatives><tex-math id="M1353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|V| = n+2k$$\end{document}</tex-math><mml:math id="M1354"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq665.gif"/></alternatives></inline-formula>. Together with the moves needed to get to <inline-formula id="IEq666"><alternatives><tex-math id="M1355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_r$$\end{document}</tex-math><mml:math id="M1356"><mml:msub><mml:mi>N</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq666.gif"/></alternatives></inline-formula> and <inline-formula id="IEq667"><alternatives><tex-math id="M1357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_r'$$\end{document}</tex-math><mml:math id="M1358"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq667.gif"/></alternatives></inline-formula> from <italic>N</italic> and <inline-formula id="IEq668"><alternatives><tex-math id="M1359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M1360"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq668.gif"/></alternatives></inline-formula>, we get an upper bound of <inline-formula id="IEq669"><alternatives><tex-math id="M1361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n+\frac{8}{3}k$$\end{document}</tex-math><mml:math id="M1362"><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>8</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq669.gif"/></alternatives></inline-formula> for the number of SPR moves needed to go from <italic>N</italic> to <inline-formula id="IEq670"><alternatives><tex-math id="M1363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N'$$\end{document}</tex-math><mml:math id="M1364"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq670.gif"/></alternatives></inline-formula>. <inline-formula id="IEq671"><alternatives><tex-math id="M1365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M1366"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq671.gif"/></alternatives></inline-formula></p><p>
<fig id="Fig21"><label>Fig. 21</label><caption><p>(Color figure online) The tail move used in the proof of Case 3a in the proof of Theorem <xref ref-type="sec" rid="FPar50">4.22</xref></p></caption><graphic xlink:href="11538_2018_452_Fig21_HTML" id="MO58"/></fig>
</p></sec></sec></sec><sec id="Sec12"><title>Discussion</title><p id="Par201">In a rooted phylogenetic tree, each rSPR move is a tail move, while in a network one can also perform head moves. Hence, it is natural to define rSPR moves in networks as the union of head and tail moves&#x000a0;(Gambette et&#x000a0;al. <xref ref-type="bibr" rid="CR9">2017</xref>). However, we have shown that to connect the tiers of phylogenetic network space, tail moves are sufficient (except for one trivial case with only two taxa). In fact, tail moves, by themselves, can also be seen as a natural generalization of rSPR moves on trees to networks.</p><p id="Par202">Nevertheless, there can be several reasons to consider head moves in addition to tail moves when exploring the tiers of network space. First of all, the number of tail moves that one needs to transform one network into another may be bigger than the number of rSPR moves. The difference is not very big though; we have shown that at most four tail moves are sufficient to mimic one head move (assuming&#x000a0;<inline-formula id="IEq672"><alternatives><tex-math id="M1367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X|\ge 3$$\end{document}</tex-math><mml:math id="M1368"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02265;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq672.gif"/></alternatives></inline-formula>). Another reason to use head moves is when a search using only tail moves gets stuck in a local optimum. A head move can then be used to escape from this local optimum. Notice that a head move can basically move a reticulation to a completely different location in the network. Hence, from a biological point of view, head moves can change a network more drastically than tail moves.</p><p id="Par203">On rooted phylogenetic trees, rNNI moves can be seen as distance-1 rSPR moves. Therefore, it is natural to define rNNI moves in the same way on networks (see Gambette et&#x000a0;al. <xref ref-type="bibr" rid="CR9">2017</xref>). Hence, rNNI moves on networks are distance-1 head moves and distance-1 tail moves. Also for this case, we have shown that the distance-1 head moves may be omitted while preserving connectivity (again excluding one two-taxa case).</p><p id="Par204">To determine which moves explore network space most efficiently, practical experiments are necessary. It seems reasonable to believe that a combination of different types of moves will work best. Distance-1 head and tail moves are local moves that change only a small part of the network, and the number of possible moves is relatively small. Therefore, such moves are suitable for finding a local optimum. General tail and head moves are not local and can therefore be useful to move away from local optima in order to search for a global optimum. Implementing and analysing such local-search methods is an important topic for future research.<fig id="Fig22"><label>Fig. 22</label><caption><p>Two networks for which subtree reduction does not preserve tail-move distance</p></caption><graphic xlink:href="11538_2018_452_Fig22_HTML" id="MO59"/></fig>
</p><p id="Par205">Another interesting direction is to develop algorithms for computing the tail-move distance between networks. Although we have shown that this problem is NP-hard, we do not know, for example, whether it is fixed-parameter tractable, with the tail move distance as parameter. We note that several common reduction rules, such as subtree and cluster reduction, are not always safe for this problem, in the sense that applying them may increase the tail move distance (see Bordewich and Semple <xref ref-type="bibr" rid="CR3">2005</xref>; Bordewich et&#x000a0;al. <xref ref-type="bibr" rid="CR5">2017b</xref>, for a definition of these reductions and the chain reduction mentioned below). As an extreme example, consider the networks in Fig.&#x000a0;<xref rid="Fig22" ref-type="fig">22</xref>, which have tail-move distance&#x000a0;3. After reducing the subtrees on <inline-formula id="IEq673"><alternatives><tex-math id="M1369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{y,z\}$$\end{document}</tex-math><mml:math id="M1370"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq673.gif"/></alternatives></inline-formula> to a single leaf, the tail move distance becomes infinite. It could, however, be safe to reduce subtrees to size&#x000a0;2. Similar arguments hold for cluster reduction. Another interesting question is whether reducing chains to length&#x000a0;2 (or any other constant length) is safe.</p><p id="Par206">Finally, a major open problem concerns the rNNI diameter as well as the distance-1 tail move diameter: Are these diameters quadratic in the number of leaves, or <inline-formula id="IEq674"><alternatives><tex-math id="M1371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(n\log (n))$$\end{document}</tex-math><mml:math id="M1372"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>log</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2018_452_Article_IEq674.gif"/></alternatives></inline-formula>? For tail, rSPR and SPR moves, we know that the diameter is linear in the number of leaves, but it would be interesting to find tight bounds (see Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref>).</p></sec></body><back><fn-group><fn id="Fn1"><label>1</label><p id="Par94">Mycorrhizal forests are so-called because of their similarity to real-life mycorrhizal networks, in which a number of trees may be connected together by an underground network of fungi.</p></fn></fn-group><notes notes-type="funding-information"><title>Funding</title><p>Remie Janssen and Mark Jones were supported by Vidi Grant 639.072.602 from the Netherlands Organization for Scientific Research (NWO). Leo van Iersel was partly supported by NWO, including Vidi Grant 639.072.602, and partly by the 4TU Applied Mathematics Institute. P&#x000e9;ter L. Erd&#x00151;s was partly supported by the Hungarian National Research, Development and Innovation Office NKFIH, under the Grants K 116769 and SNN 116095. Celine Scornavacca was partially supported by the French Agence Nationale de la Recherche Investissements d&#x02019;Avenir/ Bioinformatique (ANR-10-BINF-01-02, Ancestrome).</p></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abbott</surname><given-names>R</given-names></name><name><surname>Albach</surname><given-names>D</given-names></name><name><surname>Ansell</surname><given-names>S</given-names></name><name><surname>Arntzen</surname><given-names>JW</given-names></name><name><surname>Baird</surname><given-names>SJ</given-names></name><name><surname>Bierne</surname><given-names>N</given-names></name><name><surname>Boughman</surname><given-names>J</given-names></name><name><surname>Brelsford</surname><given-names>A</given-names></name><name><surname>Buerkle</surname><given-names>CA</given-names></name><name><surname>Buggs</surname><given-names>R</given-names></name><etal/></person-group><article-title>Hybridization and speciation</article-title><source>J Evol Biol</source><year>2013</year><volume>26</volume><issue>2</issue><fpage>229</fpage><lpage>246</lpage><pub-id pub-id-type="doi">10.1111/j.1420-9101.2012.02599.x</pub-id><pub-id pub-id-type="pmid">23323997</pub-id></element-citation></ref><ref id="CR2"><mixed-citation publication-type="other">Atkins R, McDiarmid C (2015) Extremal distances for subtree transfer operations in binary trees. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1509.00669">arXiv:1509.00669</ext-link></mixed-citation></ref><ref id="CR3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bordewich</surname><given-names>M</given-names></name><name><surname>Semple</surname><given-names>C</given-names></name></person-group><article-title>On the computational complexity of the rooted subtree prune and regraft distance</article-title><source>Ann Comb</source><year>2005</year><volume>8</volume><issue>4</issue><fpage>409</fpage><lpage>423</lpage><pub-id pub-id-type="doi">10.1007/s00026-004-0229-z</pub-id></element-citation></ref><ref id="CR4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bordewich</surname><given-names>M</given-names></name><name><surname>Linz</surname><given-names>S</given-names></name><name><surname>Semple</surname><given-names>C</given-names></name></person-group><article-title>Lost in space? Generalising subtree prune and regraft to spaces of phylogenetic networks</article-title><source>J Theor Biol</source><year>2017</year><volume>423</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2017.03.032</pub-id><pub-id pub-id-type="pmid">28414085</pub-id></element-citation></ref><ref id="CR5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bordewich</surname><given-names>M</given-names></name><name><surname>Scornavacca</surname><given-names>C</given-names></name><name><surname>Tokac</surname><given-names>N</given-names></name><name><surname>Weller</surname><given-names>M</given-names></name></person-group><article-title>On the fixed parameter tractability of agreement-based phylogenetic distances</article-title><source>J Math Biol</source><year>2017</year><volume>74</volume><issue>1&#x02013;2</issue><fpage>239</fpage><lpage>257</lpage><pub-id pub-id-type="doi">10.1007/s00285-016-1023-3</pub-id><pub-id pub-id-type="pmid">27221239</pub-id></element-citation></ref><ref id="CR6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>Y</given-names></name><name><surname>Gr&#x000fc;newald</surname><given-names>S</given-names></name><name><surname>Humphries</surname><given-names>PJ</given-names></name></person-group><article-title>On agreement forests</article-title><source>J Comb Theory Ser A</source><year>2011</year><volume>118</volume><issue>7</issue><fpage>2059</fpage><lpage>2065</lpage><pub-id pub-id-type="doi">10.1016/j.jcta.2011.04.013</pub-id></element-citation></ref><ref id="CR7"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><source>Inferring phylogenies</source><year>2004</year><publisher-loc>Sunderland</publisher-loc><publisher-name>Sinauer Associates</publisher-name></element-citation></ref><ref id="CR8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Francis</surname><given-names>A</given-names></name><name><surname>Huber</surname><given-names>KT</given-names></name><name><surname>Moulton</surname><given-names>V</given-names></name><name><surname>Wu</surname><given-names>T</given-names></name></person-group><article-title>Bounds for phylogenetic network space metrics</article-title><source>J Math Biol</source><year>2017</year><volume>76</volume><fpage>1229</fpage><lpage>1248</lpage><pub-id pub-id-type="doi">10.1007/s00285-017-1171-0</pub-id><pub-id pub-id-type="pmid">28836230</pub-id></element-citation></ref><ref id="CR9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gambette</surname><given-names>P</given-names></name><name><surname>van Iersel</surname><given-names>L</given-names></name><name><surname>Jones</surname><given-names>M</given-names></name><name><surname>Lafond</surname><given-names>M</given-names></name><name><surname>Pardi</surname><given-names>F</given-names></name><name><surname>Scornavacca</surname><given-names>C</given-names></name></person-group><article-title>Rearrangement moves on rooted phylogenetic networks</article-title><source>PLoS Comput Biol</source><year>2017</year><volume>13</volume><issue>8</issue><fpage>e1005611</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005611</pub-id><pub-id pub-id-type="pmid">28763439</pub-id></element-citation></ref><ref id="CR10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huber</surname><given-names>KT</given-names></name><name><surname>Moulton</surname><given-names>V</given-names></name><name><surname>Wu</surname><given-names>T</given-names></name></person-group><article-title>Transforming phylogenetic networks: moving beyond tree space</article-title><source>J Theor Biol</source><year>2016</year><volume>404</volume><fpage>30</fpage><lpage>39</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2016.05.030</pub-id><pub-id pub-id-type="pmid">27224010</pub-id></element-citation></ref><ref id="CR11"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Huson</surname><given-names>DH</given-names></name><name><surname>Rupp</surname><given-names>R</given-names></name><name><surname>Scornavacca</surname><given-names>C</given-names></name></person-group><source>Phylogenetic networks: concepts, algorithms and applications</source><year>2010</year><publisher-loc>Cambridge</publisher-loc><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="CR12"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lempel</surname><given-names>A</given-names></name><name><surname>Even</surname><given-names>S</given-names></name><name><surname>Cederbaum</surname><given-names>I</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Rosenstiehl</surname><given-names>P</given-names></name></person-group><article-title>An algorithm for planarity testing of graphs</article-title><source>Theory of graphs: international symposium</source><year>1967</year><publisher-loc>New York</publisher-loc><publisher-name>Gordon and Breach</publisher-name><fpage>215</fpage><lpage>232</lpage></element-citation></ref><ref id="CR13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Tromp</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name></person-group><article-title>On the nearest neighbour interchange distance between evolutionary trees</article-title><source>J Theor Biol</source><year>1996</year><volume>182</volume><issue>4</issue><fpage>463</fpage><lpage>467</lpage><pub-id pub-id-type="doi">10.1006/jtbi.1996.0188</pub-id><pub-id pub-id-type="pmid">8944893</pub-id></element-citation></ref><ref id="CR14"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Morrison</surname><given-names>D</given-names></name></person-group><source>Introduction to phylogenetic networks</source><year>2011</year><publisher-loc>Uppsala</publisher-loc><publisher-name>RJR Productions</publisher-name></element-citation></ref><ref id="CR15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Than</surname><given-names>C</given-names></name><name><surname>Ruths</surname><given-names>D</given-names></name><name><surname>Nakhleh</surname><given-names>L</given-names></name></person-group><article-title>Phylonet: a software package for analyzing and reconstructing reticulate evolutionary relationships</article-title><source>BMC Bioinform</source><year>2008</year><volume>9</volume><issue>1</issue><fpage>322</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-9-322</pub-id></element-citation></ref><ref id="CR16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vuilleumier</surname><given-names>S</given-names></name><name><surname>Bonhoeffer</surname><given-names>S</given-names></name></person-group><article-title>Contribution of recombination to the evolutionary history of HIV</article-title><source>Curr Opin HIV AIDS</source><year>2015</year><volume>10</volume><issue>2</issue><fpage>84</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1097/COH.0000000000000137</pub-id><pub-id pub-id-type="pmid">25565174</pub-id></element-citation></ref><ref id="CR17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>Y</given-names></name><name><surname>Dong</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>KJ</given-names></name><name><surname>Nakhleh</surname><given-names>L</given-names></name></person-group><article-title>Maximum likelihood inference of reticulate evolutionary histories</article-title><source>Proc Natl Acad Sci</source><year>2014</year><volume>111</volume><issue>46</issue><fpage>16448</fpage><lpage>16453</lpage><pub-id pub-id-type="doi">10.1073/pnas.1407950111</pub-id><pub-id pub-id-type="pmid">25368173</pub-id></element-citation></ref><ref id="CR18"><mixed-citation publication-type="other">Zhang C, Ogilvie HA, Drummond AJ, Stadler T (2017) Bayesian inference of species networks from multilocus sequence data. bioRxiv preprint bioRxiv:124982</mixed-citation></ref><ref id="CR19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhaxybayeva</surname><given-names>O</given-names></name><name><surname>Doolittle</surname><given-names>WF</given-names></name></person-group><article-title>Lateral gene transfer</article-title><source>Curr Biol</source><year>2011</year><volume>21</volume><issue>7</issue><fpage>R242</fpage><lpage>R246</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2011.01.045</pub-id><pub-id pub-id-type="pmid">21481756</pub-id></element-citation></ref></ref-list></back></article>