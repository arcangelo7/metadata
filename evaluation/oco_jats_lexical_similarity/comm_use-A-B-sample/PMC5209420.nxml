<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bull Math Biol</journal-id><journal-id journal-id-type="iso-abbrev">Bull. Math. Biol</journal-id><journal-title-group><journal-title>Bulletin of Mathematical Biology</journal-title></journal-title-group><issn pub-type="ppub">0092-8240</issn><issn pub-type="epub">1522-9602</issn><publisher><publisher-name>Springer US</publisher-name><publisher-loc>New York</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">27826879</article-id><article-id pub-id-type="pmc">5209420</article-id><article-id pub-id-type="publisher-id">225</article-id><article-id pub-id-type="doi">10.1007/s11538-016-0225-6</article-id><article-categories><subj-group subj-group-type="heading"><subject>Perspectives Article</subject></subj-group></article-categories><title-group><article-title>Optimization and Control of Agent-Based Models in Biology: A Perspective</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>An</surname><given-names>G.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8067-3210</contrib-id><name><surname>Fitzpatrick</surname><given-names>B. G.</given-names></name><address><email>bfitzpatrick@lmu.edu</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Christley</surname><given-names>S.</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Federico</surname><given-names>P.</given-names></name><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name><surname>Kanarek</surname><given-names>A.</given-names></name><xref ref-type="aff" rid="Aff5">5</xref></contrib><contrib contrib-type="author"><name><surname>Neilan</surname><given-names>R. Miller</given-names></name><xref ref-type="aff" rid="Aff6">6</xref></contrib><contrib contrib-type="author"><name><surname>Oremland</surname><given-names>M.</given-names></name><xref ref-type="aff" rid="Aff7">7</xref></contrib><contrib contrib-type="author"><name><surname>Salinas</surname><given-names>R.</given-names></name><xref ref-type="aff" rid="Aff8">8</xref></contrib><contrib contrib-type="author"><name><surname>Laubenbacher</surname><given-names>R.</given-names></name><xref ref-type="aff" rid="Aff9">9</xref></contrib><contrib contrib-type="author"><name><surname>Lenhart</surname><given-names>S.</given-names></name><xref ref-type="aff" rid="Aff10">10</xref></contrib><aff id="Aff1"><label>1</label>Department of Surgery, University of Chicago, Chicago, IL USA </aff><aff id="Aff2"><label>2</label>Department of Mathematics, Loyola Marymount University, and Tempest Technologies, Los Angeles, CA USA </aff><aff id="Aff3"><label>3</label>Department of Clinical Science, University of Texas, Southwestern Medical Center, Dallas, TX USA </aff><aff id="Aff4"><label>4</label>Department of Mathematics, Computer Science, and Physics, Capital University, Columbus, OH USA </aff><aff id="Aff5"><label>5</label>U.S. Environmental Protection Agency, Washington, DC USA </aff><aff id="Aff6"><label>6</label>Department of Mathematics and Computer Science, Duquesne University, Pittsburgh, PA USA </aff><aff id="Aff7"><label>7</label>Mathematical Biosciences Institute, Ohio State University, Columbus, OH USA </aff><aff id="Aff8"><label>8</label>Department of Mathematical Sciences, Appalachian State University, Boone, NC USA </aff><aff id="Aff9"><label>9</label>Center for Quantitative Medicine, UConn Health, and Jackson Laboratory for Genomic Medicine, Farmington, CT USA </aff><aff id="Aff10"><label>10</label>Department of Mathematics and NIMBioS, University of Tennessee, Knoxville, TN USA </aff></contrib-group><pub-date pub-type="epub"><day>8</day><month>11</month><year>2016</year></pub-date><pub-date pub-type="pmc-release"><day>8</day><month>11</month><year>2016</year></pub-date><pub-date pub-type="ppub"><year>2017</year></pub-date><volume>79</volume><issue>1</issue><fpage>63</fpage><lpage>87</lpage><history><date date-type="received"><day>26</day><month>2</month><year>2016</year></date><date date-type="accepted"><day>12</day><month>10</month><year>2016</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2016</copyright-statement><license license-type="OpenAccess"><license-p>
<bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>/), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract id="Abs1"><p>Agent-based models (ABMs) have become an increasingly important mode of inquiry for the life sciences. They are particularly valuable for systems that are not understood well enough to build an equation-based model. These advantages, however, are counterbalanced by the difficulty of analyzing and using ABMs, due to the lack of the type of mathematical tools available for more traditional models, which leaves simulation as the primary approach. As models become large, simulation becomes challenging. This paper proposes a novel approach to two mathematical aspects of ABMs, optimization and control, and it presents a few first steps outlining how one might carry out this approach. Rather than viewing the ABM as a model, it is to be viewed as a surrogate for the actual system. For a given optimization or control problem (which may change over time), the surrogate system is modeled instead, using data from the ABM and a modeling framework for which ready-made mathematical tools exist, such as differential equations, or for which control strategies can explored more easily. Once the optimization problem is solved for the model of the surrogate, it is then lifted to the surrogate and tested. The final step is to lift the optimization solution from the surrogate system to the actual system. This program is illustrated with published work, using two relatively simple ABMs as a demonstration, Sugarscape and a consumer-resource ABM. Specific techniques discussed include dimension reduction and approximation of an ABM by difference equations as well systems of PDEs, related to certain specific control objectives. This demonstration illustrates the very challenging mathematical problems that need to be solved before this approach can be realistically applied to complex and large ABMs, current and future. The paper outlines a research program to address them.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Agent-based modeling</kwd><kwd>Systems theory</kwd><kwd>Optimization</kwd><kwd>Optimal control</kwd></kwd-group><funding-group><award-group><funding-source><institution>National Science Foundation (US)</institution></funding-source><award-id>EF-0832858NSF</award-id></award-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000181</institution-id><institution>Air Force Office of Scientific Research</institution></institution-wrap></funding-source><award-id>FA9550-09-1-0524</award-id><award-id>FA9550-10-1-0499</award-id><principal-award-recipient><name><surname>Fitzpatrick</surname><given-names>B. G.</given-names></name></principal-award-recipient></award-group><award-group><funding-source><institution>United States Department of Defense</institution></funding-source><award-id>N911NF0910538</award-id><principal-award-recipient><name><surname>Laubenbacher</surname><given-names>R.</given-names></name></principal-award-recipient></award-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>dms-1062878</award-id><award-id>DMS-0931642</award-id><principal-award-recipient><name><surname>Oremland</surname><given-names>M.</given-names></name><name><surname>Laubenbacher</surname><given-names>R.</given-names></name></principal-award-recipient></award-group><award-group><funding-source><institution>National Institues of Health</institution></funding-source><award-id>R01-GM-115839</award-id><principal-award-recipient><name><surname>An</surname><given-names>G.</given-names></name></principal-award-recipient></award-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>P30-DK-42086</award-id><principal-award-recipient><name><surname>An</surname><given-names>G.</given-names></name></principal-award-recipient></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; Society for Mathematical Biology 2017</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p>Technological advances in data generation and in computer hardware and software have transformed the life sciences from being data-poor to being data-rich. Computation is now an essential component of much research in biology, and it is also becoming ubiquitous across biomedicine and healthcare. As in engineering and science generally, a great deal of recent progress in the life sciences now relies on computation, which has come to be recognized as a &#x0201c;third pillar of science,&#x0201d; together with theory and experimentation (Smarr <xref ref-type="bibr" rid="CR33">1992</xref>; President&#x02019;s Information Technology Advisory Committee <xref ref-type="bibr" rid="CR28">2005</xref>). At a fundamental level, such computational models are constructed for two distinct but often entangled purposes: (1) models to increase understanding of the system being modeled, and (2) models to inform decisions to be made about the system being modeled. While clearly these goals overlap and can be thought of as generally existing on a continuum from understanding to decision support, and there are varying and domain-specific criteria for the trustworthiness of that transition, in applied sciences, such as biomedicine, there is a desire to develop investigatory pathways to move toward using modeling and simulation as a means of engineering control strategies. This process involves the translation of methods and concepts that have been demonstrated to be useful in other domains. For instance, many problems in the life sciences can be viewed from the point of view of optimal control and optimization, an area to which the mathematical sciences have made substantial contributions through mathematical modeling and algorithms. Yet, mathematical approaches to analysis have not been directly applicable to a type of model that has gained in popularity across the life sciences in recent years: agent-based models (ABMs). ABMs are characterized by their ease of construction by domain experts, ability to capture spatial heterogeneity, and faithful representation of local characteristics that generate global dynamics. The principal method of analysis for ABMs remains extensive simulation. As these models grow larger and more complex, even simulation quickly reaches computational limits. The purpose of this article is to discuss how mathematical approximations of ABMs could be developed, in particular for optimization and control purposes, in order to overcome these limitations. We offer the following rationale for our approach:<list list-type="order"><list-item><p>We consider ABMs &#x0201c;middle-ware&#x0201d; investigatory objects: selectively abstracted representations of the real-world system that are yet too complex for traditional formal mathematical analysis. To a great degree this complexity arises out of system properties that resist traditional modeling methods, such as variable component-component interactions, spatial heterogeneity and insufficiency of mean-field approximations, and this makes ABMs &#x0201c;sufficiently complex&#x0201d; proxies for the real-world system.</p></list-item><list-item><p>The fact that ABMs are computational constructs vastly increases the range of &#x0201c;experimental&#x0201d; conditions able to be applied versus their real-world referent (or real-world physical proxy models); this includes testing putative control strategies.</p></list-item><list-item><p>However, comprehensive search of model-response space using brute force embarrassingly parallel simulation is computationally expensive, and may not be necessary. Therefore, identifying methodological bridges between ABMs and more formally tractable SLMs would be beneficial and serve two purposes:<list list-type="alpha-lower"><list-item><p>To reduce the search space for putative controls, which can then be tested via more tractable embarrassingly parallel simulation experiments; and</p></list-item><list-item><p>To facilitate iterative refinement/expansion/reduction of an existing ABM in reference to its intended use with respect to its referent (in this case, the search for practically implementable control strategies).</p></list-item></list>
</p></list-item><list-item><p>By virtue of being &#x0201c;sufficiently complex&#x0201d; proxy systems, information and knowledge obtained by examining ABMs subject to control <italic>may</italic> provide insight into how to effectively control the real-world referent. At the very least, this process can provide a first approximation of the set of putative controls.</p></list-item></list>This rationale leads us to the following:</p><p>
<bold>Main hypothesis </bold>If an ABM is treated not as a model of a system of interest but as the system itself, then simpler mathematical models can be derived that capture key features of the ABM for a particular control or optimization objective and, by extension, the biological system of interest.</p><p>One might argue that if there is an equation-based model that can be used to solve optimization problems related to the biological system, then one should have constructed such a model in the first place, rather than build an ABM as an intermediary step. This might well be the right approach, if feasible, but there are several reasons why one might nevertheless want to build an ABM first. Firstly, of all model types, an ABM requires arguably the fewest simplifying assumptions to be made, and it can be validated in the most direct way, through, e.g., observation of characteristic patterns rather than surrogate summary statistics. If the biological system is not very well understood, this can be an important reason for an ABM as a first modeling step. Once an ABM is built and validated, it can be used to understand the system better, e.g., the importance of different variables or spatial features. Once a control objective is specified, this understanding can then lead to a possibly much simpler equation-based model that is faithful for the specific control objective, but possibly few or none of the other features. Secondly, the need for optimization and control might be an ongoing process, e.g., for models that are used for policy decisions, and the control and optimization objectives might change over time. In this case, the model is likely intended to capture all possible information about the system and incorporate new information as it becomes available. It is not efficient in this case to build a series of one-off <italic>de novo</italic> models for each. Thirdly, the model might be built by domain experts with little expertise in mathematical modeling, who can build an ABM with much greater ease than they can an equation-based model. Thus, the proposed indirect approach to optimization and control of systems is not intended to replace a direct modeling approach in all cases, but is intended to be used in cases where a direct approach is either not feasible or not desirable.</p></sec><sec id="Sec2"><title>Agent-Based Models</title><p>The life sciences frequently examine systems with interacting components at multiple levels of hierarchy and structure, from cells to connections between cells that lead to tissue-level properties, to the whole-organism level, and on to individuals in ecosystems. The reduction of biological systems to physical or chemical phenomena has yielded interesting insights at a fundamental level, but these approaches, to a great degree, fail to sufficiently represent the range and complexity of biological behavior that is often of interest at a level relevant for optimization and control approaches. Biological systems are distinguished by an organizational structure that generates multi-scale phenomena arising from the complex interactions between their physical components. They support adaptive behavior of individuals and exhibit great individual variability, whether at the scale of molecules or humans. The non-linearities associated with the functional transitions between organizational scales challenge the application of many traditional mathematical methods, particularly those oriented toward engineering means of controlling those systems. However, ABMs, which typically simulate interactions between individual components operating in heterogeneous spatial environments to generate population-level behaviors, often span two or even more organizational scales (e.g., molecular rules <inline-formula id="IEq2"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&#x0003c;=&#x0003e;$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:mo>=</mml:mo><mml:mo>&#x0003e;</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq2.gif"/></alternatives></inline-formula> individual cell behavior <inline-formula id="IEq3"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&#x0003c;=&#x0003e;$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:mo>=</mml:mo><mml:mo>&#x0003e;</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq3.gif"/></alternatives></inline-formula> cell population/tissue behavior <inline-formula id="IEq4"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&#x0003c;=&#x0003e;$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:mo>=</mml:mo><mml:mo>&#x0003e;</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq4.gif"/></alternatives></inline-formula> multi-tissue/organism <inline-formula id="IEq5"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&#x0003c;=&#x0003e;$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:mo>=</mml:mo><mml:mo>&#x0003e;</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq5.gif"/></alternatives></inline-formula> multi-organism/population). They have become an important technology for the life sciences because of their capacity to account for heterogeneity among components. Additionally, they are able to readily integrate knowledge with data because, in many cases, reductionist experimental data offer better observability of individuals than aggregates. Often, scientists find ABMs simpler to explain to stakeholders such as policy makers, in terms of components for which they have some intuition. It has now become relatively easy for a domain expert to construct an ABM, thanks to easy-to-use software interfaces for model construction, simulation, and visualization. For these and other reasons, ABMs have been increasingly adopted in the evolving area of computational simulation science. The notion that computation has come to complement experiment and theory as a third pillar of science arises from the use of complex computational simulations not only as a means of integrating and comparing theory and experiment but, more importantly, as tools to aid in theory construction, to illuminate crucial components and uncertainties, to generate and examine new hypotheses, to suggest new experiments and data collection efforts, and to strengthen policy development and decision-making.</p><p>The basic structure of an ABM consists of individuals/agents with attributes and rules of behavior, rules that govern agent actions and interactions with other agents, as well as the interaction of agents with a potentially complex heterogeneous environment. ABMs often allow for individual variation among agents, challenging the compartmentalization typically used in dynamical systems models. Moreover, agents may have adaptive behavioral rules that lead to unforeseeable interactions and emergence. The time scales of different behavioral rules and environmental pressures can also be quite variable. These features make ABMs difficult to encode in terms of traditional difference or differential equations models. The behaviors and rules of ABMs are typically encoded in software as simple logical rules, coupled with random number generation to model uncertain events and outcomes. As such, ABM construction is more accessible than mathematically involved approaches such as, e.g., systems of differential equations. This simplicity of implementation allows researchers to translate hypotheses into a computational form, so that the ABM plays the role of a digital &#x0201c;sand box,&#x0201d; aiding in the investigation and visualization, advancing theory through conceptual model falsification.</p><p>An important and primary feature of ABMs is the population-level aggregated behavior that emerges from the rule-based individual interactions, such as the patterns of segregation in the model of (Schelling <xref ref-type="bibr" rid="CR32">1971</xref>) or synchronization of breeding in birds (Railsback and Grimm <xref ref-type="bibr" rid="CR29">2012</xref>). While differential equations models like the Belousov-Zhabotinsky reaction model (see, e.g., Murray <xref ref-type="bibr" rid="CR23">2011</xref>) can exhibit similar complex pattern evolution, the diversity of pattern and structure formation in ABMs is remarkable (Epstein and Axtell <xref ref-type="bibr" rid="CR3">1996</xref>; Gilbert <xref ref-type="bibr" rid="CR10">2008</xref>; Railsback and Grimm <xref ref-type="bibr" rid="CR29">2012</xref>).</p><p>Scientific inquiry into the control points of a system and the key drivers of system behaviors, however, can be difficult with ABMs. For this purpose, computational objects such as cellular automata or modeling methods such as discrete event simulation can be thought of as special cases of ABMs, but to date, there is not currently a rigorous formal description of what constitutes an ABM. A major benefit of using ABMs is their ability to generate, through simulation, non-linear transitions between multiple scales of organization. However, determining parameter settings that lead to different patterns can be extremely difficult. In contrast, this is relatively straightforward for systems of differential equations, for example. Exhaustive simulation to investigate bifurcations and stability, though cheaper and faster than real-world experimentation, can be prohibitively expensive in terms of compute cycles and the resources needed to execute them. Very complex differential equations models may be similarly expensive to evaluate computationally, but the formal mathematical structure of systems of differential equation often permits analyses in a way that the interaction-based structure of an ABM does not. This difference accounts for the significant appeal of more traditional mathematical models. Reducing the complexity of a differential equations model for design and optimization studies can be challenging, but generally the route is clearer than it is with ABMs, features of which may frustrate attempts at reduction by formal inspection and model reduction methods.</p><p>A problem of practical interest is that of policy guidance. In distinction with basic scientific inquiry, ecological management, public health, and medical domains need tools for rational, evidence-based decision-making in treatments, interventions, and resource management problems. Models have been used successfully to support such efforts. Social and ecological applications often involve problems for which direct experimentation is, at best, difficult. For example, controlling non-native species such as the wild hog <italic>Sus Scrofa</italic> in the Great Smoky Mountains National Park (Peine and Farmer <xref ref-type="bibr" rid="CR27">1990</xref>) has created a number of political difficulties, and mathematical models are beginning to suggest management strategies (Salinas et&#x000a0;al. <xref ref-type="bibr" rid="CR31">2015</xref>; Levy et&#x000a0;al. <xref ref-type="bibr" rid="CR20">2016</xref>). As another example, college drinking is a major public health problem. Calls for a reduction in the minimum legal drinking age suggest the undertaking of a complex, large scale social and political experiment with potentially major consequences. Computational decision aids can support policy investigation when experimentation and testing must necessarily be limited (McCardell <xref ref-type="bibr" rid="CR21">2008</xref>; Fitzpatrick et&#x000a0;al. <xref ref-type="bibr" rid="CR7">2012</xref>, <xref ref-type="bibr" rid="CR8">2016a</xref>). Again, exhaustive simulation of control strategies may not be a desirable or even viable option, and developing mathematically tractable tools for winnowing the vast array of control strategies or policies into a manageable set for simulation can enhance this type of model tremendously.</p><p>To illustrate just how widely applicable ABMs are, we point to several additional representative examples. At the population level, EpiSims (Eubank <xref ref-type="bibr" rid="CR4">2005</xref>; Stroud et&#x000a0;al. <xref ref-type="bibr" rid="CR34">2007</xref>) is a very large population-level ABM that explicitly represents millions of individuals and their daily movements in a faithfully represented urban environment. This movement model is then overlaid with an epidemiological model that can be used to simulate the spread of a pathogen through the population. EpiSims has been used as a policy decision-making tool in several contexts. In Wang et&#x000a0;al. (<xref ref-type="bibr" rid="CR37">2014</xref>), an ABM is used to study the impact of social norms on obesity and eating behaviors among US school children. At the tissue scale in the human body, a wide variety of problems have been approached through ABMs. In Ziraldo and Solovyev (<xref ref-type="bibr" rid="CR41">2015</xref>), an ABM is used for a computational study of treatment options for pressure ulcers in patients with spinal cord injuries. In Gong et&#x000a0;al. (<xref ref-type="bibr" rid="CR11">2015</xref>), an ABM of granuloma formation in tuberculosis is used as a platform for the <italic>in silico</italic> design of combination therapies with different antibiotics. The ABM is combined with a PDE model to accurately represent diffusion of different molecules through tissue. Many other examples can be found in the literature.</p></sec><sec id="Sec3"><title>Toward a Mathematical Approach to ABMs</title><p>There is a nearly irresistible pull, when developing an ABM, toward increasing levels of detail and complexity. The enormous flexibility of ABMs allows a modeler to create agents with many attributes operating in an environment that is heterogeneous in multiple dimensions and to build interaction rules that account for rich, complex behaviors and relationships. As the complexity grows, the dimensionality of the parameter space does as well, and the ability to conduct systematic inquiry becomes more challenging. The ABM structure that invites researchers with its developmental simplicity becomes a significant drawback: as noted above, the computational simulation based on logical rules and individual attributes can be quite resistant to formal mathematical analysis or even to experimental insights, if the model rules are too complex. One strategy for approaching these trade-offs is &#x0201c;pattern-oriented modeling (Grimm and Railsback <xref ref-type="bibr" rid="CR12">2005</xref>; Grimm et&#x000a0;al. <xref ref-type="bibr" rid="CR13">2005</xref>), in which one balances model complexity against the ability of the model&#x02019;s output patterns to match those observed in the real world (see also Thorngate and Edmonds <xref ref-type="bibr" rid="CR35">2013</xref>, for pattern analysis in ABMs). We suggest that analysis at a system level can benefit greatly from transformation of the ABM into mathematical formalisms that are more accessible to system-level analysis.</p><p>
<italic>As stated in our main hypothesis, we assert that ABMs can be used as proxy systems, rather than as the model to be analyzed directly, in an investigatory pathway that can lead to the development of control strategies for highly complex real-world systems.</italic> The complexity of aggregate behaviors observed in ABMs, which is seen by many ABM modelers as unapproachable with system-level compartmental or aggregated models, offers new and exciting challenges to the systems theory community, calling for the creation of new approaches.</p><p>There are several examples in the literature that can be seen as first steps toward a research program of the kind we are advocating. In Roeder et&#x000a0;al. (<xref ref-type="bibr" rid="CR30">2006</xref>), an ABM is used to study the effects of treating chronic myeloid leukemia with the drug imatinib, known as Gleevec, a tyrosine kinase inhibitor that interrupts key signaling pathways in cancer cells, thereby inhibiting cell proliferation. While being very successful in achieving a substantial reduction in the number of malignant cells, this treatment rarely eliminates all such cells, leading to cancer recurrence. In Roeder et&#x000a0;al. (<xref ref-type="bibr" rid="CR30">2006</xref>), the model is used to provide evidence for a new hypothesis explaining lack of complete success, which implicates different effects of imatinib on malignant stem cells, leaving a residual pool that replenishes the repertoire of cancer cells after treatment ends. The model supports this hypothesis, which is also corroborated by patient data. The agents in the ABM are cells of different types. There is no explicit spatial environment; rather, cells are divided into two different environments, representing cell growth and quiescence. Cells can move between these environments, depending on different signals they receive. Imatinib treatment affects several different parameters in the model.</p><p>At each ABM time step, the model evaluates a collection of probabilistic rules that affects the state of each cell and its location in one or the other of the compartments. Due to the large number of rules to be evaluated, leading to significant computational cost, it is only possible to use a small fraction of the actual number of cells involved. Still, one simulation run of this large stochastic model requires on the order of 6&#x000a0;h, with hundreds of thousands of rules to be evaluated at each time step. In Kim et&#x000a0;al. (<xref ref-type="bibr" rid="CR16">2008</xref>), the authors developed a deterministic difference equations model, consisting of approximately 6000 equations, that faithfully reproduces the behavior of this ABM and can be simulated in a matter of seconds. Cells are clustered depending on their state, and there is no limit on the size of the clusters, so that the model can represent any number of cells. This clustering approach also allows the model to be deterministic rather than stochastic. Then, in Kim et&#x000a0;al. (<xref ref-type="bibr" rid="CR17">2008</xref>), a (deterministic) PDE model was presented that accomplished the same task, agreeing with both the ABM and the difference equations model in almost all aspects. The main difference is that continuous time causes some aspects of the model to behave differently from either of the discrete time models. We view this progression of models as a case study of how one can move from a complex and hard to execute ABM to a more easily manageable equation-based mathematical model that allows analysis.</p></sec><sec id="Sec4"><title>Optimization and Control</title><p>A well-known family of ABMs known as Sugarscape (Wilensky <xref ref-type="bibr" rid="CR39">2009</xref>; Epstein and Axtell <xref ref-type="bibr" rid="CR3">1996</xref>) has been used for the study of a variety of control processes in the life sciences, social science, and economics. The stochastic Sugarscape ABMs include agent heterogeneity, environmental heterogeneity, and accumulation of agent resources (i.e., sugar) over time, thus incorporating the main complexities frequently found in ABMs. Agents negotiate a spatial environment in search of a resource called sugar, with higher sugar concentrations represented as elevations in the landscape. Different agents have differing abilities to perceive sugar gradients, leading to different levels of agent fitness. Complete lack of sugar leads to agent death. Control is included as taxation of agents&#x02019; sugar resources, with the goal of maximizing a weighted combination of total taxes less a measure of the impact of taxation on the population. Recently, Christley et&#x000a0;al. (<xref ref-type="bibr" rid="CR2">2015</xref>) approximated a Sugarscape model using a system of parabolic PDEs. The goal was to explore optimal control scenarios for Sugarscape, applying mathematical optimization approaches to the PDE model. This approach performed well in scenarios in which the control was assumed to be constant. Optimal controls generated by applying optimal control theory to the PDE system provided time-varying tax rates specific to an agent&#x02019;s location and current wealth. When implemented in the ABM, the optimal controls performed reasonably well even though some error was introduced between the PDE and ABM systems.</p><p>Several different approaches to Sugarscape control are described in Oremland and Laubenbacher (<xref ref-type="bibr" rid="CR24">2014a</xref>, <xref ref-type="bibr" rid="CR25">b</xref>), approaches which illustrate the philosophy advocated herein. One approach focuses on dimension reduction of the ABM (by reducing the number of spatial locations, agents, and other aspects), while preserving those model features relevant for a given control objective. This is done by applying a randomly chosen collection of controls to both the original and the reduced ABM and computing the similarity of the relative rankings of the controls for the two models. The user can then choose a level of similarity that is acceptable for a particular control objective, thereby deciding how closely the reduced model needs to fit the original one for the control purpose. Controls are then computed for the reduced model and lifted to the original one. Note that the reduced model might be dramatically different from the original one in other aspects. The advantage of the reduced model might be ease of computation, although care must be taken that this is indeed the case. The optimization method chosen is Pareto optimization. This multiobjective optimization method has the advantage that it computes a collection of controls, each of which has the property that optimality in one objective cannot be improved without losing optimality in another. Thus, it computes optimal control inputs for various weightings of the individual objectives. The user can then decide which to choose. Another approach that can be taken using either the original model, or, possibly more easily, the reduced model, is to approximate the ABM by an equation-based model that can be used for control. Again, the equation model might be adequate for a control objective without preserving many other important features of the ABM, e.g., spatial heterogeneity. In Oremland and Laubenbacher (<xref ref-type="bibr" rid="CR25">2014b</xref>), for instance, the rabbits-and-grass model is approximated almost perfectly, for the purpose of rabbit control, by a pair of fairly simple difference equations. But these have phenomenological parameters and contain no information about the spatial aspects of the model. This is also illustrated with a Sugarscape example.</p><p>Another approach to approximation of ABMs and corresponding optimal control has been developed by Lenhart et&#x000a0;al. (<xref ref-type="bibr" rid="CR18">2015</xref>, <xref ref-type="bibr" rid="CR19">2016</xref>), using a system of stochastic partial differential equations with non-local terms as an approximation, with corresponding novel optimal control results. The control of this system is motivated by a model for optimal harvesting of a population on a spatial grassland habitat, which is described below.</p><p>
<italic>We interpret these examples as evidence that it is possible to approximate large, complex, stochastic ABMs with mathematical models that are easier to execute and can be analyzed with mathematical methods. </italic>We will elaborate on this approach below, using a much simpler ABM as an illustrative proof of concept and further validation of our main hypothesis.</p></sec><sec id="Sec5"><title>A Case Study: Ecological Pest Control</title><p>To focus the discussion on mathematical issues, we consider a comparatively simple application problem in which an ABM is a natural and easily implemented model, and for which control policies are of interest. We consider a two-species consumer-resource structure in a two-dimensional spatial domain. The spatial domain is divided into discrete patches, and time progresses in discrete steps. The resource, which we call grass, is produced with a commercial goal in mind. The species, called rabbits, consumes the grass and hence degrades the commercial viability of the grass crop. The simple model we examine involves rabbits and grass distributed across a rectangular domain. This model is implemented in the NetLogo framework (Wilensky <xref ref-type="bibr" rid="CR40">1999</xref>, <xref ref-type="bibr" rid="CR38">2001</xref>) as &#x0201c;Rabbits&#x02013;Grass&#x02013;Weeds.&#x0201d; In this simple example, each rabbit&#x02019;s state is characterized by four quantities: its lat-long position in space, the angle it faces, and its energy content. Energy content is measured by the amount of grass the rabbit consumes, and when the rabbit crosses an energy threshold, it produces one rabbit as offspring. Movement is governed by an angular random walk: the rabbit chooses two uniformly distributed angles (left, right), differences them, adds that to its current facing angle, and moves one unit in that direction. The grass state in each position patch is 0 or 1, denoting presence or absence. Grass grows from 0 to 1 at a random rate. Energy content of a rabbit corresponds to the number of grass patches consumed. If a rabbit&#x02019;s energy level falls below a al threshold, the rabbit dies. There are a small number of parameters in the model: the grass growth probability, the rabbit&#x02019;s angular field of vision (affecting its movement), as well as birth and death thresholds.</p><p>While we focus on this simple version of the model in this paper, the problem is easily made more complex in the presence of a few natural generalizations. First, the grass growth probability may be spatially heterogeneous, dependent on local soil and water conditions. Second, rabbits may be drawn to areas within the region of interest with the highest grass content, bringing about a directed random walk that is chemotactic in nature. Third, the birth and death probabilities of the rabbits may not be identical, potentially leading to &#x0201c;winners&#x0201d; and &#x0201c;losers&#x0201d; within the rabbit community. Even with these potential complexifiers, this model does lack some interesting and important properties that make ABM behavior so rich, such as agent adaptability. Nonetheless, this model does include stochastic variation among agents and modeling features (e.g., the nature of the agent movement and of the conversion of grass to rabbits) that are not easily treated by traditional SLM approaches. Furthermore, because the current goal of this paper is to demonstrate the mapping between ABMs and equation-based system-level models in order to apply optimal control methods, we have chosen the simplified version of the rabbit&#x02013;grass ABM as the initial starting point for the investigation of creating the cross-platform mapping process. By using simplified models, we emphasize the mapping and connection between two different perspectives of representing knowledge about the system, i.e. individual-based knowledge versus aggregated system-level knowledge. Our stepwise approach will then attempt to perform this mapping with increasingly sophisticated ABMs and target system-level modeling methods (see below).</p><p>The available control is that of harvesting, implemented as a probability of being harvested. In each patch and at each time step, the harvesting probability is specified. A random number is generated, and, if that number is less than the harvest rate, any rabbits in the patch are harvested. In its simplest instantiation, this probability may be uniform across the region of interest, but one may also implement harvesting with greater effort in some areas than in others.</p><p>It is at this point that we see some difficulty in the agent-based formulation. One may attempt to &#x0201c;wrap an optimization loop around&#x0201d; the ABM in order to devise an optimal harvesting plan. However, the stochastic nature of many ABMs requires careful consideration of optimization algorithms: even with many simulation runs, some variability in output limits the effectiveness of gradient-based search methods. Stochastic approximation techniques may help, and more heuristic global optimization schemes offer potential as well. The issues of obtaining reliable data from repeated simulation and the effect of spatial scale on resulting dynamics were investigated in Oremland and Laubenbacher (<xref ref-type="bibr" rid="CR24">2014a</xref>). While that paper presents several techniques for control of ABMs directly via simulation, it would seem more appealing in general to apply the well-developed systems-theoretic tools of optimal control.</p></sec><sec id="Sec6"><title>Control Techniques</title><p>The systems-theoretic view is often characterized by input&#x02013;output relationships, as illustrated in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Basic block diagram of a system</p></caption><graphic xlink:href="11538_2016_225_Fig1_HTML" id="MO1"/></fig>
</p><p>The system may constitute a medical patient receiving treatment, with outputs being physiological measures of health. Another example is a spatially distributed ecosystem of pest predators and their prey, with inputs being trapping strategies implemented over time and distributed spatially, and outputs being observations of total pest population. The system may be a society of agents with different incomes and wealth levels, with a control being taxation, as in Sugarscape.</p><p>The inputs can be static, like parameters, or dynamic. Dynamic inputs can include control signals designed to influence the system and disturbances, stochastic or deterministic. The observed output signal represents those things we can measure.</p><p>A functional relationship between an input control signal <italic>u</italic> and an observed output signal <italic>y</italic> is often referred to as a transfer function:<disp-formula id="Equ13"><graphic xlink:href="11538_2016_225_Equ13_HTML.gif" position="anchor"/></disp-formula>Here, the transfer function <italic>G</italic> is assumed at a minimum to be causal, meaning that the output at any time instant can only depend on the control signal at times up to and including the current time. Other modeling assumptions may include linearity or time invariance.</p><p>In many control applications, one builds a model of the system in order to design control signals that will lead to desirable outputs. The model involves two closely related but distinct ingredients: a model that approximates the system&#x02019;s input/output behavior, and a control algorithm that uses model information to determine appropriate control inputs. Such a circumstance is illustrated in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>, as we augment the real system of interest with the model and controller:<fig id="Fig2"><label>Fig. 2</label><caption><p>Model-based control block diagram</p></caption><graphic xlink:href="11538_2016_225_Fig2_HTML" id="MO3"/></fig>
</p><p>The possible objectives of control are either to keep a system&#x02019;s output within some desired operating range of interest, or to move a system from its current state to a more desirable one. Designing controls to meet these objectives is generally approached by choosing an optimization criterion or objective functional to be maximized or minimized.</p><p>Often the system is characterized by a dynamic state variable whose value represents the complete state of the system at any given time. To fix ideas, we focus on an optimal control approach, in which we consider the following mathematical formulation:<disp-formula id="Equ1"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\dot{x}}(t)= &#x00026; {} f(t, x(t), u(t), \theta )\\ y(t)= &#x00026; {} h(t, x(t), u(t), \theta )\\ J(u)= &#x00026; {} {\mathop {\int }\limits _{t_{0}}^{t_{f}}} L(t, x(t), u(t)) \text {d}t + \Phi (x(t_{f})) \end{aligned}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="italic">&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="italic">&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:munderover><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">&#x003a6;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2016_225_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>in which <italic>x</italic> denotes the state of the system, <italic>u</italic> denotes an exogenous input we refer to as the control, and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta $$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="italic">&#x003b8;</mml:mi></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq6.gif"/></alternatives></inline-formula> denotes system parameters such as rate constants, susceptibilities, etc., with the state variable&#x02019;s rate of change being modeled by the function <italic>f</italic>, which we call simply the dynamics. The second augmenting equation denotes the system&#x02019;s outputs, quantities we can measure, which we refer to as <italic>y</italic>, with the function <italic>h</italic> modeling the relationship between the state, control, parameter, and output. Finally, the functional<italic>J</italic>,&#x000a0; depending on the control signal <italic>u</italic>,&#x000a0; models our objective for choosing an optimal control.</p><p>Among the challenges of modeling, particularly model-based decision and control, is the identification of the state variables needed to capture the dynamics of a complex system with many scales and interacting components. The dynamical system may need to account for spatial heterogeneity (leading often to partial differential equations like diffusions). Other sorts of heterogeneity (e.g., different levels of susceptibility to disease, different levels of metabolism) also make for challenges in state variable modeling approaches. As an example, the effect of simple and straightforward changes in agent movement on the ability to formulate a system-level model (SLM) is presented in Oremland and Laubenbacher (<xref ref-type="bibr" rid="CR26">2015</xref>). To what extent aggregation can be tolerated in an SLM of a complex heterogeneous system and its associated agent-based model is an important topic, the investigation of which offers exciting mathematical research opportunities.</p></sec><sec id="Sec7"><title>Systems Analysis and Control for Agent-Based Models</title><p>System-level modeling of an ABM might reasonably be viewed as the same activity as developing a model of the real system represented by the ABM. Indeed, one fruitful view of ABMs is that of experimental surrogate. ABM development often centers very directly on translating the process details of a physical, chemical, biological, or social system into behavioral rules that can be instantiated in code. There are, however, a number of fundamental differences.</p><p>First and foremost, the ABM may involve a number of control inputs and parametric settings that are not practically realizable in experimentation. This situation is particularly relevant in biological and social systems, for which experiments may involve difficult ethical questions. Second, the ABM may allow one to monitor processes for which current measurement technologies do not exist. Additional measurements in the computational model can provide important insights into control algorithm performance and stimulate innovation in science and engineering of sensor and other measurement technologies. Third, we note that the simulation can be exercised in a wider variety of configurations and spatial and temporal sampling rates than can most physical, biological or social systems.</p><p>Inserting an ABM into the decision and control loop of real systems leads to a slight modification of the control diagram in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>. The red arrows in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> denote the fact that the real system&#x02019;s output and the ABM&#x02019;s output may be used to tune the SLM. The manner in which this is done depends on many details of the experiments and the models. Among the more interesting and challenging issues is that inputs and outputs for the real system, the ABM, and the SLM, may be very different data structures.<fig id="Fig3"><label>Fig. 3</label><caption><p>(Color Figure Online) Two levels of modeling in a decision and control loop</p></caption><graphic xlink:href="11538_2016_225_Fig3_HTML" id="MO5"/></fig>
</p><p>Consider the first example problem of ecological pest control. The traditional Lotka&#x02013;Volterra consumer-resource model (like predator-prey) is a pair of ordinary differential equations given by<disp-formula id="Equ2"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\dot{g}}(t)= &#x00026; {} \alpha g(t) - \beta g(t)r(t)\\ {\dot{r}}(t)= &#x00026; {} - \gamma r(t)+\delta g(t) r(t)-u (t)r(t) \end{aligned}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi mathvariant="italic">&#x003b1;</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="italic">&#x003b2;</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mi mathvariant="italic">&#x003b3;</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="italic">&#x003b4;</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2016_225_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>in which <italic>g</italic> and <italic>r</italic> denote the total amounts of grass and rabbits as functions of time. The parameters <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="italic">&#x003b1;</mml:mi></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq7.gif"/></alternatives></inline-formula> and <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta $$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="italic">&#x003b2;</mml:mi></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq8.gif"/></alternatives></inline-formula> denote growth rate and loss rate due to rabbit consumption of the grass, and the parameters <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="italic">&#x003b3;</mml:mi></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq9.gif"/></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta $$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="italic">&#x003b4;</mml:mi></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq10.gif"/></alternatives></inline-formula> denote the mortality rate of rabbits and conversion rate of grass energy into newborn rabbits. The function <italic>u</italic>(<italic>t</italic>) gives the harvest rate of the rabbits. While there are many choices of objective functions that will lead to pest reduction, one relatively obvious choice is<disp-formula id="Equ3"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J(u)={\mathop {\int }\limits _{0}^{T}} r(t)+ wu(t)\text {d}t \end{aligned}$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>J</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2016_225_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>which we minimize with respect to <italic>u</italic>, subject to the Lotka&#x02013;Volterra equation constraint. The number <italic>w</italic> represents a weight to balance two costs: in minimizing this functional we attempt to minimizing a combination of the total rabbit population and the harvesting expenses.</p><p>In order to project down from the ABM to this model, the total amounts of grass and rabbits can be computed from ABM output. However, the reverse direction is not well-defined: lifting up from the simple Lotka&#x02013;Volterra model to the state of the ABM is not unique. In particular, the harvesting rate must be distributed as a probability for grass growth across the spatial domain.</p><p>This issue presents an important general consideration in developing an SLM for system analysis of an ABM: mapping back and forth between the two state spaces of the models. Generally speaking, the mapping from ABM states to SLM states, which we call a projection, is straightforward. Often the SLM states can be viewed as summary statistics of the ABM, be they total abundances, means, or fractions with specific attributes or properties. Summing the number of agents with a certain property (e.g., all the rabbits or all the grass) produces the necessary projection in many situations.</p><p>The mapping from the SLM to the ABM, which we call a lifting, requires more care. ABM states tend to involve much more detail than SLM states, but the summary statistic view can help in lifting: ABM states can often be approximated as random samples from a distribution that depends on a simple parameterization that can be characterized using the SLM state. For example, with a known number of rabbits, we can randomly distribute rabbits across the spatial domain. Lifting the state variable itself is not the only consideration here: lifting the control input, which will be used to influence the ABM dynamics, is also an issue.</p><p>We have sketched a very simple approach to one relatively low-complexity example problem by proposing a well-known differential equations model as the surrogate SLM. We note here that there are many approaches to designing the SLM, including (but not limited to) time series models of transfer functions, difference equations (Oremland and Laubenbacher <xref ref-type="bibr" rid="CR25">2014b</xref>), ordinary, partial, and stochastic differential equations, polynomial dynamical systems (Hinkelmann et&#x000a0;al. <xref ref-type="bibr" rid="CR14">2011</xref>), and Markov chains. Within each of these rough categories, many approaches to developing a model exist. One may specify a simple functional form and fit parameters to output. On the other hand, one may create a more mechanistic model, for which the parameters have direct conversions to and from the ABM parameters. In either case, one must still perform a parameter estimation of some sort. With the fitted model in hand, one must then compute the optimal control. Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref> delineates potential modeling approaches, parameter estimation methods, and control design techniques.<table-wrap id="Tab1"><label>Table 1</label><caption><p>A partial break-down of modeling, estimation, and control methods</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Modeling approaches</th><th align="left">Parameter estimation methods</th><th align="left">Control design techniques</th></tr></thead><tbody><tr><td align="left">1. Discrete input&#x02013;output</td><td align="left">Output least squares 1,4,5</td><td align="left">Pontryagin&#x02019;s maximum principle 1,4,5</td></tr><tr><td align="left">2. Markov chain</td><td align="left">Equation error 4,5</td><td align="left">Dynamic programming 1&#x02013;5</td></tr><tr><td align="left">3. Polynomial dynamical systems</td><td align="left">Maximum likelihood 1&#x02013;5</td><td align="left">Large scale constrained optimization 1&#x02013;5</td></tr><tr><td align="left">4. Difference equations</td><td align="left">Maximum a posteriori 1&#x02013;5</td><td align="left"/></tr><tr><td align="left">5. Differential equations</td><td align="left"/><td align="left"/></tr></tbody></table></table-wrap>
</p><p>To illustrate some ways in which a system-level problem can be investigated using an ABM, we return to our rabbits-and-grass model described above. A relatively simple problem, the rabbits-and-grass simulation nonetheless exhibits many of the key behaviors of ABMs. We consider here three distinct routes to system-level analysis.<list list-type="order"><list-item><p>Stochastic optimization applied directly to the ABM;</p></list-item><list-item><p>Mechanistically derived SLM constructed as a surrogate for the ABM; and</p></list-item><list-item><p>Empirically fit SLM constructed as a surrogate for the ABM.</p></list-item></list>
</p><sec id="Sec8"><title>Stochastic Optimization Applied Directly to the ABM</title><p>Here we view the ABM as an input&#x02013;output system, much like an experiment with settings and measurements. We consider the homogeneous rabbits-and-grass model, and we apply a harvesting strategy defined as follows. For a full description, see Oremland and Laubenbacher (<xref ref-type="bibr" rid="CR24">2014a</xref>). At each ABM time step, harvesting may or may not be applied. The harvesting has an effectiveness parameter, modeled as a probability. The probability creates a stochastic mortality for each rabbit. The harvesting remains in effect for a second time step, but its effectiveness is reduced by half. The control is a binary time sequence of apply/do not apply, uniformly distributed across the region.</p><p>The objective in this example has two features: minimize a weighted combination of the rabbit population and the level of harvesting. We consider a Pareto approach that allows us to trade off these two objectives, implementing the optimization with a genetic algorithm. In this approach, we construct a set of &#x0201c;seed&#x0201d; controls, which, again, is a set of binary sequences representing the harvesting schedule. Each of these is evaluated in the ABM, with the number of surviving rabbits as output. We estimate the Pareto frontier by removing all controls whose objective pair (surviving rabbits, days of harvesting) is dominated by any other control. Controls that persist are paired to produce offspring by randomly choosing parent sequence components. The details of the procedure can be found in Oremland and Laubenbacher (<xref ref-type="bibr" rid="CR24">2014a</xref>).</p><p>It should be noted that generating the seed controls is a difficult problem in and of itself. Even in this approach of applying a heuristic optimization scheme, we need an approximating SLM to aid in control construction. A discrete dynamical system for the rabbits and grass is used in conjunction with the genetic algorithm to develop seed controls. The difference equation takes the form<disp-formula id="Equ4"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} r(t+1)= &#x00026; {} ar (t)+br(t)g(t)\\ g(t+1)= &#x00026; {} g(t)+\gamma (1-g(t))-{\frac{r(t)g(t)}{N}}, \end{aligned}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="italic">&#x003b3;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2016_225_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>in which the parameters <italic>a</italic>,&#x000a0;<italic>b</italic>, and <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma $$\end{document}</tex-math><mml:math id="M28"><mml:mi mathvariant="italic">&#x003b3;</mml:mi></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq11.gif"/></alternatives></inline-formula> are estimated by least squares comparison with ABM simulation output, and <italic>N</italic> denotes the number of grid cells in the ABM. In Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> we illustrate the matching of the SLM to the ABM in the case of no control applied. The resulting Pareto frontier is also shown, yielding the number of rabbits remaining at the final time as a function of the control effort, as modeled by the number of days harvesting is applied.<fig id="Fig4"><label>Fig. 4</label><caption><p>(Color Figure Online) <italic>Upper panels</italic> show the time course of the SLM and ABM, the latter with an average of 100 realizations and +/- 2 standard deviations. The <italic>top</italic> shows the system with no control applied, and the <italic>bottom</italic> illustrates a Pareto-optimal control. <italic>Third panel</italic> shows average number of rabbits versus days of harvesting. The <italic>red symbols</italic> represent Pareto points, while the <italic>black symbols</italic> show suboptimal controls</p></caption><graphic xlink:href="11538_2016_225_Fig4_HTML" id="MO9"/></fig>
</p><p>This approach provides a suite of solutions, each of which may be optimal, depending on the preferences of the modeler. Hence, the optimal solution chosen can be thought of as a &#x02018;managerial&#x02019; decision. While this approach demonstrates a means by which optimal control results can be obtained directly from ABM execution, it lacks a level of mathematical rigor that may be necessary for conclusive statements.</p></sec><sec id="Sec9"><title>Mechanistic SLM Derived for ABM Approximation</title><p>In this approach, we also view the ABM as an input&#x02013;output experimental system. We consider the basic processes captured in the ABM, with an eye toward developing a model amenable to control approaches. We construct a simple consumer-resource ODE system with control. For a full description, see Federico et&#x000a0;al. (<xref ref-type="bibr" rid="CR5">2013</xref>).</p><p>The model we use is of the form<disp-formula id="Equ5"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\dot{g}}(t)= &#x00026; {} a_{1} (a_{2}-g(t))-f (g(t)) r(t)\\ {\dot{r}}(t)= &#x00026; {} b_{1}f (g(t)) r(t)- b_{2}r(t)-u(t)r(t) \end{aligned}$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2016_225_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>in which<disp-formula id="Equ6"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f(x)={\frac{a_{1}a_{3}x}{1+a_{3}a_{4}x}}, \end{aligned}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2016_225_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>and <italic>u</italic>(<italic>t</italic>) denotes the control, which is a harvesting rate between 0 and 1, representing the fraction of rabbits harvested per unit time. Thus, the grass grows according to a logistic model in the absence of rabbits. The rabbits convert grass to rabbit offspring according to a type of Monod kinetics, and the rabbits have a simple linear mortality rate. The (time dependent) control increases that mortality rate. Of the six parameters in the model, <inline-formula id="IEq12"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{1}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{2}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq13.gif"/></alternatives></inline-formula> are directly computable from the ABM parameters, while the other four, <inline-formula id="IEq14"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{3},a_{4},b_{1}b_{2}$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq14.gif"/></alternatives></inline-formula> must be inferred from fitting the SLM to SBM output.</p><p>The control objective is specified as minimizing the functional<disp-formula id="Equ7"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J(u)={\mathop {\int }\limits _{0}^{T}} r(t)+c_{1} u(t)+c_{2} u^{2}(t) \text {d}t \end{aligned}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>J</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2016_225_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>in which the parameters <inline-formula id="IEq15"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{1}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{2}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq16.gif"/></alternatives></inline-formula> are tunable in order to achieve desirable qualitative behavior. Without <inline-formula id="IEq17"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{2}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq17.gif"/></alternatives></inline-formula>, we can view the parameter <inline-formula id="IEq18"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{1}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq18.gif"/></alternatives></inline-formula> as balancing the two objectives of the Pareto specification in the previous control methodology. The parameter <inline-formula id="IEq19"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{2}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq19.gif"/></alternatives></inline-formula> plays a somewhat technical mathematical role (as is discussed in Federico et&#x000a0;al. <xref ref-type="bibr" rid="CR5">2013</xref>) for improving the performance of the numerical solution approach.</p><p>The solution approach of Federico et&#x000a0;al. (<xref ref-type="bibr" rid="CR5">2013</xref>) is closely related to Pontryagin&#x02019;s principle: a forward-in-time state equation is supplemented with a backward-in-time co-state equation, the latter being a characterization of Lagrange multipliers in this constrained optimization problem. The equations are solved iteratively, and the converged pair produces the optimal control. This problem, solved by itself without the context of the ABM, leads to a time schedule of harvesting rates.</p><p>To lift the resulting control to the ABM, just like the harvesting strategy of the &#x0201c;brute force&#x0201d; optimization above, this rate is used as a random mortality, applied uniformly across the domain. Each rabbit will be harvested with probability <italic>u</italic>(<italic>t</italic>).</p><p>The work in Federico et&#x000a0;al. (<xref ref-type="bibr" rid="CR5">2013</xref>) contains a number of explorations of this approach, including a heterogeneous grass growth environment. In that heterogeneous environment case, the optimal controls coming from the aggregate differential equation system did not work well in the ABM. In Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>, we illustrate the approach&#x02019;s results within a simple homogenous environment. The figure shows the time course resulting from the application of the consumer-resource -based optimal control to the ABM. In the upper panel, we see the model&#x02019;s fit to the ABM data when no control is applied. The lower panel shows the time course when the optimal control is applied, showing a highly reduced number of rabbits. In distinction from the previous approach, the cost functional in this situation contains a fixed (if implicit) balancing of the &#x0201c;tolerable&#x0201d; levels of control effort and residual pest population. The Pareto frontier in the previous approach would amount in this case to a parametric plot of the control effort and residual rabbit population as a function of the parameters <inline-formula id="IEq20"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{1}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq20.gif"/></alternatives></inline-formula> and <inline-formula id="IEq21"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{2}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq21.gif"/></alternatives></inline-formula>.<fig id="Fig5"><label>Fig. 5</label><caption><p>(Color Figure Online) Time course of grass and rabbit abundance, comparing ABM and SLM. <italic>Upper panel</italic> compares the models without any control applied, while the <italic>lower panel</italic> compares the two with the SLM&#x02019;s optimal control</p></caption><graphic xlink:href="11538_2016_225_Fig5_HTML" id="MO13"/></fig>
</p></sec><sec id="Sec10"><title>Empirical SLM Derived for ABM Approximation</title><p>Here, we again view the ABM as an input&#x02013;output experimental system. We select the output statistics to control: namely the abundance of rabbits. Our goal, once again, is to devise a harvesting strategy, uniformly applied across the domain, to reduce the abundance of the pest rabbit population.</p><p>Rather than consider the mechanistic approach of modeling the rabbit/grass dynamics as consumer-resource, we simply consider the most desirable state of the system, which is every cell populated by grass with no rabbits present. To achieve this state while controlling the level of harvesting effort is the objective. Toward that end, we consider a rabbits-and-grass model with an initial state of <inline-formula id="IEq22"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(r_{0}, g_{0})=(0,N)$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq22.gif"/></alternatives></inline-formula> and the desired final state of <inline-formula id="IEq23"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(r_{f}, g_{f})$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq23.gif"/></alternatives></inline-formula>, where <italic>N</italic> denotes the number of cells in the ABM. We note that this desired final state is an equilibrium: if there are no rabbits to begin with, the grass will eventually populate every cell. It is unstable; however, as soon as a single rabbit is introduced, the population can and will increase according to the rules of the ABM.</p><p>We model the system as a simple linear system, which we envision as being linearized around the desired final state:<disp-formula id="Equ8"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\dot{x}}=A(x-x_{f})+Bu, \end{aligned}$$\end{document}</tex-math><mml:math id="M60" display="block"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>u</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2016_225_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>in which <italic>x</italic> denotes the state pair <inline-formula id="IEq24"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=(r,g)^{T}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq24.gif"/></alternatives></inline-formula>, <inline-formula id="IEq25"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{f}=(r_{f},g_{f})^{T}=(0,N)^{T}$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq25.gif"/></alternatives></inline-formula>, <italic>A</italic> is a <inline-formula id="IEq26"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\times 2$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mn>2</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq26.gif"/></alternatives></inline-formula> matrix, and <italic>B</italic> is a <inline-formula id="IEq27"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\times 1$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mn>2</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq27.gif"/></alternatives></inline-formula> matrix, both of which must be inferred from the ABM. Assuming that the harvesting does not directly lead to grass abundance change, one may take <inline-formula id="IEq28"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B=(b,0)^{T}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq28.gif"/></alternatives></inline-formula> with one unknown parameter. The model here is not necessarily expected to fit the dynamics over the whole range of possible rabbit and grass states; rather, it is meant as a means to the end of constructing a feedback control gain.</p><p>The fitting approach is as follows. The differential equation can be approximated by an Euler step, for short time <italic>h</italic>, as<disp-formula id="Equ9"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} x(h)-z=A(z-x_{f})+Bv, \end{aligned}$$\end{document}</tex-math><mml:math id="M72" display="block"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>v</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2016_225_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>in which <italic>z</italic> and <italic>v</italic> denote initial state and control values. By selecting a random sample of initial states and control values, say <inline-formula id="IEq29"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(z_{i}, u_{i}), i=1,2,\ldots ,n,$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq29.gif"/></alternatives></inline-formula> and by evaluating the ABM for a short time at these values, we obtain an &#x0201c;experimental sample,&#x0201d; which we denote by <inline-formula id="IEq30"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{i}(h)$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq30.gif"/></alternatives></inline-formula>. The values of <italic>A</italic> and <italic>b</italic> may then be obtained via linear regression. It is important to note that this technique depends on very short time executions of the ABM, as opposed to the parametric fits of the previous approach that rely on long time simulations. The approach we describe here is closely related to Kevrekides&#x02019; so-called &#x0201c;equation free&#x0201d; analysis technique (Kevrekedis et&#x000a0;al. <xref ref-type="bibr" rid="CR15">2004</xref>; Armaou <xref ref-type="bibr" rid="CR1">2004</xref>). The application of this technique to the rabbits-and-grass ABM is described in detail in Fitzpatrick (<xref ref-type="bibr" rid="CR9">2016b</xref>).</p><p>Control strategies can be derived in a number of ways. In particular, one may apply the forward-backward iteration of Federico et&#x000a0;al. (<xref ref-type="bibr" rid="CR5">2013</xref>) mentioned above. A different, much simpler approach, is the linear quadratic regulator. We denote by <italic>w</italic> the state perturbation from equilibrium: <inline-formula id="IEq31"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w(x-x_{f},)$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq31.gif"/></alternatives></inline-formula> so that <inline-formula id="IEq32"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\dot{w}}=Aw+Bu$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>u</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq32.gif"/></alternatives></inline-formula>, and we define the cost functional<disp-formula id="Equ10"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J(u)={\mathop {\int }\limits _{0}^{\infty }}w^{T} Qw+u^{T} Ru \,\mathrm{d}t \end{aligned}$$\end{document}</tex-math><mml:math id="M82" display="block"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>J</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>&#x0221e;</mml:mi></mml:munderover><mml:msup><mml:mi>w</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>Q</mml:mi><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>R</mml:mi><mml:mi>u</mml:mi><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2016_225_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>in which <italic>Q</italic> is a <inline-formula id="IEq33"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2 \times 2$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mn>2</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq33.gif"/></alternatives></inline-formula> nonnegative definite matrix, and <italic>R</italic> is a positive scalar. As with the constants <inline-formula id="IEq34"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{1}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq34.gif"/></alternatives></inline-formula> and <inline-formula id="IEq35"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{2}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq35.gif"/></alternatives></inline-formula> in the objective of the mechanistic SLM approach, these matrices contain tuning parameters used to achieve desired results. For this problem, we choose <inline-formula id="IEq36"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q= \left[ \begin{array}{ll} 1 &#x00026;{} 0 \\ 0 &#x00026;{} 0 \\ \end{array} \right] $$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq36.gif"/></alternatives></inline-formula>, so that the objective becomes<disp-formula id="Equ11"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} J(u)={\mathop {\int }\limits _{0}^{\infty }}r^{2}(t)+Ru^{2} (t) \text {d}t \end{aligned}$$\end{document}</tex-math><mml:math id="M92" display="block"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>J</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>&#x0221e;</mml:mi></mml:munderover><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:msup><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2016_225_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>similar to the mechanistic SLM objective. The major advantage to this linear&#x02013;quadratic formulation is that the control is determined by the solution of an algebraic Riccati equation:<disp-formula id="Equ12"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} u= &#x00026; {} -Kx, \hbox { with }\\ K= &#x00026; {} R^{-1} B'P, \hbox { where}\\ 0= &#x00026; {} A'P+PA+Q-PBR^{-1} B'P \end{aligned}$$\end{document}</tex-math><mml:math id="M94" display="block"><mml:mrow><mml:mtable columnspacing="0.5ex"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mo>-</mml:mo><mml:mi>K</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>with</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>K</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>B</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>where</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msup><mml:mi>A</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mi>A</mml:mi><mml:mo>+</mml:mo><mml:mi>Q</mml:mi><mml:mo>-</mml:mo><mml:mi>P</mml:mi><mml:mi>B</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>B</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mi>P</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2016_225_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>So the solution of this final equation, a quadratic equation for a symmetric <inline-formula id="IEq37"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2 \times 2$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mn>2</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2016_225_Article_IEq37.gif"/></alternatives></inline-formula> positive definite matrix, leads directly to a simple formula for the control as a constant gain matrix <italic>K</italic> applied to the rabbit and grass state. Lifting the control is again accomplished by harvesting with probability <italic>u</italic>(<italic>t</italic>) across the region of interest. In analogy with Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref> for the mechanistic nonlinear SLM, Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> shows the results of the ABM with no control applied and with the optimal linear&#x02013;quadratic SLM control applied.<fig id="Fig6"><label>Fig. 6</label><caption><p>(Color Figure Online) Time course of grass and rabbit abundance. <italic>Upper panel</italic> compares the models without any control applied, while the <italic>lower panel</italic> compares the two with the SLM&#x02019;s optimal control</p></caption><graphic xlink:href="11538_2016_225_Fig6_HTML" id="MO19"/></fig>
</p></sec></sec><sec id="Sec11"><title>Discussion</title><p>ABMs offer an interesting investigative tool for science, engineering, public health, and public policy. Replicating important features of real-world systems with relatively simple rule-based computational models make ABMs attractive alternatives to traditional mathematical models. Using ABMs as decision tools to improve or optimize real-world systems, however, remain a significant challenge. In this &#x0201c;Perspectives&#x0201d; article, we have examined a number of systems-level control approaches that might be applied to ABMs, using the simple Rabbits&#x02013;Grass&#x02013;Weed ABM as a pest control example.</p><p>In approaching an ABM from the point of view of control, a number of key problems arise, especially when SLM approximations are used. Most fundamental is the mapping of inputs and outputs between ABM-scale and SLM-scale quantities, which we have called &#x0201c;lifting&#x0201d; and &#x0201c;projection.&#x0201d; Next, one must consider the necessary complexity of the SLM required to capture the ABM dynamics relevant to the control inputs and objective.</p><p>While the simple example of the Rabbits&#x02013;Grass&#x02013;Weed pest control problem allows us to illustrate some features of ABMs and suggest some approaches to their control, many challenges remain for a more general toolset for the system-level analysis of ABMs and their control. To develop mathematical approaches, we must pay careful attention to a number of issues, including (but by no means limited to)<list list-type="bullet"><list-item><p>Methods for dimension reduction;</p></list-item><list-item><p>The extensive heterogeneity possible for individual agents;</p></list-item><list-item><p>Agent adaptation;</p></list-item><list-item><p>Multiple time scales that emerge in complex ABMs;</p></list-item><list-item><p>Taxonomy of ABMs with respect to different SLM paradigms and success of one of the three approaches outlined in this paper (or others);</p></list-item><list-item><p>Rigorous methods for projection and lifting in order to map between analytical and simulation models;</p></list-item><list-item><p>Efficient computational experimental design; and</p></list-item><list-item><p>Uncertainty quantification in assessing SLM&#x02013;ABM compatibility.</p></list-item></list>Ronald Fisher proposed a statistical framework (Fisher <xref ref-type="bibr" rid="CR6">1926</xref>) that defined quantitative experimental design, and Wald&#x02019;s seminal work (Wald <xref ref-type="bibr" rid="CR36">1939</xref>) energized research in statistical decision theory. These and related works provide solid theoretical foundations and practical techniques for designing experiments and optimizing outcomes based on statistical assumptions about the underlying experimental processes. As simulation models have come to complement physical and biological experimentation, statistical design and decision theory has been revisited (see e.g., Morris et&#x000a0;al. <xref ref-type="bibr" rid="CR22">1993</xref>), and progress has been made in leveraging some of the unique properties of ABM models for comparison with experiment (Grimm and Railsback <xref ref-type="bibr" rid="CR12">2005</xref>; Grimm et&#x000a0;al. <xref ref-type="bibr" rid="CR13">2005</xref>; Thorngate and Edmonds <xref ref-type="bibr" rid="CR35">2013</xref>). However, the structure of simulation models often contains a great deal of information, much of which yields analytical leverage for design and control. The opportunities are great for developing mathematical and statistical techniques for a new experimental design and decision theory for complex simulations such as ABMs. They bring a powerful modeling technology to scientists, enabling investigations that had previously been prevented from using models because of mathematical barriers-to-entry. For our purposes, we made the assumption that the ABM is a faithful representation of the actual biological system of interest, so that the goal is to develop control strategies for the ABM, with the implicit understanding that their efficacy for the real system will depend on the quality of the ABM. The main argument we present in this paper is that for the purpose of specific control and optimization problems, a given ABM can beneficially be viewed as a surrogate for the real system of interest that can be used for the construction of equation-based models for which control approaches are available. These equation-based models need to be faithful to the ABM and, by extension, the biological system of interest, ONLY to the extent that they capture correctly those aspects of the ABM that pertain to the specific control problem.</p><p>We have presented some possible ways to begin accomplishing this, even though the work to date is ad hoc and does not address many of the obvious questions that remain unanswered. Our investigations have mostly focused on two models, Sugarscape and Rabbits-and-Grass, in some variations. They were chosen because they include features found in many ABMs in the literature, but they are arguably too simple to draw conclusions about the broader applicability of our methods. Furthermore, the methods themselves are ad hoc and have not been analyzed rigorously. Are there common principles in how an ABM is approximated by a difference equations model or a PDE model? What are the limits of dimension reduction methods, and are there other comparisons of models that should be used to judge the faithfulness of a reduced model? Answers to these and many other questions await further research, and an important motivation for this paper is the hope that it will engage others in work on these problems. One important tool would be a suite of benchmark ABMs, representative of the different ABM types in use, that illustrate the applicability and limitations of the various techniques. And, of course, other, complementary, techniques will need to be developed.</p></sec></body><back><fn-group><fn><p>G. An, B. G. Fitzpatrick co-first authors.</p><p>S. Christley, P. Federico, A. Kanarek, R. Miller Neilan, M. Oremland, R. Salinas are contributed equally to the manuscript.</p><p>R. Laubenbacher, S. Lenhart co-last authors.</p></fn></fn-group><ack><p>This Project grew out of a NIMBioS (National Institute for Mathematical and Biological Synthesis) workshop in December 2009, followed in 2011 by ongoing work of an interdisciplinary NIMBioS working group (15 members) &#x0201c;Agent-based modeling of biological systems: pathways to control and optimization.&#x0201d; The workshop and working group were funded by NIMBioS, sponsored by the National Science Foundation, the U.S. Department of Homeland Security and the U.S. Department of Agriculture, through NSF Award EF-0832858NSF. The work of Lenhart and Fitzpatrick is also partially supported by NIMBioS Award DBI-1300426. Fitzpatrick has also been supported in part by the Air Force Office of Scientific Research grants FA9550-09-1-0524 and FA9550-10-1-0499. The work of Oremland and Laubenbacher has been supported by Grants N911NF0910538 (U.S. DoD) and DMS-1062878 (NSF), and Oremland was partially supported by NSF grant DMS-0931642 to the Mathematical Biosciences Institute. An&#x02019;s work was partially supported by National Institutes of Health Grants R01-GM-115839 and P30-DK-42086.</p></ack><ref-list id="Bib1"><title>References</title><ref id="CR1"><mixed-citation publication-type="other">Armaou, A (2004). Continuous-time control of distributed processes via microscopic simulation. In: Proceedings of 2004 ACC, Boston, pp. 933&#x02013;939</mixed-citation></ref><ref id="CR2"><mixed-citation publication-type="other">Christley S, Miller Neilan R, Oremland M, Salinas R, Lenhart S (2015). Optimal control of SugarScape agent-based model via a PDE approximation model, preprint 2015</mixed-citation></ref><ref id="CR3"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Epstein</surname><given-names>J</given-names></name><name><surname>Axtell</surname><given-names>R</given-names></name></person-group><source>Growing artificial societies</source><year>1996</year><publisher-loc>Boston</publisher-loc><publisher-name>Brookings Institution Press</publisher-name></element-citation></ref><ref id="CR4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eubank</surname><given-names>S</given-names></name></person-group><article-title>Network based models of infectious disease spread</article-title><source>Jpn J Infect Dis</source><year>2005</year><volume>58</volume><issue>6</issue><fpage>S9</fpage><lpage>13</lpage><pub-id pub-id-type="pmid">16377861</pub-id></element-citation></ref><ref id="CR5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Federico</surname><given-names>P</given-names></name><name><surname>Lenhart</surname><given-names>S</given-names></name><name><surname>Ryan</surname><given-names>D</given-names></name><name><surname>Gross</surname><given-names>L</given-names></name></person-group><article-title>Optimal control in individual based models: implication from aggregated methods</article-title><source>Am. Nat.</source><year>2013</year><volume>181</volume><fpage>64</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1086/668594</pub-id><pub-id pub-id-type="pmid">23234846</pub-id></element-citation></ref><ref id="CR6"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>RA</given-names></name></person-group><source>The design of experiments</source><year>1926</year><publisher-loc>Edinburgh</publisher-loc><publisher-name>Oliver and Boyd</publisher-name></element-citation></ref><ref id="CR7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fitzpatrick</surname><given-names>B</given-names></name><name><surname>Scribner</surname><given-names>R</given-names></name><name><surname>Ackleh</surname><given-names>A</given-names></name><name><surname>Rasul</surname><given-names>J</given-names></name><name><surname>Jacquez</surname><given-names>G</given-names></name><name><surname>Rommel</surname><given-names>R</given-names></name><name><surname>Simonsen</surname><given-names>N</given-names></name></person-group><article-title>Forecasting the effect of the Amethyst Initiative on college drinking</article-title><source>ACER</source><year>2012</year><volume>36</volume><issue>9</issue><fpage>1608</fpage><lpage>1613</lpage></element-citation></ref><ref id="CR8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fitzpatrick</surname><given-names>B</given-names></name><name><surname>Martinez</surname><given-names>J</given-names></name><name><surname>Polidan</surname><given-names>E</given-names></name><name><surname>Angelis</surname><given-names>E</given-names></name></person-group><article-title>On the effectiveness of social norms intervention in college drinking: the roles of identity verification and peer influence</article-title><source>Alcohol Clin Exp Res</source><year>2016</year><volume>40</volume><issue>1</issue><fpage>141</fpage><lpage>151</lpage><pub-id pub-id-type="doi">10.1111/acer.12919</pub-id><pub-id pub-id-type="pmid">26700688</pub-id></element-citation></ref><ref id="CR9"><mixed-citation publication-type="other">Fitzpatrick, B. (2016). An empirical systems identification approach to control of agent-based models (in preparation)</mixed-citation></ref><ref id="CR10"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gilbert</surname><given-names>N</given-names></name></person-group><source>Agent-based models</source><year>2008</year><publisher-loc>Thousand Oaks</publisher-loc><publisher-name>Sage</publisher-name></element-citation></ref><ref id="CR11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gong</surname><given-names>C</given-names></name><name><surname>Linderman</surname><given-names>JJ</given-names></name><name><surname>Kirschner</surname><given-names>D</given-names></name></person-group><article-title>A population model capturing dynamics of tuberculosis granulomas predicts host infection outcomes</article-title><source>Math Biosci Eng</source><year>2015</year><volume>12</volume><issue>3</issue><fpage>625</fpage><lpage>642</lpage><pub-id pub-id-type="doi">10.3934/mbe.2015.12.625</pub-id><pub-id pub-id-type="pmid">25811559</pub-id></element-citation></ref><ref id="CR12"><mixed-citation publication-type="other">Grimm V, Railsback S (2005) Individual based modeling and ecology. Princeton University Press, Princeton</mixed-citation></ref><ref id="CR13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grimm</surname><given-names>V</given-names></name><name><surname>Revilla</surname><given-names>E</given-names></name><name><surname>Berger</surname><given-names>U</given-names></name><name><surname>Jeltsch</surname><given-names>F</given-names></name><name><surname>Mooij</surname><given-names>WM</given-names></name><name><surname>Railsback</surname><given-names>SF</given-names></name><name><surname>Thulka</surname><given-names>H-H</given-names></name><name><surname>Weiner</surname><given-names>J</given-names></name><name><surname>Wiegand</surname><given-names>T</given-names></name><name><surname>DeAngelis</surname><given-names>DL</given-names></name></person-group><article-title>Pattern-oriented modeling of agent-based complex systems: lessons from ecology</article-title><source>Science</source><year>2005</year><volume>310</volume><fpage>987</fpage><lpage>991</lpage><pub-id pub-id-type="doi">10.1126/science.1116681</pub-id><pub-id pub-id-type="pmid">16284171</pub-id></element-citation></ref><ref id="CR14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hinkelmann</surname><given-names>F</given-names></name><name><surname>Murrugarra</surname><given-names>D</given-names></name><name><surname>Jarrah</surname><given-names>A</given-names></name><name><surname>Laubenbacher</surname><given-names>R</given-names></name></person-group><article-title>A mathematical framework for agent-based models of complex biological networks</article-title><source>Bull Math Biol</source><year>2011</year><volume>73</volume><issue>7</issue><fpage>1583</fpage><lpage>1603</lpage><pub-id pub-id-type="doi">10.1007/s11538-010-9582-8</pub-id><pub-id pub-id-type="pmid">20878493</pub-id></element-citation></ref><ref id="CR15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kevrekedis</surname><given-names>IG</given-names></name><name><surname>Gear</surname><given-names>CW</given-names></name><name><surname>Hummer</surname><given-names>G</given-names></name></person-group><article-title>Equation-free: the computer-aided analysis of complex multiscale systems</article-title><source>AIChE J</source><year>2004</year><volume>50</volume><issue>7</issue><fpage>1346</fpage><lpage>1355</lpage><pub-id pub-id-type="doi">10.1002/aic.10106</pub-id></element-citation></ref><ref id="CR16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>PS</given-names></name><name><surname>Lee</surname><given-names>PP</given-names></name><name><surname>Levy</surname><given-names>D</given-names></name></person-group><article-title>Modeling imatinib-treated chronic myelogenous leukemia: reducing the complexity of agent-based models</article-title><source>Bull Math Biol</source><year>2008</year><volume>70</volume><issue>3</issue><fpage>728</fpage><lpage>744</lpage><pub-id pub-id-type="doi">10.1007/s11538-007-9276-z</pub-id><pub-id pub-id-type="pmid">18060460</pub-id></element-citation></ref><ref id="CR17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>PS</given-names></name><name><surname>Lee</surname><given-names>PP</given-names></name><name><surname>Levy</surname><given-names>D</given-names></name></person-group><article-title>A PDE model for imatinib-treated chronic myelogenous leukemia</article-title><source>Bull Math Biol</source><year>2008</year><volume>70</volume><issue>7</issue><fpage>1994</fpage><lpage>2016</lpage><pub-id pub-id-type="doi">10.1007/s11538-008-9336-z</pub-id><pub-id pub-id-type="pmid">18663536</pub-id></element-citation></ref><ref id="CR18"><mixed-citation publication-type="other">Lenhart S, Xiong J, Yong J (2015) Controlled stochastic partial differential equations for rabbits on a grassland. preprint</mixed-citation></ref><ref id="CR19"><mixed-citation publication-type="other">Lenhart S, Xiong J, Yong J (2016) Optimal controls for stochastic partial differential equations with an application in population modeling. SIAM J Control Optim 54(2):495&#x02013;535</mixed-citation></ref><ref id="CR20"><mixed-citation publication-type="other">Levy B, Collins C, Lenhart S, Salinas RA, Madden M, Corn JL, Stiver W (2016) A metapopulation model for feral Hogs in Great Smoky Mountains National Park. Nat Resour Model J 29(1):71&#x02013;97</mixed-citation></ref><ref id="CR21"><mixed-citation publication-type="other">McCardell J (2008) The drinking age. The status quo has bombed. US News World Report 145:11</mixed-citation></ref><ref id="CR22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname><given-names>MD</given-names></name><name><surname>Mitchell</surname><given-names>TJ</given-names></name><name><surname>Ylvisaker</surname><given-names>D</given-names></name></person-group><article-title>Bayesian design and analysis of computer experiments: use of derivatives in surface prediction</article-title><source>Technometrics</source><year>1993</year><volume>35</volume><issue>3</issue><fpage>243</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1080/00401706.1993.10485320</pub-id></element-citation></ref><ref id="CR23"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Murray</surname><given-names>J</given-names></name></person-group><source>Mathematical biology ii: spatial models and biomedical applications</source><year>2011</year><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name></element-citation></ref><ref id="CR24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oremland</surname><given-names>M</given-names></name><name><surname>Laubenbacher</surname><given-names>R</given-names></name></person-group><article-title>Optimization of agent-based models: scaling methods and heuristic algorithms</article-title><source>J Artif Soc Soc Simul</source><year>2014</year><volume>17</volume><issue>2</issue><fpage>6</fpage></element-citation></ref><ref id="CR25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oremland</surname><given-names>M</given-names></name><name><surname>Laubenbacher</surname><given-names>R</given-names></name></person-group><article-title>Using difference equations to find optimal tax structures on the SugarScape</article-title><source>J Econ Interact Coord</source><year>2014</year><volume>9</volume><issue>2</issue><fpage>233</fpage><lpage>253</lpage><pub-id pub-id-type="doi">10.1007/s11403-014-0133-5</pub-id></element-citation></ref><ref id="CR26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oremland</surname><given-names>M</given-names></name><name><surname>Laubenbacher</surname><given-names>R</given-names></name></person-group><article-title>Optimal harvesting for a predator-prey agent-based model using difference equations</article-title><source>Bull Math Biol</source><year>2015</year><volume>77</volume><issue>3</issue><fpage>434</fpage><lpage>459</lpage><pub-id pub-id-type="doi">10.1007/s11538-014-0060-6</pub-id><pub-id pub-id-type="pmid">25559457</pub-id></element-citation></ref><ref id="CR27"><mixed-citation publication-type="other">Peine J, Farmer J (1990) Wild Hog Management Program at Great Smoky Mountain National Park. In: Proceedings of 14th vertebrate pest conference, Paper 67</mixed-citation></ref><ref id="CR28"><element-citation publication-type="book"><person-group person-group-type="author"><collab>President&#x02019;s Information Technology Advisory Committee</collab></person-group><source>Computational science: ensuring America&#x02019;s competitiveness</source><year>2005</year><publisher-loc>Arlington</publisher-loc><publisher-name>National Coordination Office for Information Technology Research and Development</publisher-name></element-citation></ref><ref id="CR29"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Railsback</surname><given-names>S</given-names></name><name><surname>Grimm</surname><given-names>V</given-names></name></person-group><source>Agent-based and individual-based modeling: a practical introduction</source><year>2012</year><publisher-loc>Princeton</publisher-loc><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="CR30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roeder</surname><given-names>I</given-names></name><name><surname>Horn</surname><given-names>M</given-names></name><name><surname>Glauche</surname><given-names>I</given-names></name><name><surname>Hochhaus</surname><given-names>A</given-names></name><name><surname>Mueller</surname><given-names>MC</given-names></name><name><surname>Loeffler</surname><given-names>M</given-names></name></person-group><article-title>Dynamic modeling of imatinib-treated chronic myeloid leukemia: functional insights and clinical impliations</article-title><source>Nat Med</source><year>2006</year><volume>12</volume><issue>10</issue><fpage>1181</fpage><lpage>1184</lpage><pub-id pub-id-type="doi">10.1038/nm1487</pub-id><pub-id pub-id-type="pmid">17013383</pub-id></element-citation></ref><ref id="CR31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salinas</surname><given-names>RA</given-names></name><name><surname>Stiver</surname><given-names>WH</given-names></name><name><surname>Corn</surname><given-names>JL</given-names></name><name><surname>Lenhart</surname><given-names>S</given-names></name><name><surname>Collins</surname><given-names>C</given-names></name><name><surname>Madden</surname><given-names>M</given-names></name><name><surname>Vercauteren</surname><given-names>KC</given-names></name><name><surname>Schmit</surname><given-names>BB</given-names></name><name><surname>Kasari</surname><given-names>E</given-names></name><name><surname>Adoi</surname><given-names>A</given-names></name><name><surname>Hickling</surname><given-names>G</given-names></name><name><surname>Mccallum</surname><given-names>H</given-names></name></person-group><article-title>An individual-based model for feral hogs in Great Smoky Mountains National Park</article-title><source>Nat Resour Model</source><year>2015</year><volume>28</volume><issue>1</issue><fpage>18</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1111/nrm.12055</pub-id></element-citation></ref><ref id="CR32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schelling</surname><given-names>T</given-names></name></person-group><article-title>Dynamic models of segregation</article-title><source>J Math Sociol</source><year>1971</year><volume>1</volume><issue>2</issue><fpage>143</fpage><lpage>186</lpage><pub-id pub-id-type="doi">10.1080/0022250X.1971.9989794</pub-id></element-citation></ref><ref id="CR33"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Smarr</surname><given-names>LL</given-names></name></person-group><source>How supercomputers are transforming science, in yearbook of science and the future</source><year>1992</year><publisher-loc>Chicago</publisher-loc><publisher-name>Encyclopedia Britannica</publisher-name></element-citation></ref><ref id="CR34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stroud</surname><given-names>P</given-names></name><name><surname>Del Valle</surname><given-names>S</given-names></name><name><surname>Sydoriak</surname><given-names>S</given-names></name><name><surname>Riese</surname><given-names>J</given-names></name><name><surname>Mniszewski</surname><given-names>S</given-names></name></person-group><article-title>Spatial dynamics of pandemic influenza in a massive artificial society</article-title><source>J Artif Soc Soc Simul</source><year>2007</year><volume>10</volume><issue>4</issue><fpage>9</fpage></element-citation></ref><ref id="CR35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thorngate</surname><given-names>W</given-names></name><name><surname>Edmonds</surname><given-names>B</given-names></name></person-group><article-title>Measuring simulation&#x02013;observation fit: an introduction to ordinal pattern analysis</article-title><source>JASSS</source><year>2013</year><volume>16</volume><issue>2</issue><fpage>4</fpage><pub-id pub-id-type="doi">10.18564/jasss.2139</pub-id></element-citation></ref><ref id="CR36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wald</surname><given-names>A</given-names></name></person-group><article-title>Contributions to the theory of statistical estimation and hypothesis testing</article-title><source>Ann Math Stat</source><year>1939</year><volume>10</volume><issue>4</issue><fpage>299</fpage><lpage>326</lpage><pub-id pub-id-type="doi">10.1214/aoms/1177732144</pub-id></element-citation></ref><ref id="CR37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Xue</surname><given-names>H</given-names></name><name><surname>Chen</surname><given-names>HJ</given-names></name><name><surname>Igusa</surname><given-names>T</given-names></name></person-group><article-title>Examining social norm impacts on obesity and eating behaviors among US school children based on an agent-based model</article-title><source>BMC Public Health</source><year>2014</year><volume>14</volume><fpage>923</fpage><pub-id pub-id-type="doi">10.1186/1471-2458-14-923</pub-id><pub-id pub-id-type="pmid">25194699</pub-id></element-citation></ref><ref id="CR38"><mixed-citation publication-type="other">Wilensky U (2001) <ext-link ext-link-type="uri" xlink:href="http://ccl.northwestern.edu/netlogo/models/RabbitsGrassWeeds">http://ccl.northwestern.edu/netlogo/models/RabbitsGrassWeeds</ext-link>. NetLogo Rabbits Grass Weeds model, Center for connected learning and computer-based modeling. Northwestern University, Evanston</mixed-citation></ref><ref id="CR39"><mixed-citation publication-type="other">Wilensky U (2009) <ext-link ext-link-type="uri" xlink:href="http://ccl.northwestern.edu/netlogo/models/community/SugarscapeW">http://ccl.northwestern.edu/netlogo/models/community/SugarscapeW</ext-link>. Sugarscape, Center for connected learning and computer-based modeling. Northwestern University, Evanston</mixed-citation></ref><ref id="CR40"><mixed-citation publication-type="other">Wilensky U (1999) NetLogo. <ext-link ext-link-type="uri" xlink:href="http://ccl.northwestern.edu/netlogo/">http://ccl.northwestern.edu/netlogo/</ext-link>. Center for connected learning and computer-based modeling. Northwestern University, Evanston</mixed-citation></ref><ref id="CR41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ziraldo</surname><given-names>C</given-names></name><name><surname>Solovyev</surname><given-names>A</given-names></name><etal/></person-group><article-title>A computational, tissue-realistic model of presure ulcer formation in individuals with spinal cord injury</article-title><source>PloS Comput Biol</source><year>2015</year><volume>11</volume><issue>6</issue><fpage>e1004309</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004309</pub-id><pub-id pub-id-type="pmid">26111346</pub-id></element-citation></ref></ref-list></back></article>