<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bull Math Biol</journal-id><journal-id journal-id-type="iso-abbrev">Bull. Math. Biol</journal-id><journal-title-group><journal-title>Bulletin of Mathematical Biology</journal-title></journal-title-group><issn pub-type="ppub">0092-8240</issn><issn pub-type="epub">1522-9602</issn><publisher><publisher-name>Springer US</publisher-name><publisher-loc>New York</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">29238909</article-id><article-id pub-id-type="pmc">5790869</article-id><article-id pub-id-type="publisher-id">381</article-id><article-id pub-id-type="doi">10.1007/s11538-017-0381-3</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Article</subject></subj-group></article-categories><title-group><article-title>Tree-Based Unrooted Phylogenetic Networks</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Francis</surname><given-names>A.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Huber</surname><given-names>K. T.</given-names></name><address><email>k.huber@uea.ac.uk</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Moulton</surname><given-names>V.</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9939 5719</institution-id><institution-id institution-id-type="GRID">grid.1029.a</institution-id><institution>Centre for Research in Mathematics, </institution><institution>Western Sydney University, </institution></institution-wrap>Sydney, Australia </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1092 7967</institution-id><institution-id institution-id-type="GRID">grid.8273.e</institution-id><institution>School of Computing Sciences, </institution><institution>University of East Anglia, </institution></institution-wrap>Norwich, UK </aff></contrib-group><pub-date pub-type="epub"><day>13</day><month>12</month><year>2017</year></pub-date><pub-date pub-type="pmc-release"><day>13</day><month>12</month><year>2017</year></pub-date><pub-date pub-type="ppub"><year>2018</year></pub-date><volume>80</volume><issue>2</issue><fpage>404</fpage><lpage>416</lpage><history><date date-type="received"><day>12</day><month>4</month><year>2017</year></date><date date-type="accepted"><day>5</day><month>12</month><year>2017</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2017</copyright-statement><license license-type="OpenAccess"><license-p>
<bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>/), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">Phylogenetic networks are a generalization of phylogenetic trees that are used to represent non-tree-like evolutionary histories that arise in organisms such as plants and bacteria, or uncertainty in evolutionary histories. An <italic>unrooted</italic> phylogenetic network on a non-empty, finite set <italic>X</italic> of taxa, or <italic>network</italic>, is a connected, simple graph in which every vertex has degree 1 or 3 and whose leaf set is <italic>X</italic>. It is called a <italic>phylogenetic tree</italic> if the underlying graph is a tree. In this paper we consider properties of <italic>tree-based networks</italic>, that is, networks that can be constructed by adding edges into a phylogenetic tree. We show that although they have some properties in common with their rooted analogues which have recently drawn much attention in the literature, they have some striking differences in terms of both their structural and computational properties. We expect that our results could eventually have applications to, for example, detecting horizontal gene transfer or hybridization which are important factors in the evolution of many organisms.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Phylogenetic tree</kwd><kwd>Phylogenetic network</kwd><kwd>Tree-based network</kwd><kwd>Hamiltonian path</kwd></kwd-group><funding-group><award-group><funding-source><institution>London Mathematical Society (GB)</institution></funding-source></award-group></funding-group><funding-group><award-group><funding-source><institution>London Mathematical Society (GB)</institution></funding-source></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000288</institution-id><institution>Royal Society</institution></institution-wrap></funding-source></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; Society for Mathematical Biology 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">Let <italic>X</italic> be a finite set with <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X| \ge 1$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02265;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq1.gif"/></alternatives></inline-formula>. An <italic>unrooted phylogenetic network N (on X)</italic> (or <italic>network N (on X)</italic> for short) is a connected, simple graph (<italic>V</italic>,&#x000a0;<italic>E</italic>) with <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X \subseteq V$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02286;</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq2.gif"/></alternatives></inline-formula>, every vertex has degree 1 or 3, and the set of degree 1 vertices (or <italic>leaves</italic>) is precisely <italic>X</italic>. A <italic>phylogenetic tree</italic> on <italic>X</italic> is a network which is also a tree. Phylogenetic trees and networks are commonly used by biologists to represent the evolution of species; in this setting the set <italic>X</italic> usually denotes a collection of species. Networks have interesting mathematical and computational properties (see, e.g. Huber et&#x000a0;al. <xref ref-type="bibr" rid="CR8">2016</xref>; Gambette et&#x000a0;al. <xref ref-type="bibr" rid="CR4">2012</xref>; Semple and Steel <xref ref-type="bibr" rid="CR15">2006</xref>), and they can be generated from biological data using software packages such as T-REX (Makarenkov <xref ref-type="bibr" rid="CR12">2001</xref>) and Splitstree (Huson and Bryant <xref ref-type="bibr" rid="CR9">2006</xref>). In addition, networks have been used to study the genome fusion origin of eukaryotes (Rivera and Lake <xref ref-type="bibr" rid="CR13">2004</xref>) and as a tool in biogeography studies (Legendre and Makarenkov <xref ref-type="bibr" rid="CR11">2002</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>A tree-based network that has been constructed from a phylogenetic tree with leaf set <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{a,b,\dots ,g\}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq3.gif"/></alternatives></inline-formula> by adding in 3 edges (in grey). Note that the tree is also a spanning tree for the network</p></caption><graphic xlink:href="11538_2017_381_Fig1_HTML" id="MO1"/></fig>
</p><p id="Par3">The T-REX software constructs networks (also called reticulograms) by adding edges into a phylogenetic tree (Makarenkov <xref ref-type="bibr" rid="CR12">2001</xref>) (see, e.g. Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). Using this approach, many different networks can be constructed from starting with the collection of all phylogenetic trees. However, it is not possible to construct every possible network in this manner (see, for example, Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> below). Indeed, the networks that can be constructed in this way are of precisely the following type (cf. Francis et&#x000a0;al. <xref ref-type="bibr" rid="CR3">2018</xref>).</p><sec id="FPar1"><title>Definition 1</title><p id="Par4">A network is <italic>tree-based (on X)</italic> if there is a spanning tree<xref ref-type="fn" rid="Fn1">1</xref> in <italic>N</italic> whose leaf set is equal to <italic>X</italic>.</p><p>Note that in the following we call any spanning tree in <italic>N</italic> with leaf set <italic>X</italic> a <italic>support tree (for N)</italic>.</p><p>Recently, a great deal of interest has been generated concerning rooted tree-based networks. These are leaf-labelled networks whose underlying graph is a directed acyclic graph with a single root which can be constructed from a rooted phylogenetic tree by adding in extra arcs (see Sect.&#x000a0;<xref rid="Sec5" ref-type="sec">5</xref> for precise definitions). In particular, rooted tree-based networks were introduced in (Francis and Steel <xref ref-type="bibr" rid="CR2">2015</xref>) and their structural properties have been studied in Francis et&#x000a0;al. (<xref ref-type="bibr" rid="CR3">2018</xref>), Hayamizu (<xref ref-type="bibr" rid="CR7">2016</xref>), Jetten and van Iersel (<xref ref-type="bibr" rid="CR10">2016</xref>), Semple (<xref ref-type="bibr" rid="CR14">2016</xref>), Zhang (<xref ref-type="bibr" rid="CR19">2016</xref>). In addition, various computational properties of these networks have been considered (Anaya et&#x000a0;al. <xref ref-type="bibr" rid="CR1">2016</xref>; Francis and Steel <xref ref-type="bibr" rid="CR2">2015</xref>).</p><p>Biologically, tree-based networks are a natural object of interest because their presentation of reticulations reflects assumptions about the underlying biological events (such as horizontal gene transfer or hybridization). Such events are regarded as occurring between taxonomic units (such as species) that also undergo vertical evolution; hence they are thought of as arcs between &#x0201c;tree&#x0201d; arcs. Biologists want to detect and understand horizontal evolution through events such as gene transfer and hybridization since this process plays an important role in the evolution of many organisms (e.g. in bacteria and plants). Moreover, detecting horizontal evolution can be useful in applications, e.g. horizontal gene transfer is the primary mechanism for the spread of antibiotic resistance in bacteria (Gyles and Boerlin <xref ref-type="bibr" rid="CR6">2014</xref>).</p><p>In this paper, we introduce tree-based networks in an unrooted setting and present various results concerning them. Understanding such networks in an unrooted context has similar value to the study of phylogenetic trees in the unrooted context: we are able to allow for uncertainty in the placement of the root. As we shall see, although tree-based networks have certain properties in common with their rooted analogues, they can behave quite differently both in terms of their structural and computational properties.</p><p>The outline of the paper is as follows. In the next section, we introduce some relevant basic terminology and also present a way to decompose a network into simpler, easier to understand pieces. In Sect.&#x000a0;<xref rid="Sec3" ref-type="sec">3</xref>, we consider the computational problem of deciding whether or not a given network <italic>N</italic> is tree-based. For this we introduce two novel decision problems and contrast our findings with the analogous situation for rooted phylogenetic networks. In Sect.&#x000a0;<xref rid="Sec4" ref-type="sec">4</xref>, we show that for every non-empty set <italic>X</italic> there exists a tree-based network <italic>N</italic> on <italic>X</italic> such that every phylogenetic tree <italic>T</italic> on <italic>X</italic> is a base-tree for <italic>N</italic>, and we also establish an explicit relationship between rooted and unrooted tree-based networks (Theorem&#x000a0;<xref ref-type="sec" rid="FPar17">4</xref>). In Sect.&#x000a0;<xref rid="Sec5" ref-type="sec">5</xref>, we characterize level-1 networks in terms of tree-based networks. We conclude with Sect.&#x000a0;<xref rid="Sec6" ref-type="sec">6</xref> where we outline research directions that might be of interest.</p></sec></sec><sec id="Sec2"><title>Decomposing Tree-Based Networks</title><p id="Par11">We begin by showing that networks can be decomposed into simpler pieces, which can then be used to deduce properties of the full network. Note that decomposition results have also been proven for rooted tree-based networks, although these are quite different in nature (see, e.g. Zhang <xref ref-type="bibr" rid="CR19">2016</xref>).</p><p id="Par12">We begin by presenting some definitions. A <italic>cut-edge</italic>, or <italic>bridge</italic>, of a network is an edge whose removal disconnects the graph. A cut-edge is <italic>trivial</italic> if one of the connected components induced by deleting the cut-edge is a vertex (which must necessarily be a leaf). A <italic>simple</italic> network is one all of whose cut-edges are trivial (so for instance, note that trees on more than 3 leaves are <italic>not</italic> simple networks). A <italic>blob</italic> in a network is a maximal subgraph that has no cut-edge and that is not a vertex&#x000a0;(Gambette et&#x000a0;al. <xref ref-type="bibr" rid="CR4">2012</xref>). For example, the network in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> contains one non-trivial cut-edge and two blobs.</p><p id="Par13">Now, given a network <italic>N</italic> and a blob <italic>B</italic> in <italic>N</italic>, we define a simple network <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_N$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq4.gif"/></alternatives></inline-formula> by taking the union of <italic>B</italic> and all cut-edges in <italic>N</italic> incident with <italic>B</italic> (the leaf set of <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_N$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq5.gif"/></alternatives></inline-formula> is just the set of end vertices of these cut-edges that are not already a vertex in <italic>B</italic>).</p><sec id="FPar2"><title>Proposition 1</title><p id="Par14">Suppose <italic>N</italic> is a network. Then <italic>N</italic> is tree-based if and only if <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_N$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq6.gif"/></alternatives></inline-formula> is tree-based for every blob <italic>B</italic> in <italic>N</italic>.</p></sec><sec id="FPar3"><title>Proof</title><p id="Par15">If <italic>N</italic> is tree-based, then it contains a support tree <italic>T</italic>. Since every cut-edge in <italic>N</italic> must be contained in a support tree, it follows that if <italic>B</italic> is a blob in <italic>N</italic>, then <italic>T</italic> must induce a spanning tree of <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_N$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq7.gif"/></alternatives></inline-formula> that contains every vertex in <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_N$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq8.gif"/></alternatives></inline-formula>. Therefore, <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_N$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq9.gif"/></alternatives></inline-formula> is tree-based.</p><p id="Par16">Conversely, if <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_N$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq10.gif"/></alternatives></inline-formula> is tree-based for every blob <italic>B</italic> in <italic>N</italic>, then by taking a support tree in <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_N$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq11.gif"/></alternatives></inline-formula> for each blob <italic>B</italic> in <italic>N</italic>, we can clearly construct a spanning tree for <italic>N</italic> that contains all vertices in <italic>N</italic>. Therefore, <italic>N</italic> is tree-based.<inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M24"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq12.gif"/></alternatives></inline-formula>
</p><p>Using the last result, we can immediately classify the tree-based networks having a single leaf.</p></sec><sec id="FPar4"><title>Observation 1</title><p id="Par18">Suppose <italic>N</italic> is a network on <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{x\}$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq13.gif"/></alternatives></inline-formula>. Then <italic>N</italic> is tree-based if and only if <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=(\{x\},\emptyset )$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x02205;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq14.gif"/></alternatives></inline-formula>.</p><p>We now look in more detail at the cut-edges of a tree-based network. A <italic>split</italic> of <italic>X</italic> is a bipartition of <italic>X</italic> into two non-empty sets. If we remove a cut-edge from a network, then in some cases the two resulting graphs will induce a split of <italic>X</italic>. We now show that if <italic>N</italic> is tree-based, then this is always the case.</p></sec><sec id="FPar5"><title>Lemma 2</title><p id="Par20">If <italic>N</italic> is a tree-based network, then every cut-edge of <italic>N</italic> induces a split of <italic>X</italic>.</p></sec><sec id="FPar6"><title>Proof</title><p id="Par21">If we have a cut-edge of <italic>N</italic> that does not induce a split of <italic>X</italic>, then it follows that there must be some blob <italic>B</italic> in <italic>N</italic> such that <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_N$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq15.gif"/></alternatives></inline-formula> is a network with one leaf. But then <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_N$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq16.gif"/></alternatives></inline-formula> is not tree-based by Observation&#x000a0;<xref ref-type="sec" rid="FPar4">1</xref>. This is a contradiction by Proposition&#x000a0;<xref ref-type="sec" rid="FPar2">1</xref>.<inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M34"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq17.gif"/></alternatives></inline-formula>
</p><p>We call a network <italic>N</italic>
<italic>proper</italic> if every cut-edge induces a split of <italic>X</italic>. By Lemma&#x000a0;<xref ref-type="sec" rid="FPar5">2</xref>, all tree-based networks are proper.</p><p>Interestingly, using Proposition&#x000a0;<xref ref-type="sec" rid="FPar2">1</xref>, we are able to now show that certain low complexity proper networks are always tree-based. We first make a useful observation.</p></sec><sec id="FPar7"><title>Lemma 3</title><p id="Par24">Let <italic>N</italic> be a network on <italic>X</italic> with <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X|\ge 2$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02265;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq18.gif"/></alternatives></inline-formula>. For any <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x\in X$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq19.gif"/></alternatives></inline-formula> let <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N-x$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq20.gif"/></alternatives></inline-formula> denote the network obtained from <italic>N</italic> by deleting <italic>x</italic> and its incident edge, and suppressing the resulting degree 2 vertex. If <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N-x$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq21.gif"/></alternatives></inline-formula> is tree-based, then so is <italic>N</italic>.</p></sec><sec id="FPar8"><title>Proof</title><p id="Par25">Suppose <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x\in X$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq22.gif"/></alternatives></inline-formula> and <italic>T</italic> is a support tree for <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N-x$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq23.gif"/></alternatives></inline-formula>. Let <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v\in V(N)$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi>v</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq24.gif"/></alternatives></inline-formula> denote the vertex adjacent with <italic>x</italic> that was suppressed in the construction of <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N-x$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq25.gif"/></alternatives></inline-formula> and let <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e\in E(N-x)$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi>e</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq26.gif"/></alternatives></inline-formula> denote the resulting edge in <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N-x$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq27.gif"/></alternatives></inline-formula>. If <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e\in E(T) $$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>e</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq28.gif"/></alternatives></inline-formula>, then we can obtain a support tree for <italic>N</italic> by subdividing <italic>e</italic> with a new vertex <italic>w</italic> and adding the edge <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{w,x\}$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq29.gif"/></alternatives></inline-formula> to <italic>T</italic>. If <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e\not \in E(T)$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi>e</mml:mi><mml:mo>&#x02209;</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq30.gif"/></alternatives></inline-formula>, then, since <italic>T</italic> is a support tree for <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N-x$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq31.gif"/></alternatives></inline-formula>, <italic>T</italic> must contain both vertices in <italic>e</italic>, say <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_1$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq32.gif"/></alternatives></inline-formula> and <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_2$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq33.gif"/></alternatives></inline-formula>. Therefore, we can obtain a support tree for <italic>N</italic> by adding a new vertex <italic>w</italic> and the edges <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{v_1,w\}$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq34.gif"/></alternatives></inline-formula> and <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{w,x\}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq35.gif"/></alternatives></inline-formula> (or indeed <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{v_2,w\}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq36.gif"/></alternatives></inline-formula> and <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{w,x\}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq37.gif"/></alternatives></inline-formula>) to <italic>T</italic>.</p><p id="Par26">
<inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M76"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq38.gif"/></alternatives></inline-formula>
</p><p>Suppose <italic>N</italic> is a network on <italic>X</italic> and <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\ge 0$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq39.gif"/></alternatives></inline-formula> is an integer. Then <italic>N</italic> is called a <italic>level-k network</italic> if at most <italic>k</italic> edges have to be removed from each blob of <italic>N</italic> to obtain a tree. For example, the network in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> is a level-2 network.</p></sec><sec id="FPar9"><title>Theorem 1</title><p id="Par28">All proper level-4 networks are tree-based. Moreover, networks of level greater than 4 need not be tree-based.</p></sec><sec id="FPar10"><title>Proof</title><p id="Par29">First observe that by definition of level-<italic>k</italic> network, the main claim applies to level-1, 2, 3, and 4 networks.</p><p id="Par30">Note that since <italic>N</italic> is a proper network on <italic>X</italic>, it must contain at least two leaves. Also note that the theorem is straight-forward to check in case <italic>N</italic> is level-0 or level-1.<fig id="Fig2"><label>Fig. 2</label><caption><p>Diagram for proving that simple level-2 and level-3 networks are tree-based used in the proof of Theorem&#x000a0;<xref ref-type="sec" rid="FPar9">1</xref>
</p></caption><graphic xlink:href="11538_2017_381_Fig2_HTML" id="MO2"/></fig>
</p><p id="Par31">In case <italic>N</italic> has level <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2 \le k \le 4$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mn>2</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq40.gif"/></alternatives></inline-formula>, since <italic>N</italic> is proper, by Proposition&#x000a0;<xref ref-type="sec" rid="FPar2">1</xref> it suffices to prove that every simple, level-4 network with two leaves is tree-based. This is because we can decompose <italic>N</italic> into a collection of simple networks <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_N$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq41.gif"/></alternatives></inline-formula> (one for each blob <italic>B</italic> of <italic>N</italic>) each having at least 2 leaves, and if each of these simple networks is tree-based, then so is <italic>N</italic>. Moreover, for each of these simple networks <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_N$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq42.gif"/></alternatives></inline-formula>, if we remove all but 2 leaves from <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_N$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq43.gif"/></alternatives></inline-formula> and obtain a tree-based network, then it is straight-forward to see using Lemma&#x000a0;<xref ref-type="sec" rid="FPar7">3</xref> that <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_N$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi>B</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq44.gif"/></alternatives></inline-formula> must have been tree-based.</p><p id="Par32">Now, to see that any simple, level-4 network with two leaves <italic>x</italic> and <italic>y</italic> is tree-based, we begin with the case <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=2$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq45.gif"/></alternatives></inline-formula>. It is clear that any simple level-2 network on some set <italic>Y</italic> can be obtained by inserting pendant edges in the multigraph at the top of Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>(i) and labelling the leaves by the elements of <italic>Y</italic> (see, e.g. van Iersel and Moulton <xref ref-type="bibr" rid="CR17">2017</xref>, Figure&#x000a0;4). It is now straight-forward to check that, up to isomorphism, the only possible simple level-2 network on <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{x,y\}$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq46.gif"/></alternatives></inline-formula> is isomorphic to the one at the bottom of Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>(i). Clearly, this network is tree-based.</p><p id="Par33">We now consider the case <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=3$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq47.gif"/></alternatives></inline-formula>. As before, it is known that any simple level-3 network on some finite set <italic>Y</italic> can be obtained by inserting a pendant edge into one of the multigraphs in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>(ii) and labelling the leaves by the elements of <italic>Y</italic> (van Iersel and Moulton <xref ref-type="bibr" rid="CR17">2017</xref>, Figure&#x000a0;4). It is now straight-forward to check that the only possible simple level-3 networks on <inline-formula id="IEq48"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{x,y\}$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq48.gif"/></alternatives></inline-formula> are isomorphic to one of the networks in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>(iii), and that each of these is tree-based.</p><p id="Par34">We conclude with the case <inline-formula id="IEq49"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=4$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq49.gif"/></alternatives></inline-formula>. We use the fact that any simple level-4 network with leaf set <italic>Y</italic> can be obtained by inserting pendant edges in one of the five multigraphs in the top row of Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> and labelling the leaves by the elements of Y (see, e.g. van Iersel and Moulton <xref ref-type="bibr" rid="CR17">2017</xref>, Figure&#x000a0;4). Using this fact, it is now straight-forward to check that, up to isomorphism, any simple level-4 network on <inline-formula id="IEq50"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{x, y\}$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq50.gif"/></alternatives></inline-formula> is isomorphic to one of the networks on <inline-formula id="IEq51"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{x, y\}$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq51.gif"/></alternatives></inline-formula> that can be generated from the bottom row of Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> as described in the figure&#x02019;s caption [note that we can exclude the case (i) in the bottom row as it is not possible for this to be made into a simple network with leaf set <inline-formula id="IEq52"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{x, y\}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq52.gif"/></alternatives></inline-formula>]. It is now straight-forward to check that each of these networks on <inline-formula id="IEq53"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{x, y\}$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq53.gif"/></alternatives></inline-formula> is tree-based, which concludes the case <inline-formula id="IEq54"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=4$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq54.gif"/></alternatives></inline-formula>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Diagram for proving that simple level-4 networks are tree-based used in the proof of Theorem&#x000a0;<xref ref-type="sec" rid="FPar9">1</xref>. In the bottom row, each grey vertex corresponds to inserting a pendant edge labelled by <italic>x</italic>, and each circle vertex corresponds to inserting a pendant edge labelled by <italic>y</italic>, so that a network on <inline-formula id="IEq55"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{x,y\}$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq55.gif"/></alternatives></inline-formula> is produced [so, for example, there are 5 possible networks associated to the diagram in the bottom row of column (iii)]</p></caption><graphic xlink:href="11538_2017_381_Fig3_HTML" id="MO3"/></fig>
</p><p id="Par35">We now prove the last statement of the theorem. An example of a level-5 network is presented in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>. This network can be seen to be not tree-based as follows.<fig id="Fig4"><label>Fig. 4</label><caption><p>A level-5 network on <inline-formula id="IEq56"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{x,y\}$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq56.gif"/></alternatives></inline-formula> that is not tree-based (Steel). The labels of the interior vertices are included for proof purposes</p></caption><graphic xlink:href="11538_2017_381_Fig4_HTML" id="MO4"/></fig>
</p><p id="Par36">If it were tree-based, then there would be a path from <italic>x</italic> to <italic>y</italic> passing through every vertex exactly once. If the path began <italic>x</italic>,&#x000a0;<italic>a</italic>,&#x000a0;<italic>b</italic>, or ended <italic>c</italic>,&#x000a0;<italic>d</italic>,&#x000a0;<italic>y</italic>, then it could not pass through <inline-formula id="IEq57"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_1$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq57.gif"/></alternatives></inline-formula> or <inline-formula id="IEq58"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_2$$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq58.gif"/></alternatives></inline-formula> without going through some vertex twice. Therefore, such a path begins <inline-formula id="IEq59"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x,a,v_1$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq59.gif"/></alternatives></inline-formula> and ends <inline-formula id="IEq60"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_2,d,y$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq60.gif"/></alternatives></inline-formula>. The edge <inline-formula id="IEq61"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{v_1,v_2\}$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq61.gif"/></alternatives></inline-formula> cannot be included in such a path, because that completes the path without passing through all vertices, so the path actually must begin <inline-formula id="IEq62"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x,a,v_1,f$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq62.gif"/></alternatives></inline-formula> and end <inline-formula id="IEq63"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e,v_2,d,y$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq63.gif"/></alternatives></inline-formula>. At this point the path cannot include vertices <italic>b</italic>,&#x000a0;<italic>c</italic>,&#x000a0;<italic>h</italic> without passing through <italic>g</italic> twice: a contradiction.</p><p id="Par37">This example demonstrates that not all level-5 networks are tree-based, and since by definition of level, this network is also level-<italic>k</italic> for any <inline-formula id="IEq64"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\ge 5$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq64.gif"/></alternatives></inline-formula>, the result follows. <inline-formula id="IEq65"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M130"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq65.gif"/></alternatives></inline-formula>
</p></sec><sec id="FPar11"><title>Remark 1</title><p id="Par38">The level-5 example used in the proof of Theorem&#x000a0;<xref ref-type="sec" rid="FPar9">1</xref> can be used to show that it is possible to construct networks that are <italic>strictly</italic> level-<italic>k</italic> [in that they are level-<italic>k</italic> and not level-<inline-formula id="IEq66"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(k-1)$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq66.gif"/></alternatives></inline-formula>] and that are not tree-based. Take a network <italic>N</italic> of level-<inline-formula id="IEq67"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\ge 5$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq67.gif"/></alternatives></inline-formula> and choose a pendant edge <inline-formula id="IEq68"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{x,y\}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq68.gif"/></alternatives></inline-formula> in <italic>N</italic>. Replace this edge by the level-5 network shown in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>. The resulting network has unchanged level and is not tree-based.</p></sec></sec><sec id="Sec3"><title>Recognizing Tree-Based Networks</title><p id="Par39">In this section, we consider the complexity of the computational problem of deciding whether or not a given network <italic>N</italic> is tree-based.</p><p id="Par40">We begin with a useful result. Suppose that <italic>C</italic> is a cubic graph. Pick some edge <italic>e</italic> in <italic>C</italic>. Introduce two pendant edges into <italic>e</italic> containing the new degree 1 vertices <italic>x</italic> and <italic>y</italic>. This new graph <inline-formula id="IEq69"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_e(x,y)$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq69.gif"/></alternatives></inline-formula> is a network on <inline-formula id="IEq70"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{x,y\}$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq70.gif"/></alternatives></inline-formula>. We illustrate this construction in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>. The following observation concerning this construction is straight-forward to check.<fig id="Fig5"><label>Fig. 5</label><caption><p>(i) Cubic graph <italic>C</italic> with edge <italic>e</italic> indicated. (ii) The network <inline-formula id="IEq71"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_e(x,y)$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq71.gif"/></alternatives></inline-formula>
</p></caption><graphic xlink:href="11538_2017_381_Fig5_HTML" id="MO5"/></fig>
</p><sec id="FPar12"><title>Lemma 4</title><p id="Par41">Suppose that <italic>C</italic> is a cubic graph. The following statements are equivalent:<list list-type="simple"><list-item><label>(i)</label><p id="Par42">
<italic>C</italic> is Hamiltonian.</p></list-item><list-item><label>(ii)</label><p id="Par43">There is some edge <italic>e</italic> in <italic>C</italic> such that the network <inline-formula id="IEq72"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_e(x,y)$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq72.gif"/></alternatives></inline-formula> is tree-based.</p></list-item><list-item><label>(iii)</label><p id="Par44">There is some edge <italic>e</italic> in <italic>C</italic> such that the network <inline-formula id="IEq73"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_e(x,y)$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq73.gif"/></alternatives></inline-formula> has a support tree consisting of a path with end vertices <italic>x</italic> and <italic>y</italic>.</p></list-item></list>
</p><p>
<fig id="Fig6"><label>Fig. 6</label><caption><p>A simple level-6 network that is not tree-based. Removing the two pendant edges labelled with <italic>x</italic> and <italic>y</italic> and their vertices results in the Petersen graph</p></caption><graphic xlink:href="11538_2017_381_Fig6_HTML" id="MO6"/></fig>
</p><p>Note that using Lemma&#x000a0;<xref ref-type="sec" rid="FPar12">4</xref>, it immediately follows that the network in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> is not tree-based, since if <italic>P</italic> is the Petersen graph (which is not Hamiltonian), then this network is of the form <inline-formula id="IEq74"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_e(x,y)$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq74.gif"/></alternatives></inline-formula> for some edge <italic>e</italic> of <italic>P</italic>.</p><p>We now use the last lemma to prove two NP-completeness results. In our proofs, we shall use the fact that the following problem is NP-complete (Garey et&#x000a0;al. <xref ref-type="bibr" rid="CR5">1976</xref>):</p><p>
<italic>PC3C-Hamiltonian</italic>
</p><p>Instance: Planar, cubic, 3-connected graph <italic>G</italic>.</p><p>Question: Is <italic>G</italic> Hamiltonian?</p><p>We begin by showing that the following problem is NP-complete.</p><p>
<italic>Unrooted tree-based</italic>
</p><p>Instance: Network <italic>N</italic> on <italic>X</italic>.</p><p>Question: Is <italic>N</italic> tree-based?</p></sec><sec id="FPar13"><title>Theorem 2</title><p id="Par55">The problem <italic>Unrooted tree-based</italic> is NP-complete.</p></sec><sec id="FPar14"><title>Proof</title><p id="Par56">First note that <italic>Unrooted tree-based</italic> is in NP since we can check in polynomial time if a given tree in <italic>N</italic> is a spanning tree for <italic>N</italic> with leaf set <italic>X</italic>.</p><p id="Par57">To complete the proof, we show that there is a polynomial-time reduction from <italic>PC3C-Hamiltonian</italic> to <italic>Unrooted tree-based</italic>.</p><p id="Par58">Let <italic>C</italic> be a planar, cubic, 3-connected graph. By Lemma&#x000a0;<xref ref-type="sec" rid="FPar12">4</xref>(ii) it follows that <italic>C</italic> is Hamiltonian if and only if the network <inline-formula id="IEq75"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_e(x,y)$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq75.gif"/></alternatives></inline-formula> on the set <inline-formula id="IEq76"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{x,y\}$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq76.gif"/></alternatives></inline-formula> is tree-based for some edge <italic>e</italic> in <italic>C</italic>. Since the number of edges in <italic>C</italic> is equal to 3|<italic>V</italic>(<italic>C</italic>)|&#x000a0;/&#x000a0;2, it follows that there is a polynomial-time reduction from <italic>PC3C-Hamiltonian</italic> to <italic>Unrooted tree-based</italic> (just check if <inline-formula id="IEq77"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_e(x,y)$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq77.gif"/></alternatives></inline-formula> is tree-based for each edge <italic>e</italic> in <italic>C</italic>; if the answer is no for every <italic>e</italic>, then <italic>C</italic> is not Hamiltonian; otherwise, <italic>C</italic> is Hamiltonian).<inline-formula id="IEq78"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M156"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq78.gif"/></alternatives></inline-formula>
</p><p>Interestingly, the analogous decision problem to <italic>Unrooted tree-based</italic> for rooted phylogenetic networks can be decided in polynomial time (Francis and Steel <xref ref-type="bibr" rid="CR2">2015</xref>).</p><p>We now prove that a related decision problem is NP-complete. We say that a phylogenetic tree <italic>T</italic> on <italic>X</italic> is <italic>displayed</italic> by a network <italic>N</italic> on <italic>X</italic> if <italic>T</italic> can be obtained from a subtree <inline-formula id="IEq79"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M158"><mml:msup><mml:mi>T</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq79.gif"/></alternatives></inline-formula> of <italic>N</italic> by suppressing all degree 2 vertices in <inline-formula id="IEq80"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M160"><mml:msup><mml:mi>T</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq80.gif"/></alternatives></inline-formula> (van Iersel et&#x000a0;al. <xref ref-type="bibr" rid="CR18">2017</xref>). In addition, we say that <italic>T is a base-tree of N</italic> or <italic>N is based on T</italic> if <italic>T</italic> can be obtained in this way from a support tree <inline-formula id="IEq81"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M162"><mml:msup><mml:mi>T</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq81.gif"/></alternatives></inline-formula> of <italic>N</italic>. Note that a phylogenetic tree may be displayed by a network but need not be a support tree for the network. For example, the phylogenetic tree consisting of an edge with leaves <italic>x</italic>,&#x000a0;<italic>y</italic> is displayed by the network in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref> (e.g. consider the path of length 3 in the network between <italic>x</italic> and <italic>y</italic>), but it is not a support tree for that network.</p><p>We now consider the following decision problem.</p><p>
<italic>Unrooted base-tree containment</italic>
</p><p>Instance: Network <italic>N</italic> on <italic>X</italic> and a phylogenetic tree <italic>T</italic> on <italic>X</italic>.</p><p>Question: Is <italic>N</italic> based on <italic>T</italic>?</p><p>Note that the analogous version of this decision problem for rooted phylogenetic networks is NP-complete (Anaya et&#x000a0;al. <xref ref-type="bibr" rid="CR1">2016</xref>). We now show that this is also the case for networks.</p></sec><sec id="FPar15"><title>Theorem 3</title><p id="Par66">The problem <italic>Unrooted base-tree containment</italic> is NP-complete.</p></sec><sec id="FPar16"><title>Proof</title><p id="Par67">First note that <italic>Unrooted base-tree containment</italic> is in NP since we can check in polynomial time if a subtree <inline-formula id="IEq82"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M164"><mml:msup><mml:mi>T</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq82.gif"/></alternatives></inline-formula> of <italic>N</italic> is a support tree of <italic>N</italic>, and that a given phylogenetic tree <italic>T</italic> can be obtained from <inline-formula id="IEq83"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M166"><mml:msup><mml:mi>T</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq83.gif"/></alternatives></inline-formula> by suppressing all degree 2 vertices in <inline-formula id="IEq84"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M168"><mml:msup><mml:mi>T</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq84.gif"/></alternatives></inline-formula>.</p><p id="Par68">To complete the proof, we show that there is a polynomial-time reduction from <italic>PC3C-Hamiltonian</italic> to <italic>Unrooted base-tree containment</italic>.</p><p id="Par69">Let <italic>C</italic> be a planar, cubic, 3-connected graph. By Lemma&#x000a0;<xref ref-type="sec" rid="FPar12">4</xref>(iii) it follows that <italic>C</italic> is Hamiltonian if and only if there is some edge <italic>e</italic> in <italic>C</italic> such that the network <inline-formula id="IEq85"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_e(x,y)$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq85.gif"/></alternatives></inline-formula> has a support tree consisting of a path with end vertices <italic>x</italic> and <italic>y</italic> which, in turn, holds if and only if the phylogenetic tree <italic>T</italic> consisting of a single edge and leaf set <inline-formula id="IEq86"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X=\{x,y\}$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq86.gif"/></alternatives></inline-formula> is a base-tree for the network <inline-formula id="IEq87"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_e(x,y)$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq87.gif"/></alternatives></inline-formula> for some edge <italic>e</italic> in <italic>C</italic>. Since the number of edges in <italic>C</italic> is equal to 3|<italic>V</italic>(<italic>C</italic>)|&#x000a0;/&#x000a0;2, it follows that there is a polynomial-time reduction from <italic>PC3C-Hamiltonian</italic> to <italic>Unrooted base-tree containment</italic> (just check if the single-edged phylogenetic tree <italic>T</italic> on <inline-formula id="IEq88"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{x,y\}$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq88.gif"/></alternatives></inline-formula> is a base-tree for the network <inline-formula id="IEq89"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_e(x,y)$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq89.gif"/></alternatives></inline-formula> for each edge <italic>e</italic> in <italic>C</italic>; if the answer is no for every <italic>e</italic>, then <italic>C</italic> is not Hamiltonian; otherwise, <italic>C</italic> is Hamiltonian).<inline-formula id="IEq90"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M180"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq90.gif"/></alternatives></inline-formula>
</p><p>Note that it is also NP-complete to decide whether or not a network <italic>N</italic> displays a phylogenetic tree <italic>T</italic> (van Iersel et&#x000a0;al. <xref ref-type="bibr" rid="CR18">2017</xref>).</p></sec></sec><sec id="Sec4"><title>Universal Tree-Based Networks</title><p id="Par71">In this section, we shall show that there are networks on <italic>X</italic> which can have <italic>every</italic> phylogenetic tree on <italic>X</italic> as a base-tree. To prove this, we will relate networks with rooted phylogenetic networks, which we now formally define.</p><p id="Par72">A <italic>rooted</italic> phylogenetic network <italic>M</italic> (on <italic>X</italic>) is a directed acyclic graph with a single root (vertex with indegree 0 and outdegree 2), leaf set <italic>X</italic> (vertices with indegree 1 and outdegree 0), and all vertices except the root having degree 1 or 3. If <italic>M</italic> is a tree, then it is called a <italic>rooted</italic> phylogenetic tree on <italic>X</italic>. A rooted phylogenetic network <italic>M</italic> is called <italic>tree-based</italic> if it contains a directed spanning tree (an &#x0201c;arborescence&#x0201d;) <italic>T</italic> such that the leaf set of <italic>T</italic> is <italic>X</italic>. In that case, <italic>T</italic> is called a <italic>support tree</italic> for <italic>M</italic>.</p><p id="Par73">In Hayamizu (<xref ref-type="bibr" rid="CR7">2016</xref>) it is shown that for every <italic>X</italic> there exists a &#x0201c;universal&#x0201d; rooted phylogenetic network <italic>M</italic> on <italic>X</italic>, that is, <italic>M</italic> is a tree-based, rooted phylogenetic network and has every possible rooted phylogenetic tree on <italic>X</italic> as a base-tree. We shall use this result to show that there are also universal networks. First, we present a relationship between tree-based networks and rooted phylogenetic networks (cf. also Gambette et&#x000a0;al. <xref ref-type="bibr" rid="CR4">2012</xref>,&#x000a0;Section&#x000a0;3 for related results).</p><p id="Par74">Given a network <italic>N</italic> on <italic>X</italic> with <inline-formula id="IEq91"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X|\ge 2$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02265;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq91.gif"/></alternatives></inline-formula>, a leaf <inline-formula id="IEq92"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in X$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq92.gif"/></alternatives></inline-formula>, and some orientation <italic>o</italic> of the edges of <italic>N</italic>, we let <inline-formula id="IEq93"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_o^x$$\end{document}</tex-math><mml:math id="M186"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>x</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq93.gif"/></alternatives></inline-formula> denote the directed graph which results by removing <italic>x</italic> and its pendant edge from <italic>N</italic> with edges oriented according to <italic>o</italic>.</p><sec id="FPar17"><title>Theorem 4</title><p id="Par75">Suppose that <italic>N</italic> is a network on <italic>X</italic> and <inline-formula id="IEq94"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x\in X$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq94.gif"/></alternatives></inline-formula>. Then <italic>N</italic> is tree-based if and only if there exists some orientation <italic>o</italic> of the edges of <italic>N</italic> making <inline-formula id="IEq95"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_o^x$$\end{document}</tex-math><mml:math id="M190"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>x</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq95.gif"/></alternatives></inline-formula> a tree-based (rooted) network on <inline-formula id="IEq96"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X-\{x\}$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq96.gif"/></alternatives></inline-formula>.</p></sec><sec id="FPar18"><title>Proof</title><p id="Par76">Suppose <italic>o</italic> is an orientation of the edges of <italic>N</italic> such that <inline-formula id="IEq97"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_o^x$$\end{document}</tex-math><mml:math id="M194"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>x</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq97.gif"/></alternatives></inline-formula> is a tree-based, rooted network on <inline-formula id="IEq98"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X-\{x\}$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq98.gif"/></alternatives></inline-formula>. Pick some base-tree <italic>T</italic> in <inline-formula id="IEq99"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_o^x$$\end{document}</tex-math><mml:math id="M198"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>x</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq99.gif"/></alternatives></inline-formula>. Let <inline-formula id="IEq100"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_x$$\end{document}</tex-math><mml:math id="M200"><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq100.gif"/></alternatives></inline-formula> denote the vertex in <italic>N</italic> that is adjacent with <italic>x</italic> and let <inline-formula id="IEq101"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_1\in V(N)$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq101.gif"/></alternatives></inline-formula> denote one of the two other vertices in <italic>N</italic> adjacent with <inline-formula id="IEq102"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_x$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq102.gif"/></alternatives></inline-formula>. Then <inline-formula id="IEq103"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_1\in V(T)$$\end{document}</tex-math><mml:math id="M206"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq103.gif"/></alternatives></inline-formula>. Let <inline-formula id="IEq104"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M208"><mml:msup><mml:mi>T</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq104.gif"/></alternatives></inline-formula> be the tree obtained from <italic>T</italic> by first adding <italic>x</italic> to its leaf set, <inline-formula id="IEq105"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_x$$\end{document}</tex-math><mml:math id="M210"><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq105.gif"/></alternatives></inline-formula> to its vertex set, and <inline-formula id="IEq106"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{v_x,x\}$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq106.gif"/></alternatives></inline-formula> and <inline-formula id="IEq107"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{v_1,v_x\}$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq107.gif"/></alternatives></inline-formula> to its edge set and then ignoring the directions of the edges of <italic>T</italic>. Since <italic>T</italic> is a spanning tree of <inline-formula id="IEq108"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_o^x$$\end{document}</tex-math><mml:math id="M216"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>x</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq108.gif"/></alternatives></inline-formula> with leaf set <inline-formula id="IEq109"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X-\{x\}$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq109.gif"/></alternatives></inline-formula>, we clearly have that <inline-formula id="IEq110"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M220"><mml:msup><mml:mi>T</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq110.gif"/></alternatives></inline-formula> is a spanning tree for <italic>N</italic> with leaf set <italic>X</italic>. Thus, <italic>N</italic> is tree-based.</p><p id="Par77">Conversely, suppose that <italic>N</italic> is tree-based. Pick some support tree <italic>T</italic> in <italic>N</italic> and orient all edges in <italic>T</italic> away from <italic>x</italic>. Let <inline-formula id="IEq111"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x,v_1,v_2,\dots ,v_m$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq111.gif"/></alternatives></inline-formula> be some topological ordering of the vertices in <italic>T</italic> (i.&#x000a0;e.&#x000a0; an ordering that is consistent with the partial ordering induced by <italic>T</italic>). For each vertex <italic>v</italic> in <italic>T</italic> that is the end vertex of some edge in <italic>N</italic> not in <italic>T</italic>, starting with a vertex that comes earliest in the ordering, direct the edge away from <italic>v</italic>, and if such an edge is encountered that has already been directed, then ignore this. This choice <italic>o</italic> of orientations of the edges of <italic>N</italic> implies that <inline-formula id="IEq112"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_o^x$$\end{document}</tex-math><mml:math id="M224"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>x</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq112.gif"/></alternatives></inline-formula> is a rooted phylogenetic network on <inline-formula id="IEq113"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X-\{x\}$$\end{document}</tex-math><mml:math id="M226"><mml:mrow><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq113.gif"/></alternatives></inline-formula> (since it has no directed cycles) with support tree <inline-formula id="IEq114"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{o'}^x$$\end{document}</tex-math><mml:math id="M228"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:msup><mml:mi>o</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mi>x</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq114.gif"/></alternatives></inline-formula> where <inline-formula id="IEq115"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o'$$\end{document}</tex-math><mml:math id="M230"><mml:msup><mml:mi>o</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq115.gif"/></alternatives></inline-formula> is the orientation of the edges induced by <italic>o</italic>.<inline-formula id="IEq116"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M232"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq116.gif"/></alternatives></inline-formula>
</p></sec><sec id="FPar19"><title>Corollary 1</title><p id="Par78">There exists a tree-based network <italic>N</italic> on <italic>X</italic> such that every phylogenetic tree <italic>T</italic> on <italic>X</italic> is a base-tree for <italic>N</italic>.</p></sec><sec id="FPar20"><title>Proof</title><p id="Par79">The cases <inline-formula id="IEq117"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X|=1$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq117.gif"/></alternatives></inline-formula> and <inline-formula id="IEq118"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X|=2$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq118.gif"/></alternatives></inline-formula> are obvious. Assume <inline-formula id="IEq119"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X|\ge 3$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02265;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq119.gif"/></alternatives></inline-formula>. Let <inline-formula id="IEq120"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in X$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq120.gif"/></alternatives></inline-formula> and set <inline-formula id="IEq121"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y =X -\{x\}$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq121.gif"/></alternatives></inline-formula>. Let <italic>M</italic> be a universal rooted network on <italic>Y</italic> (see Hayamizu <xref ref-type="bibr" rid="CR7">2016</xref> for details). Let <inline-formula id="IEq122"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho $$\end{document}</tex-math><mml:math id="M244"><mml:mi mathvariant="italic">&#x003c1;</mml:mi></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq122.gif"/></alternatives></inline-formula> denote the root of <italic>M</italic>. Let <italic>N</italic> be the network on <italic>X</italic> obtained by adding <italic>x</italic> to the leaf set of <italic>M</italic>, a new vertex <italic>r</italic> to the vertex set of <italic>N</italic>, new edges <inline-formula id="IEq123"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{r,x\}$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq123.gif"/></alternatives></inline-formula> and <inline-formula id="IEq124"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{r,\rho \}$$\end{document}</tex-math><mml:math id="M248"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">&#x003c1;</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq124.gif"/></alternatives></inline-formula> to <italic>M</italic>, and ignoring the orientations of all edges of <italic>M</italic>. Clearly, <italic>N</italic> is a network on <italic>X</italic> and <italic>M</italic> and <inline-formula id="IEq125"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_o^x$$\end{document}</tex-math><mml:math id="M250"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>x</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq125.gif"/></alternatives></inline-formula> are isomorphic where <italic>o</italic> is the orientation of the edges of <italic>M</italic>. By Theorem&#x000a0;<xref ref-type="sec" rid="FPar17">4</xref>, <italic>N</italic> is tree-based. Moreover, if <italic>T</italic> is any rooted phylogenetic tree on <italic>Y</italic>, then <italic>T</italic> is a base-tree for <italic>M</italic> because <italic>M</italic> is a universal network on <italic>Y</italic>. Hence, the tree <inline-formula id="IEq126"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_x$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mi>T</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq126.gif"/></alternatives></inline-formula> obtained by adjoining the element <italic>x</italic> as a leaf to the root of <italic>T</italic> is a phylogenetic tree on <italic>X</italic> and ignoring its edge orientations renders it a base-tree for <italic>N</italic>. But it is straight-forward to check that the set<disp-formula id="Equ1"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \{ T_x \,:\, x\in X \text{ and } T \text{ a } \text{ rooted } \text{ phylogenetic } \text{ tree } \text{ on } X-\{x\} \} \end{aligned}$$\end{document}</tex-math><mml:math id="M254" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mo>:</mml:mo><mml:mspace width="0.166667em"/><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>X</mml:mi><mml:mspace width="0.333333em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>T</mml:mi><mml:mspace width="0.333333em"/><mml:mtext>a</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.333333em"/><mml:mtext>rooted</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.333333em"/><mml:mtext>phylogenetic</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.333333em"/><mml:mtext>tree</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.333333em"/><mml:mtext>on</mml:mtext><mml:mspace width="0.333333em"/><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2017_381_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>is equal to the set of phylogenetic trees on <italic>X</italic>. The corollary follows immediately.<inline-formula id="IEq127"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M256"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq127.gif"/></alternatives></inline-formula>
</p></sec></sec><sec id="Sec5"><title>Fully Tree-Based Networks</title><p id="Par80">In Semple (<xref ref-type="bibr" rid="CR14">2016</xref>) a characterization of rooted phylogenetic networks in which every embedded phylogenetic tree with the same leaf set is a base-tree is given (these are precisely the &#x0201c;tree-child&#x0201d; networks). In our last result, we will characterize networks that have an analogous property.</p><p id="Par81">Note that a network <italic>N</italic> on <italic>X</italic> always contains a subtree with the same leaf set as <italic>N</italic>. For example, if we fix some <inline-formula id="IEq128"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in X$$\end{document}</tex-math><mml:math id="M258"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq128.gif"/></alternatives></inline-formula> and let <inline-formula id="IEq129"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{xy}$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq129.gif"/></alternatives></inline-formula> be some path in <italic>N</italic> for all <inline-formula id="IEq130"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y \in X -\{x\}$$\end{document}</tex-math><mml:math id="M262"><mml:mrow><mml:mi>y</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq130.gif"/></alternatives></inline-formula>, then the tree obtained by removing (if necessary) a minimum number of edges from the union of the paths <inline-formula id="IEq131"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{xy}$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">xy</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq131.gif"/></alternatives></inline-formula> over all <inline-formula id="IEq132"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y \in X-\{x\}$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mi>y</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq132.gif"/></alternatives></inline-formula> is a subtree of <italic>N</italic> with leaf set <italic>X</italic>.</p><p id="Par82">We call a network <italic>N</italic> on <italic>X</italic>
<italic>fully tree-based</italic> if every subtree of <italic>N</italic> with leaf set <italic>X</italic> is a support tree for <italic>N</italic>. Note that by the previous remark, any fully tree-based network is tree-based.</p><sec id="FPar21"><title>Lemma 5</title><p id="Par83">Suppose that <italic>N</italic> is a simple, tree-based network and that <italic>T</italic> is a base-tree for <italic>N</italic>. If <inline-formula id="IEq133"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e=\{v_1,v\},e'=\{v,v_2\}$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq133.gif"/></alternatives></inline-formula> are incident edges in <italic>T</italic> such that neither <italic>e</italic> nor <inline-formula id="IEq134"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e'$$\end{document}</tex-math><mml:math id="M270"><mml:msup><mml:mi>e</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq134.gif"/></alternatives></inline-formula> are pendant edges of <italic>T</italic>, and <inline-formula id="IEq135"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_e$$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mi>T</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq135.gif"/></alternatives></inline-formula> and <inline-formula id="IEq136"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{e'}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mi>T</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq136.gif"/></alternatives></inline-formula> are the trees which are obtained by deleting <italic>e</italic> and <inline-formula id="IEq137"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e'$$\end{document}</tex-math><mml:math id="M276"><mml:msup><mml:mi>e</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq137.gif"/></alternatives></inline-formula>, respectively, that do not contain <italic>v</italic>, then there must exist some edge <inline-formula id="IEq138"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e''$$\end{document}</tex-math><mml:math id="M278"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq138.gif"/></alternatives></inline-formula> in <italic>N</italic> which has one vertex in <inline-formula id="IEq139"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_e$$\end{document}</tex-math><mml:math id="M280"><mml:msub><mml:mi>T</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq139.gif"/></alternatives></inline-formula> and the other in <inline-formula id="IEq140"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{e'}$$\end{document}</tex-math><mml:math id="M282"><mml:msub><mml:mi>T</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq140.gif"/></alternatives></inline-formula>.</p></sec><sec id="FPar22"><title>Proof</title><p id="Par84">Suppose that there is no edge <inline-formula id="IEq141"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e''$$\end{document}</tex-math><mml:math id="M284"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq141.gif"/></alternatives></inline-formula> with the stated properties. Then there exists only one path in <italic>N</italic> between <inline-formula id="IEq142"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_1$$\end{document}</tex-math><mml:math id="M286"><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq142.gif"/></alternatives></inline-formula> and <inline-formula id="IEq143"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_2$$\end{document}</tex-math><mml:math id="M288"><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq143.gif"/></alternatives></inline-formula>. But this contradicts the fact that <italic>N</italic> is simple, and therefore the graph <italic>N</italic> with all pendant edges removed is 2-connected.<inline-formula id="IEq144"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M290"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq144.gif"/></alternatives></inline-formula>
</p></sec><sec id="FPar23"><title>Lemma 6</title><p id="Par85">Suppose that <italic>N</italic> is a simple, level-<italic>k</italic> network, <inline-formula id="IEq145"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\ge 1$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq145.gif"/></alternatives></inline-formula>, on <italic>X</italic>, <inline-formula id="IEq146"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X| \ge 2$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02265;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq146.gif"/></alternatives></inline-formula>. Then <italic>N</italic> contains a vertex which is not contained in a pendant edge of <italic>N</italic> if and only if <inline-formula id="IEq147"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \ne 1$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq147.gif"/></alternatives></inline-formula>.</p></sec><sec id="FPar24"><title>Proof</title><p id="Par86">Since <italic>N</italic> is simple, <inline-formula id="IEq148"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|V(N)|=2(|X|-1+k)$$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq148.gif"/></alternatives></inline-formula> (cf., e.g. Huber et&#x000a0;al. <xref ref-type="bibr" rid="CR8">2016</xref>). Now, let <italic>q</italic> be the number of vertices in <italic>N</italic> which are not contained in any pendant edge of <italic>N</italic>. Then clearly<disp-formula id="Equ2"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} |V(N)|= 2|X|+ q. \end{aligned}$$\end{document}</tex-math><mml:math id="M300" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2017_381_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>Therefore, <inline-formula id="IEq149"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q=2k-2$$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq149.gif"/></alternatives></inline-formula>. The lemma now follows immediately.<inline-formula id="IEq150"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M304"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq150.gif"/></alternatives></inline-formula>
</p><p>We now characterize fully tree-based networks. Note that these are significantly less complex than the tree-child networks mentioned above.</p></sec><sec id="FPar25"><title>Theorem 5</title><p id="Par88">Suppose that <italic>N</italic> is a network on <italic>X</italic>. Then <italic>N</italic> is fully tree-based if and only if <italic>N</italic> is a level-1 network.</p></sec><sec id="FPar26"><title>Proof</title><p id="Par89">The statement is clearly true if <inline-formula id="IEq151"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X|=1$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq151.gif"/></alternatives></inline-formula>. So we assume from now on that <inline-formula id="IEq152"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|X|\ge 2$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02265;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq152.gif"/></alternatives></inline-formula>.</p><p id="Par90">By Proposition&#x000a0;<xref ref-type="sec" rid="FPar2">1</xref>, it suffices to assume that <italic>N</italic> is simple.</p><p id="Par91">If <italic>N</italic> is a simple, level-1 network, then it is straight-forward to check that it is fully tree-based.</p><p id="Par92">Conversely, suppose for contradiction that <italic>N</italic> is a simple network on <italic>X</italic> which is not level-1, and that <italic>N</italic> is fully tree-based. Let <italic>T</italic> be a support tree for <italic>N</italic>.</p><p id="Par93">Suppose that <italic>v</italic> is a vertex in <italic>T</italic> that is not contained in some pendant edge of <italic>N</italic>. Note that such a vertex exists by Lemma&#x000a0;<xref ref-type="sec" rid="FPar23">6</xref> since <italic>N</italic> is not level-1.</p><p id="Par94">If the degree of <italic>v</italic> in <italic>T</italic> is 2, then let <inline-formula id="IEq153"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e=\{v_1,v\},e'=\{v,v_2\}$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq153.gif"/></alternatives></inline-formula> denote its incident edges neither of which can be a pendant edge in <italic>N</italic>. Then, by Lemma&#x000a0;<xref ref-type="sec" rid="FPar21">5</xref>, we can remove edges <inline-formula id="IEq154"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e,e'$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq154.gif"/></alternatives></inline-formula> from <italic>T</italic> and add in an edge <inline-formula id="IEq155"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e'' \in E(N)$$\end{document}</tex-math><mml:math id="M314"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq155.gif"/></alternatives></inline-formula> in between a vertex of <inline-formula id="IEq156"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_e$$\end{document}</tex-math><mml:math id="M316"><mml:msub><mml:mi>T</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq156.gif"/></alternatives></inline-formula> and a vertex of <inline-formula id="IEq157"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{e'}$$\end{document}</tex-math><mml:math id="M318"><mml:msub><mml:mi>T</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq157.gif"/></alternatives></inline-formula> where <inline-formula id="IEq158"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_e$$\end{document}</tex-math><mml:math id="M320"><mml:msub><mml:mi>T</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq158.gif"/></alternatives></inline-formula> and <inline-formula id="IEq159"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{e'}$$\end{document}</tex-math><mml:math id="M322"><mml:msub><mml:mi>T</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq159.gif"/></alternatives></inline-formula> are as in the proof of that lemma. Since the degree of <italic>v</italic> in <italic>T</italic> is 2, the resulting tree <inline-formula id="IEq160"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M324"><mml:msup><mml:mi>T</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq160.gif"/></alternatives></inline-formula> has leaf set <italic>X</italic>. Moreover <inline-formula id="IEq161"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M326"><mml:msup><mml:mi>T</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq161.gif"/></alternatives></inline-formula> does not contain the vertex <italic>v</italic>. But this contradicts the fact that <italic>N</italic> is fully tree-based.</p><p id="Par95">If the degree of <italic>v</italic> in <italic>T</italic> is 3, then let <inline-formula id="IEq162"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e=\{v_1,v\},e'=\{v,v_2\}$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq162.gif"/></alternatives></inline-formula> be two edges incident with <italic>v</italic>. Then by Lemma&#x000a0;<xref ref-type="sec" rid="FPar21">5</xref>, there is an edge <inline-formula id="IEq163"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e''$$\end{document}</tex-math><mml:math id="M330"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq163.gif"/></alternatives></inline-formula> between a vertex of <inline-formula id="IEq164"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_e$$\end{document}</tex-math><mml:math id="M332"><mml:msub><mml:mi>T</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq164.gif"/></alternatives></inline-formula> and a vertex of <inline-formula id="IEq165"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{e'}$$\end{document}</tex-math><mml:math id="M334"><mml:msub><mml:mi>T</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq165.gif"/></alternatives></inline-formula>. Now, if we remove <italic>e</italic> from <italic>T</italic> and add in edge <inline-formula id="IEq166"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e''$$\end{document}</tex-math><mml:math id="M336"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq166.gif"/></alternatives></inline-formula>, we obtain a new tree <inline-formula id="IEq167"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M338"><mml:msup><mml:mi>T</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq167.gif"/></alternatives></inline-formula> that is a support tree for <italic>N</italic> and which contains a vertex (namely <italic>v</italic>) with degree 2, such that neither of the edges in <inline-formula id="IEq168"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M340"><mml:msup><mml:mi>T</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq168.gif"/></alternatives></inline-formula> incident with <italic>v</italic> is a pendant edge of <inline-formula id="IEq169"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M342"><mml:msup><mml:mi>T</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq169.gif"/></alternatives></inline-formula>. But this is impossible by the argument presented above.<inline-formula id="IEq170"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M344"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2017_381_Article_IEq170.gif"/></alternatives></inline-formula>
</p></sec></sec><sec id="Sec6"><title>Final Remarks</title><p id="Par96">We have proven various results concerning tree-based networks and shown that they have somewhat different properties as compared with rooted tree-based networks.</p><p id="Par97">The structure of rooted tree-based networks is very well understood see, e.g. Francis et&#x000a0;al. (<xref ref-type="bibr" rid="CR3">2018</xref>) and Zhang (<xref ref-type="bibr" rid="CR19">2016</xref>). It would be interesting to know if related structural results can be proven for tree-based networks. In addition, results have recently appeared concerning the structure of non-binary rooted, tree-based networks (Jetten and van Iersel <xref ref-type="bibr" rid="CR10">2016</xref>) (networks in which internal vertices do not necessarily have degree 3). It would therefore also be of interest to consider properties of non-binary tree-based networks.</p></sec></body><back><fn-group><fn id="Fn1"><label>1</label><p id="Par5">Recall, a <italic>spanning tree</italic> of a graph <italic>G</italic> is a connected subgraph of <italic>G</italic> containing all vertices of <italic>G</italic> and a minimal subset of the edges.</p></fn><fn><p><bold>Change history</bold></p><p>11/16/2018</p><p>The level-5 example of a network presented in Fig.&#x000a0;4 of Francis et al. (2018) <italic>is</italic> tree-based even though it states in the caption and in the text that this is not the case.</p></fn><fn><p><bold>Change history</bold></p><p>11/16/2018</p><p>The level-5 example of a network presented in Fig.?4 of Francis et al. (2018) <italic>is</italic> tree-based even though it states in the caption and in the text that this is not the case.</p></fn><fn><p><bold>Change history</bold></p><p>11/16/2018</p><p>The level-5 example of a network presented in Fig.&#x0fffd;&#x0fffd;4 of Francis et al. (2018) <italic>is</italic> tree-based even though it states in the caption and in the text that this is not the case.</p></fn></fn-group><ack><title>Acknowledgements</title><p>The authors thank Mike Steel for providing the level-5 network which is not tree-based pictured in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>. They also thank the anonymous referee for his/her helpful comments. All authors thank the Royal Society for its support. KTH and VM thank the London Mathematical Society for its support and also the Centre for Research in Mathematics at Western Sydney University, Australia, where this work was first discussed.</p></ack><ref-list id="Bib1"><title>References</title><ref id="CR1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anaya</surname><given-names>M</given-names></name><etal/></person-group><article-title>On determining if tree-based networks contain fixed trees</article-title><source>Bull Math Biol</source><year>2016</year><volume>78</volume><issue>5</issue><fpage>961</fpage><lpage>969</lpage><pub-id pub-id-type="doi">10.1007/s11538-016-0169-x</pub-id><pub-id pub-id-type="pmid">27125655</pub-id></element-citation></ref><ref id="CR2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Francis</surname><given-names>A</given-names></name><name><surname>Steel</surname><given-names>M</given-names></name></person-group><article-title>Which phylogenetic networks are merely trees with additional arcs?</article-title><source>Syst Biol</source><year>2015</year><volume>64</volume><issue>5</issue><fpage>768</fpage><lpage>777</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syv037</pub-id><pub-id pub-id-type="pmid">26070685</pub-id></element-citation></ref><ref id="CR3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Francis</surname><given-names>A</given-names></name><name><surname>Semple</surname><given-names>C</given-names></name><name><surname>Steel</surname><given-names>M</given-names></name></person-group><article-title>New characterisations of tree-based networks and proximity measures</article-title><source>Adv Appl Math</source><year>2018</year><volume>93</volume><fpage>93</fpage><lpage>107</lpage><pub-id pub-id-type="doi">10.1016/j.aam.2017.08.003</pub-id></element-citation></ref><ref id="CR4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gambette</surname><given-names>P</given-names></name><name><surname>Berry</surname><given-names>V</given-names></name><name><surname>Paul</surname><given-names>C</given-names></name></person-group><article-title>Quartets and unrooted phylogenetic networks</article-title><source>J Bioinform Comput Biol</source><year>2012</year><volume>10</volume><issue>4</issue><fpage>1250004</fpage><pub-id pub-id-type="doi">10.1142/S0219720012500047</pub-id><pub-id pub-id-type="pmid">22809417</pub-id></element-citation></ref><ref id="CR5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garey</surname><given-names>M</given-names></name><name><surname>Johnson</surname><given-names>D</given-names></name><name><surname>Tarjan</surname><given-names>R</given-names></name></person-group><article-title>The planar Hamiltonian circuit problem is NP-complete</article-title><source>SIAM J Comput</source><year>1976</year><volume>5</volume><issue>4</issue><fpage>704</fpage><lpage>714</lpage><pub-id pub-id-type="doi">10.1137/0205049</pub-id></element-citation></ref><ref id="CR6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gyles</surname><given-names>C</given-names></name><name><surname>Boerlin</surname><given-names>P</given-names></name></person-group><article-title>Horizontally transferred genetic elements and their role in pathogenesis of bacterial disease</article-title><source>Vet Pathol</source><year>2014</year><volume>51</volume><issue>2</issue><fpage>328</fpage><lpage>340</lpage><pub-id pub-id-type="doi">10.1177/0300985813511131</pub-id><pub-id pub-id-type="pmid">24318976</pub-id></element-citation></ref><ref id="CR7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hayamizu</surname><given-names>M</given-names></name></person-group><article-title>On the existence of infinitely many universal tree-based networks</article-title><source>J Theor Biol</source><year>2016</year><volume>396</volume><fpage>204</fpage><lpage>206</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2016.02.023</pub-id><pub-id pub-id-type="pmid">26921465</pub-id></element-citation></ref><ref id="CR8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huber</surname><given-names>KT</given-names></name><name><surname>Moulton</surname><given-names>V</given-names></name><name><surname>Wu</surname><given-names>T</given-names></name></person-group><article-title>Transforming phylogenetic networks: moving beyond tree space</article-title><source>J Theor Biol</source><year>2016</year><volume>404</volume><fpage>30</fpage><lpage>39</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2016.05.030</pub-id><pub-id pub-id-type="pmid">27224010</pub-id></element-citation></ref><ref id="CR9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huson</surname><given-names>D</given-names></name><name><surname>Bryant</surname><given-names>D</given-names></name></person-group><article-title>Application of phylogenetic networks in evolutionary studies</article-title><source>Mol Biol Evol</source><year>2006</year><volume>23</volume><fpage>254</fpage><lpage>267</lpage><pub-id pub-id-type="doi">10.1093/molbev/msj030</pub-id><pub-id pub-id-type="pmid">16221896</pub-id></element-citation></ref><ref id="CR10"><mixed-citation publication-type="other">Jetten L, van Iersel L (2016) Nonbinary tree-based phylogenetic networks. IEEE/ACM Trans Comput Biol Bioinform (<bold>in press</bold>). arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1601.04974">arXiv:1601.04974</ext-link></mixed-citation></ref><ref id="CR11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Legendre</surname><given-names>P</given-names></name><name><surname>Makarenkov</surname><given-names>V</given-names></name></person-group><article-title>Reconstruction of biogeographic and evolutionary networks using reticulograms</article-title><source>Syst Biol</source><year>2002</year><volume>51</volume><fpage>199</fpage><lpage>216</lpage><pub-id pub-id-type="doi">10.1080/10635150252899725</pub-id><pub-id pub-id-type="pmid">12028728</pub-id></element-citation></ref><ref id="CR12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Makarenkov</surname><given-names>V</given-names></name></person-group><article-title>T-REX: reconstructing and visualizing phylogenetic trees and reticulation networks</article-title><source>Bioinformatics</source><year>2001</year><volume>17</volume><fpage>664</fpage><lpage>668</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/17.7.664</pub-id><pub-id pub-id-type="pmid">11448889</pub-id></element-citation></ref><ref id="CR13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rivera</surname><given-names>M</given-names></name><name><surname>Lake</surname><given-names>J</given-names></name></person-group><article-title>The ring of life provides evidence for a genome fusion origin of eukaryotes</article-title><source>Nature</source><year>2004</year><volume>431</volume><fpage>152</fpage><lpage>155</lpage><pub-id pub-id-type="doi">10.1038/nature02848</pub-id><pub-id pub-id-type="pmid">15356622</pub-id></element-citation></ref><ref id="CR14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Semple</surname><given-names>C</given-names></name></person-group><article-title>Phylogenetic networks with every embedded phylogenetic tree a base tree</article-title><source>Bull Math Biol</source><year>2016</year><volume>78</volume><fpage>132</fpage><lpage>137</lpage><pub-id pub-id-type="doi">10.1007/s11538-015-0132-2</pub-id><pub-id pub-id-type="pmid">26670315</pub-id></element-citation></ref><ref id="CR15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Semple</surname><given-names>C</given-names></name><name><surname>Steel</surname><given-names>M</given-names></name></person-group><article-title>Unicyclic networks: compatibility and enumeration</article-title><source>IEEE/ACM Trans Comput Biol Bioinform</source><year>2006</year><volume>3</volume><fpage>84</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1109/TCBB.2006.14</pub-id><pub-id pub-id-type="pmid">17048395</pub-id></element-citation></ref><ref id="CR16"><mixed-citation publication-type="other">Steel M, Personal communication</mixed-citation></ref><ref id="CR17"><mixed-citation publication-type="other">van Iersel L, Moulton V (2017) Leaf-reconstructibility of phylogenetic networks. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1701.08982">arXiv:1701.08982</ext-link></mixed-citation></ref><ref id="CR18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Iersel</surname><given-names>Leo</given-names></name><name><surname>Kelk</surname><given-names>Steven</given-names></name><name><surname>Stamoulis</surname><given-names>Georgios</given-names></name><name><surname>Stougie</surname><given-names>Leen</given-names></name><name><surname>Boes</surname><given-names>Olivier</given-names></name></person-group><article-title>On Unrooted and Root-Uncertain Variants of Several Well-Known Phylogenetic Network Problems</article-title><source>Algorithmica</source><year>2017</year><volume>80</volume><issue>11</issue><fpage>2993</fpage><lpage>3022</lpage><pub-id pub-id-type="doi">10.1007/s00453-017-0366-5</pub-id><pub-id pub-id-type="pmid">30956378</pub-id></element-citation></ref><ref id="CR19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>L</given-names></name></person-group><article-title>On tree-based phylogenetic networks</article-title><source>J Comput Biol</source><year>2016</year><volume>23</volume><issue>7</issue><fpage>553</fpage><lpage>565</lpage><pub-id pub-id-type="doi">10.1089/cmb.2015.0228</pub-id><pub-id pub-id-type="pmid">27228397</pub-id></element-citation></ref></ref-list></back></article>