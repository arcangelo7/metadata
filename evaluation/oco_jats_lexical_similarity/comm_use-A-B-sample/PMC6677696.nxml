<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bull Math Biol</journal-id><journal-id journal-id-type="iso-abbrev">Bull. Math. Biol</journal-id><journal-title-group><journal-title>Bulletin of Mathematical Biology</journal-title></journal-title-group><issn pub-type="ppub">0092-8240</issn><issn pub-type="epub">1522-9602</issn><publisher><publisher-name>Springer US</publisher-name><publisher-loc>New York</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">31175549</article-id><article-id pub-id-type="pmc">6677696</article-id><article-id pub-id-type="publisher-id">628</article-id><article-id pub-id-type="doi">10.1007/s11538-019-00628-7</article-id><article-categories><subj-group subj-group-type="heading"><subject>Special Issue: Multiscale Modeling of Tissue Growth and Shape</subject></subj-group></article-categories><title-group><article-title>Prospects for Declarative Mathematical Modeling of Complex Biological Systems</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9085-9171</contrib-id><name><surname>Mjolsness</surname><given-names>Eric</given-names></name><address><phone>+1 (949) 824-3533</phone><email>emj@uci.edu</email></address><xref ref-type="aff" rid="Aff1"/></contrib><aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0668 7243</institution-id><institution-id institution-id-type="GRID">grid.266093.8</institution-id><institution>Department of Computer Science, </institution><institution>University of California, </institution></institution-wrap>Irvine, CA 92697 USA </aff></contrib-group><pub-date pub-type="epub"><day>7</day><month>6</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>7</day><month>6</month><year>2019</year></pub-date><pub-date pub-type="ppub"><year>2019</year></pub-date><volume>81</volume><issue>8</issue><fpage>3385</fpage><lpage>3420</lpage><history><date date-type="received"><day>31</day><month>3</month><year>2018</year></date><date date-type="accepted"><day>30</day><month>5</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">Declarative modeling uses symbolic expressions to represent models. With such expressions, one can formalize high-level mathematical computations on models that would be difficult or impossible to perform directly on a lower-level simulation program, in a general-purpose programming language. Examples of such computations on models include model analysis, relatively general-purpose model reduction maps, and the initial phases of model implementation, all of which should preserve or approximate the mathematical semantics of a complex biological model. The potential advantages are particularly relevant in the case of developmental modeling, wherein complex spatial structures exhibit dynamics at molecular, cellular, and organogenic levels to relate genotype to multicellular phenotype. Multiscale modeling can benefit from both the expressive power of declarative modeling languages and the application of model reduction methods to link models across scale. Based on previous work, here we define declarative modeling of complex biological systems by defining the operator algebra semantics of an increasingly powerful series of declarative modeling languages including reaction-like dynamics of parameterized and extended objects; we define semantics-preserving implementation and semantics-approximating model reduction transformations; and we outline a &#x0201c;meta-hierarchy&#x0201d; for organizing declarative models and the mathematical methods that can fruitfully manipulate them.</p><sec><title>Electronic supplementary material</title><p>The online version of this article (10.1007/s11538-019-00628-7) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Declarative modeling</kwd><kwd>Development</kwd><kwd>Multiscale modeling</kwd><kwd>Operator algebra</kwd><kwd>Semantics</kwd><kwd>Graph grammars</kwd><kwd>Graded graphs</kwd><kwd>Stratified graphs</kwd><kwd>Cell division</kwd><kwd>Cytoskeleton</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01HD073179</award-id></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000185</institution-id><institution>Defense Advanced Research Projects Agency</institution></institution-wrap></funding-source><award-id>FA8750-14-C-0011</award-id><principal-award-recipient><name><surname>Mjolsness</surname><given-names>Eric</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000049</institution-id><institution>National Institute on Aging</institution></institution-wrap></funding-source><award-id>R56AG059602</award-id><principal-award-recipient><name><surname>Mjolsness</surname><given-names>Eric</given-names></name></principal-award-recipient></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004412</institution-id><institution>Human Frontier Science Program</institution></institution-wrap></funding-source><award-id>RGP0023/2018</award-id></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; Society for Mathematical Biology 2019</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">Central to developmental biology is the genotype-to-phenotype map required to close the evolutionary loop implied by selection on heritable variation. However, relating genotype to phenotype in a multicellular organism is an intrinsically multiscale and (therefore) complex modeling endeavor. Partial automation has the potential to tame the complexity for human scientists, provided it can address highly heterogeneous mathematical dynamics including stochastic reaction networks, dynamic spatial structures at molecular and cellular scales, and partial differential equations (PDEs) governing both pattern formation and dynamic geometry within dynamic topology. Here, we outline such a mathematical modeling framework, founded on the unifying idea of rewrite rules denoting operators in an operator algebra. The rewrite rules make this framework <italic>declarative</italic>: capable of expressing mathematical ideas at a high level in a symbolically and computationally manipulable form.</p><p id="Par3">To this end, we propose and discuss an informal definition of declarative modeling in general and provide as examples a collection of specific mathematical constructions of processes and extended objects for use in declarative models of complex biological systems and their processing by computer. Such processing can be symbolic and/or numerical, including for example model reduction by coupled symbolic and machine learning methods. The resulting apparatus is intended for semiautomatic synthesis and analysis of biological models, a computational domain which must typically deal with substantial intrinsic complexity in the subject modeled.</p><p id="Par4">The necessity for such automation is strongest for the most complex biological models, notably those required for developmental modeling. Examples of such dynamical spatial systems in development include plant cell division under the influence of dynamic microtubules in the pre-prophase band; neurite branching and somal translocation dependent on dynamic cytoskeleton in mammalian brain development; mitochondrial fission and fusion; plant organogenesis in shoot (shoot apical meristem or SAM) and root (lateral root initiation); topological changes in close-packed 2D tissues (e.g., fly wing disk) in response to cell division and convergent extension; neural tube closure; branching morphogenesis in vascular tissues; and many others. In all these cases, the spatial dynamics involves nontrivial changes in geometry and/or topology of extended biological objects; we must be able to represent such dynamics mathematically and computationally. Our main examples will be networks of dynamically interconnected cells and dynamically interconnected segments of cytoskeleton within a cell.</p><p id="Par5">This paper is organized as follows. We will define declarative models in Sect.&#x000a0;<xref rid="Sec2" ref-type="sec">2</xref> (informally in general but formally in particular cases) and survey a series of declarative quantitative modeling languages of increasing expressive power for biochemical and biological modeling as exemplified by coarse-scale models of multicellular tissues with cell division and by cytoskeletal dynamics; also we will describe the &#x0201c;operator algebra&#x0201d; mathematical semantics for these languages and the utility of structure-respecting maps among these mathematical entities. We will generalize the declarative modeling language/operator algebra semantics approach to encompass extended objects in Sect.&#x000a0;<xref rid="Sec7" ref-type="sec">3</xref>, by way of spatially embedded discrete graph structures (including dimension and refinement level indices) and their continuum limits; dynamics on such structures including PDEs; and dynamics by which such structures can change including graph rewrite syntactic rules under a novel operator algebra semantics. We will discuss progress toward a general method for nonlinear model reduction (usually across scales) by machine learning in Sect.&#x000a0;<xref rid="Sec16" ref-type="sec">4</xref> including an application of variational calculus generalized to a higher level. In Sect.&#x000a0;<xref rid="Sec18" ref-type="sec">5</xref>, we will propose the elements of a larger-scale mathematically based &#x0201c;meta-hierarchy&#x0201d; for organizing many biological models and modeling methods, enabled by the declarative approach to modeling and by structure-respecting maps among declarative languages and their mathematical semantics.</p><p id="Par6">Much of this paper reviews previous work, extending it (e.g., with the multiscale &#x0201c;graded graph&#x0201d; constructions of Sect.&#x000a0;<xref rid="Sec7" ref-type="sec">3</xref>, their dynamics of Eq.&#x000a0;(<xref rid="Equ19" ref-type="">17</xref>), and graph rewrite rule operator products defined by Propositions&#x000a0;<xref ref-type="sec" rid="FPar3">1</xref> and <xref ref-type="sec" rid="FPar4">2</xref> in Sect.&#x000a0;<xref rid="Sec12" ref-type="sec">3.2.2</xref>) and setting it in a broader context. The aim of this paper is not to provide a balanced summary of work in the field; instead it is aimed mainly at outlining mathematically the possibilities of particular directions for future development.</p></sec><sec id="Sec2"><title>Declarative Modeling</title><p id="Par7">A distinction made in classical Artificial Intelligence (AI) by Winograd among others is that between <italic>declarative</italic> and <italic>procedural</italic> representations of knowledge; this is the AI version of a philosophical distinction between &#x0201c;knowing that&#x0201d; and &#x0201c;knowing how,&#x0201d; as it pertains to knowledge expressed in a formal language that can be used to program intelligent systems (Winograd <xref ref-type="bibr" rid="CR50">1975</xref>). Generic advantages for declarative knowledge identified by Winograd include its greater flexibility, compactness, understandability, and communicability compared to procedural knowledge; these are virtues we seek for complex biological modeling. On the other hand, declarative knowledge may be incomplete, as it omits for example &#x0201c;heuristic&#x0201d; knowledge of domain-specific strategies for action (terminology surrounding the &#x0201c;declarative/procedural&#x0201d; distinction is discussed briefly in Supplementary Material Section&#x000a0;7.1).</p><p id="Par8">An example of a formalizable, declarative language for modeling biology is a collection of partial differential equations in which the variables represent local concentrations of molecular species and the spatial differential operators are all diffusion operators <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _{{{\varvec{x}}}}\cdot (D_\alpha ({{\varvec{x}}}) \nabla _{{\varvec{x}}}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq1.gif"/></alternatives></inline-formula>). Such a deterministic reaction/diffusion model can be represented in a computer by one or more abstract syntax trees (ASTs) including nodes for variable names, arithmetic operations, spatial differential operators such as the Laplacian, the first-order time derivative operator, equality constraints including boundary conditions, and possibly function definitions (a simple AST is shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>). Such an AST can be used to denote a reaction&#x02013;diffusion model as a data object that can be manipulated by computer algebra. It can also under some conditions be transformed symbolically, for example by separation of time scales replacing a subset of ordinary differential equations (without spatial derivatives) by function definitions of algebraic rate laws to be invoked in the differential equations for the remaining variables (e.g., Ermentrout <xref ref-type="bibr" rid="CR13">2004</xref>). The language is &#x0201c;declarative&#x0201d; from a computational point of view because it does not specify any algorithmic details for numerically solving the dynamical systems specified. Implemented examples will be discussed in Sect.&#x000a0;<xref rid="Sec7" ref-type="sec">3</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic view of an abstract syntax tree for the algebraic expression <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sqrt{x^2+y^2}$$\end{document}</tex-math><mml:math id="M4"><mml:msqrt><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq2.gif"/></alternatives></inline-formula>. It can be transformed in many ways. For example, it could be numerically evaluated at <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=5,y=12$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq3.gif"/></alternatives></inline-formula> by successive local transformations of ASTs. AST transformations are used in compilers for programming languages, in computer algebra systems, and in recent work on &#x0201c;symbolic regression&#x0201d; in machine learning</p></caption><graphic xlink:href="11538_2019_628_Fig1_HTML" id="MO1"/></fig></p><p id="Par9">We generalize from this example. A formal language should have a &#x0201c;semantics&#x0201d; map <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }$$\end{document}</tex-math><mml:math id="M8"><mml:mi>&#x003a8;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq4.gif"/></alternatives></inline-formula>, giving a mathematical meaning to some defined set of valid expressions in the language. For a modeling language, each valid model declaration <italic>M</italic> should correspond to an instance <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }(M)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>&#x003a8;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq5.gif"/></alternatives></inline-formula> in some space <italic>S</italic> of &#x0201c;dynamical systems&#x0201d; interpreted broadly, so that such systems may be stochastic and/or infinite-dimensional. If some of the semantically meaningful model expressions are composed of meaningful sub-expressions, and their semantics can be combined in a corresponding way, then the semantics is &#x0201c;compositional&#x0201d;; composition commutes with the semantic map. Likewise for valid transformations of model declarations, one would like the semantics before and after transformation to yield either the same mathematical meaning (equivalent dynamics), or two meanings that are related somehow, for example, by approximate equality under some conditions on parameters that may be partially known by proof and/or numerical experiment.</p><p id="Par10">So in the context of modeling languages in general and biological modeling languages in particular, some key advantages of the declarative language style are captured by the following informal (but perhaps formalizable) definition:</p><p id="Par11">A <italic>declarative modeling language</italic><italic>L</italic> is a formal language together with (a) compositional semantics <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }:L \rightarrow S$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>&#x003a8;</mml:mi><mml:mo>:</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq6.gif"/></alternatives></inline-formula> that maps all syntactically valid models <italic>M</italic> in <italic>L</italic> into some space <italic>S</italic> of dynamical systems, and (b) conditionally valid or conditionally approximately valid families of <italic>transformations</italic> on model-denoting AST expressions in the modeling language <italic>L</italic>. These AST transformations can be expressed formally in some computable meta-language, though the meta-language need not itself be a declarative modeling language.</p><p id="Par12">Under this informal definition, the utility of a declarative modeling language would depend on its expressive power, addressed in Sects.&#x000a0;<xref rid="Sec3" ref-type="sec">2.1</xref>&#x02013;<xref rid="Sec6" ref-type="sec">2.3</xref> and <xref rid="Sec7" ref-type="sec">3</xref>, and on the range, value, and reliability of the model-to-model transformations that can be constructed for it, to be discussed in Sects.&#x000a0;<xref rid="Sec7" ref-type="sec">3</xref> (implementation), <xref rid="Sec16" ref-type="sec">4</xref> (model reduction), and <xref rid="Sec18" ref-type="sec">5</xref> (wider prospects). Multiscale modeling benefits from both the expressive power (e.g., representing cellular and molecular processes in the same model) and model reduction (finding key coarse-scale variables and dynamics to approximate fine-scale ones) elements of this agenda.</p><p id="Par13">Although it is plausible that &#x0201c;one can&#x02019;t proceed from the informal to the formal by formal means&#x0201d; (Perlis <xref ref-type="bibr" rid="CR39">1982</xref>), so that the task of formalizing a complex biological system to create models must begin informally, we will nevertheless try to be <italic>systematic</italic> about this task by building the semantic map <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }$$\end{document}</tex-math><mml:math id="M14"><mml:mi>&#x003a8;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq7.gif"/></alternatives></inline-formula> up out of &#x0201c;processes&#x0201d; and &#x0201c;objects&#x0201d; of increasing generality and structure. These processes and objects are represented by &#x0201c;expressions&#x0201d; in a language, and mapped to mathematical objects that together define a model. So the map <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }$$\end{document}</tex-math><mml:math id="M16"><mml:mi>&#x003a8;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq8.gif"/></alternatives></inline-formula> will be concerned with expressions, processes, and objects.</p><p id="Par14">We show how to define a series of simple quantitative modeling languages of increasing expressive power, accompanied by semantic maps <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }(M)$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>&#x003a8;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq9.gif"/></alternatives></inline-formula> to operator algebras. To do this, we need some idea concerning how to represent elementary biological processes with syntactic expressions that can include numerical quantities. One such idea begins with chemical reaction notation.</p><sec id="Sec3"><title>Pure Reaction Rules</title><p id="Par15">In biology, generalized versions of <italic>rewrite rules</italic> naturally specify biochemical processes in a declarative modeling language, as well as model transformations in a meta-language. The most straightforward example is chemical reaction notation. As in Mjolsness (<xref ref-type="bibr" rid="CR33">2010</xref>), we could use chemical &#x0201c;addition&#x0201d; notation:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Bigg ( \sum \limits _{\alpha =1}^{A_{\max }}m_{\alpha }^{\left( r\right) } A_{\alpha } \Bigg ) \ \ \overset{k_{\left( r\right) }}{\longrightarrow }\ \ \Bigg ( \sum \limits _{\beta =1}^{A_{\max }}n_{\beta }^{\left( r\right) } A_{\beta } \Bigg ) , \end{aligned}$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">(</mml:mo></mml:mrow><mml:munderover><mml:mo movablelimits="false">&#x02211;</mml:mo><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:msub></mml:munderover><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msubsup><mml:msub><mml:mi>A</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">)</mml:mo></mml:mrow><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mover><mml:mo stretchy="false">&#x027f6;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msub></mml:mover><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">(</mml:mo></mml:mrow><mml:munderover><mml:mo movablelimits="false">&#x02211;</mml:mo><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:msub></mml:munderover><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msubsup><mml:msub><mml:mi>A</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{\alpha }^{\left( r\right) } $$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\beta }^{\left( r \right) }$$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq11.gif"/></alternatives></inline-formula> are nonnegative integer-valued stoichiometries for molecular species <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_{\alpha }$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>A</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq12.gif"/></alternatives></inline-formula> indexed by <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="M28"><mml:mi>&#x003b1;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq13.gif"/></alternatives></inline-formula> in reaction <italic>r</italic> with nonnegative reaction rate <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{(r)}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq14.gif"/></alternatives></inline-formula>, and we may omit summands with <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{\alpha }^{( r) }=0$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq15.gif"/></alternatives></inline-formula> or <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\beta }^{(r)}=0$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq16.gif"/></alternatives></inline-formula>. The left hand side (LHS) and right hand side (RHS) of the reaction arrow are just formal sums or equivalently <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${ multisets}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi mathvariant="italic">multisets</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq17.gif"/></alternatives></inline-formula> with nonnegative integer multiplicities of all possible reactants, defaulting to zero if a reactant is not mentioned:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Big \{ m_{\alpha }^{\left( r\right) } A_{\alpha } \Big \}_* \ \ \overset{k_{\left( r\right) }}{\longrightarrow }\ \ \ \Big \{ n_{\beta }^{\left( r\right) } A_{\beta } \Big \}_*. \end{aligned}$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">{</mml:mo></mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msubsup><mml:msub><mml:mi>A</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">}</mml:mo></mml:mrow><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mover><mml:mo stretchy="false">&#x027f6;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msub></mml:mover><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">{</mml:mo></mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msubsup><mml:msub><mml:mi>A</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">}</mml:mo></mml:mrow><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>Concisely, we can summarize reaction rule <italic>r</italic> as &#x0201c;<inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\text {LHS}_r \rightarrow \text {RHS}_r}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:msub><mml:mtext>LHS</mml:mtext><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:msub><mml:mtext>RHS</mml:mtext><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq18.gif"/></alternatives></inline-formula>&#x0201d;. Either detailed syntax expresses the transformation of one multiset of symbols into another, with a numerical or symbolic quantitative reaction rate <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{\left( r\right) }$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>k</mml:mi><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq19.gif"/></alternatives></inline-formula>. The syntax is easily encoded in an abstract syntax tree (AST).</p><p id="Par16">An example AST <italic>transformation</italic> might be a meta-rule that reverses an arrow (Yosiphon <xref ref-type="bibr" rid="CR54">2009</xref>) and changes the name of the reaction rate to (for example) <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{\left( r^{\prime }\right) }$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>k</mml:mi><mml:mfenced close=")" open="("><mml:msup><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mfenced></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq20.gif"/></alternatives></inline-formula>, for a new reaction number <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{\prime }$$\end{document}</tex-math><mml:math id="M46"><mml:msup><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq21.gif"/></alternatives></inline-formula>, allowing for the possibility of detailed balance to be satisfied in a collection of reactions. Many other reaction arrow types (e.g., substrate-enzyme-product) can then be defined by computable transformation to combinations of these elementary mass action reactions [e.g., Shapiro et&#x000a0;al. (<xref ref-type="bibr" rid="CR41">2003</xref>), Yang et&#x000a0;al. (<xref ref-type="bibr" rid="CR53">2005</xref>) and Shapiro et&#x000a0;al. (<xref ref-type="bibr" rid="CR44">2015</xref>) for many examples in a declarative biological modeling context], using either commercial (Wolfram Research <xref ref-type="bibr" rid="CR52">2017</xref>) or open-source (Joyner et&#x000a0;al. <xref ref-type="bibr" rid="CR22">2012</xref>) computer algebra system software.</p><p id="Par17">How can we define a compositional semantics for this reaction notation? Fortunately, the operator algebra formalism of quantum field theory can be adapted to model the case of ordinary (non-quantum) probabilities governed by the law of mass action in a Master Equation (Doi <xref ref-type="bibr" rid="CR10">1976a</xref>, <xref ref-type="bibr" rid="CR11">b</xref>; Peliti <xref ref-type="bibr" rid="CR38">1985</xref>; Mattis and Glasser <xref ref-type="bibr" rid="CR27">1998</xref>; Mjolsness <xref ref-type="bibr" rid="CR33">2010</xref>) [and Morrison and Kinney (<xref ref-type="bibr" rid="CR36">2016</xref>) for the equilibrium case]. As in physics, each operator algebra we deal with will be generated by a collection of elementary operators and their commutation relations, together with their closure under operator addition, operator multiplication, and scalar multiplication of operators by real numbers. In the present case, the generators are the identity operator together with, for each molecular species or other symbol type <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="M48"><mml:mi>&#x003b1;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq22.gif"/></alternatives></inline-formula> in the reaction set, a creation operator <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{a}}_\alpha $$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>&#x003b1;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq23.gif"/></alternatives></inline-formula> and an annihilation operator <inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_\alpha $$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>a</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq24.gif"/></alternatives></inline-formula> the commutation relations are <inline-formula id="IEq25"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_\alpha {\hat{a}}_\beta = {\hat{a}}_\beta a_\alpha - 2 \delta _{\alpha \beta } {\hat{a}}_\alpha a_\alpha + \delta _{\alpha \beta } I_{\alpha }$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>&#x003b2;</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>&#x003b2;</mml:mi></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq25.gif"/></alternatives></inline-formula> as discussed in Supplementary Material Section&#x000a0;7.2.1. Then, the semantics <inline-formula id="IEq26"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }(M)$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>&#x003a8;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq26.gif"/></alternatives></inline-formula> is determined by the creation/annihilation operator monomials<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\hat{W}}}_{r} \equiv {\hat{W}}_{\text {LHS}_r \rightarrow \text {RHS}_r} \equiv k_{r} \left\{ \prod \limits _{\beta \in {\text {rhs}}( r) } ({{\hat{a}}}_{\beta })^{n_{\beta }^{\left( r\right) }} \right\} \left\{ \prod \limits _{ \alpha \in {\text {lhs}}( r) } (a_{\alpha })^{m_{\alpha }^{\left( r\right) }} \right\} \ \ \end{aligned}$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub><mml:mo>&#x02261;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mtext>LHS</mml:mtext><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:msub><mml:mtext>RHS</mml:mtext><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>&#x02261;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mfenced close="}" open="{"><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mtext>rhs</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>&#x003b2;</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msubsup></mml:msup></mml:mfenced><mml:mfenced close="}" open="{"><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mtext>lhs</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msubsup></mml:msup></mml:mfenced><mml:mspace width="4pt"/><mml:mspace width="4pt"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>which specifies the nonnegative flow of probability between states under each reaction <italic>r</italic>. The states are given by vectors <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{{\varvec{n}}}\rangle = |[n_\alpha ]\rangle $$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mo stretchy="false">&#x027e9;</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">&#x027e9;</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq27.gif"/></alternatives></inline-formula> of nonnegative integers <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_\alpha $$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>n</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq28.gif"/></alternatives></inline-formula> (distinguished from stoichiometry <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\beta }^{\left( r\right) }$$\end{document}</tex-math><mml:math id="M64"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq29.gif"/></alternatives></inline-formula> by its lack of a superscript), one for each molecular species. The full system state is a probability distribution <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p(|{{\varvec{n}}}\rangle )$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mo stretchy="false">&#x027e9;</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq30.gif"/></alternatives></inline-formula>, on which operators act linearly. Here, <inline-formula id="IEq31"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ k_{r }$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>k</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq31.gif"/></alternatives></inline-formula> is conventional notation for a reaction rate; later we will call it <inline-formula id="IEq32"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \rho _{r }$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq32.gif"/></alternatives></inline-formula> instead. The usual chemical law of mass action is encoded in the annihilation operators <inline-formula id="IEq33"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{\alpha }$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>a</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq33.gif"/></alternatives></inline-formula>. Annihilation operator subscript <inline-formula id="IEq34"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="M74"><mml:mi>&#x003b1;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq34.gif"/></alternatives></inline-formula> indexes the species present in the multiset on the left hand side (LHS) of Eq.&#x000a0;(<xref rid="Equ2" ref-type="">2</xref>); the corresponding operator is raised to the power of its multiplicity or ingoing stoichiometry <inline-formula id="IEq35"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{\alpha }^{\left( r\right) }$$\end{document}</tex-math><mml:math id="M76"><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq35.gif"/></alternatives></inline-formula> in reaction <italic>r</italic>, destroying that many particles of species <inline-formula id="IEq36"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="M78"><mml:mi>&#x003b1;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq36.gif"/></alternatives></inline-formula> if they exist (and contributing zero probability if they don&#x02019;t). Likewise creation operator <inline-formula id="IEq37"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\hat{a}}}_{\beta }$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>&#x003b2;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq37.gif"/></alternatives></inline-formula> has subscript <inline-formula id="IEq38"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta $$\end{document}</tex-math><mml:math id="M82"><mml:mi>&#x003b2;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq38.gif"/></alternatives></inline-formula> indexing the species present in the multiset on the right hand side (RHS) of Eq.&#x000a0;(<xref rid="Equ2" ref-type="">2</xref>), and the operator is raised to the power of its outgoing stoichiometry <inline-formula id="IEq39"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\beta }^{\left( r\right) }$$\end{document}</tex-math><mml:math id="M84"><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>r</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq39.gif"/></alternatives></inline-formula> which indicates how many particles of species <inline-formula id="IEq40"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta $$\end{document}</tex-math><mml:math id="M86"><mml:mi>&#x003b2;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq40.gif"/></alternatives></inline-formula> are to be created. The &#x0201c;<inline-formula id="IEq41"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{W}}_{\text {LHS}_r \rightarrow \text {RHS}_r}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mtext>LHS</mml:mtext><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:msub><mml:mtext>RHS</mml:mtext><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq41.gif"/></alternatives></inline-formula>&#x0201d; notation is also used by Behr et&#x000a0;al. (<xref ref-type="bibr" rid="CR2">2016</xref>). Given Eq.&#x000a0;(<xref rid="Equ3" ref-type="">3</xref>), the actual <italic>semantics</italic> is then expressed by <inline-formula id="IEq42"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }(M)=W(M)$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>&#x003a8;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq42.gif"/></alternatives></inline-formula> where <italic>W</italic>(<italic>M</italic>) sums over all reactions <italic>r</italic> as in Eqs.&#x000a0;(4) and (<xref rid="Equ7" ref-type="">5</xref>).</p><p id="Par18">Explicit expressions for the creation and annihilation operators used here, along with the algebra they satisfy, calculation of probability conservation operator <italic>D</italic>, and definition of equivalent models, are provided in Supplementary Material Section 7.2.1.</p><p id="Par19">The model semantics built on Eq.&#x000a0;(<xref rid="Equ3" ref-type="">3</xref>) is <italic>compositional</italic> over processes, hence structure-preserving, because:<list list-type="alpha-lower"><list-item><p id="Par20">The operators for multiple rules indexed by <italic>r</italic> in a ruleset map to an <italic>operator sum</italic>: <disp-formula id="Equ4"><label>4a</label><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} W&#x00026;= \sum _r W_r \; , \quad \text {(rule operators sum up), where} \end{aligned}$$\end{document}</tex-math><mml:math id="M92" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>W</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mi>r</mml:mi></mml:munder><mml:msub><mml:mi>W</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mspace width="0.277778em"/><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>(rule operators sum up), where</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>4b</label><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \quad \quad W_r&#x00026;\equiv {\hat{W}}_r - D_r , \quad \text{(rules } \text{ conserve } \text{ probability) } \end{aligned}$$\end{document}</tex-math><mml:math id="M94" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msub><mml:mi>W</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>&#x02261;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>(rules</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.333333em"/><mml:mtext>conserve</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.333333em"/><mml:mtext>probability)</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ6"><label>4c</label><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} D_r&#x00026;\equiv \mathrm{diag}(\mathbf{1 } \cdot {\hat{W}}_r) \quad \text{(total } \text{ probability } \text{ outflow } \text{ per } \text{ state) } \end{aligned}$$\end{document}</tex-math><mml:math id="M96" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>D</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>&#x02261;</mml:mo><mml:mi mathvariant="normal">diag</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">1</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="1em"/><mml:mtext>(total</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.333333em"/><mml:mtext>probability</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.333333em"/><mml:mtext>outflow</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.333333em"/><mml:mtext>per</mml:mtext><mml:mspace width="0.333333em"/><mml:mspace width="0.333333em"/><mml:mtext>state)</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula> that specifies the combined dynamics under the chemical master equation: <disp-formula id="Equ7"><label>5</label><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\dot{p}} = W \cdot p. \end{aligned}$$\end{document}</tex-math><mml:math id="M98" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mi>p</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula> In Eq.&#x000a0;(4), the first statement is ruleset compositionality, the second and third ensure conservation of probability. Equation&#x000a0;(<xref rid="Equ7" ref-type="">5</xref>) is the resulting Chemical Master Equation (CME) stochastic dynamical system for the evolving state probability <inline-formula id="IEq43"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p({{\varvec{n}}})$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq43.gif"/></alternatives></inline-formula>. Also the semantics is compositional because:</p></list-item><list-item><p id="Par21">The multisets on the left hand side and right hand side of a rule each map to an <italic>operator product</italic> in normal form (including powers for repeated multiset elements) in Eq.&#x000a0;(<xref rid="Equ3" ref-type="">3</xref>). Each product consists of commuting operators so their order is arbitrary.</p></list-item></list>The default continuous-time semantics <inline-formula id="IEq44"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W = {\varPsi }( M ) $$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mi>&#x003a8;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq44.gif"/></alternatives></inline-formula> is now be defined by Eq.&#x000a0;(<xref rid="Equ3" ref-type="">3</xref>) (the specific semantic map for each rule of a model <italic>M</italic>) and Eq.&#x000a0;(4), in the context of Eq.&#x000a0;(<xref rid="Equ7" ref-type="">5</xref>). Thus, we have defined a &#x0201c;structure-respecting&#x0201d; mapping <inline-formula id="IEq45"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }$$\end{document}</tex-math><mml:math id="M104"><mml:mi>&#x003a8;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq45.gif"/></alternatives></inline-formula> from pure (multiset-changing) rulesets (each rules weighted by a nonnegative reaction rate) to operator algebras; <inline-formula id="IEq46"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }$$\end{document}</tex-math><mml:math id="M106"><mml:mi>&#x003a8;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq46.gif"/></alternatives></inline-formula> is (at least) a linear mapping of vector spaces.</p><p id="Par22">The integer-valued index <italic>r</italic> we used to name the reactions is part of a meta-language for the present theorizing, and not part of the modeling language. One slightly confusing point is that these unordered collections of chemical reactions are expressions in the language, but they also have a form reminiscent of a grammar for <italic>another language</italic>&#x02014;albeit a language of multisets representing the system state, rather than of strings or trees, and a language that may be entirely devoid of terminal symbols (which would represent inert products such as waste). The CME as semantics was suggested by Mjolsness and Yosiphon (<xref ref-type="bibr" rid="CR31">2006</xref>); Mjolsness (<xref ref-type="bibr" rid="CR30">2005</xref>) and by Cardelli (<xref ref-type="bibr" rid="CR5">2008</xref>), though it can be regarded as implicit in the original Doi&#x02013;Peliti formalism. There is also a projection from continuous-time (CME) semantics to discrete-time probabilistic semantics in the form of a Markov chain (Mjolsness and Yosiphon <xref ref-type="bibr" rid="CR31">2006</xref>).</p><p id="Par23">From this operator algebra semantics and the time-ordered product expansion (TOPE) approach to Feynman path integrals (Mjolsness and Yosiphon <xref ref-type="bibr" rid="CR31">2006</xref>; Mjolsness <xref ref-type="bibr" rid="CR30">2005</xref>), one can derive valid exact stochastic simulation algorithms including the Gillespie stochastic simulation algorithm (SSA) and various generalizations, as detailed in Mjolsness (<xref ref-type="bibr" rid="CR35">2013</xref>). Such algorithms can also be accelerated exactly (Mjolsness et&#x000a0;al. <xref ref-type="bibr" rid="CR32">2009</xref>), and accelerated further by working hierarchically at multiple scales and/or using parallel computing (Orendorff and Mjolsness <xref ref-type="bibr" rid="CR37">2012</xref>). The same theory can be used to derive machine learning algorithms for the inference of reaction rate parameters from sufficient data (Wang et&#x000a0;al. <xref ref-type="bibr" rid="CR49">2010</xref>) (cf.&#x000a0;Golightly and Wilkinson <xref ref-type="bibr" rid="CR16">2011</xref>), although sufficient data may be hard to obtain. One can also develop approximate sampling algorithms by operator splitting, justified, e.g., by the Baker&#x02013;Campbell&#x02013;Hausdorff theorem (BCH), and/or by moment closure methods such as those discussed in Sect.&#x000a0;<xref rid="Sec16" ref-type="sec">4</xref>.</p><p id="Par24">Symbolic and numerical solutions of some simple stochastic models are discussed briefly in the Supplementary Material, Section 7.4.1.</p><p id="Par25">Thus, unordered collections of pure chemical reactions provide a simple example of a modeling language with a compositional semantics. But for most biological modeling, we need much more expressive power than this.</p></sec><sec id="Sec4"><title>Parameterized Reaction Rules</title><p id="Par26">The first modeling language escalation beyond pure chemical reaction notation is to particle-like objects or &#x0201c;agents&#x0201d; that bear numerical and/or discrete parameters which affect their reaction reaction rates. For example, the size of a cell may affect its chances of undergoing cell division. This kind of multiset rewrite rule can be generalized to (Mjolsness <xref ref-type="bibr" rid="CR33">2010</xref>)<disp-formula id="Equ8"><label>6</label><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\left\{ \tau _{\alpha ( p) }[ x_{p}] |p \in L_{r}\right\} }_{*} \longrightarrow {\left\{ \tau _{\beta ( q) }[ y_{q}] | q \in R_{r}\right\} }_{*} \quad \mathbf{with } \quad \rho _{r}\left( \left[ x_{p}\right] ,\left[ y_{q}\right] \right) . \end{aligned}$$\end{document}</tex-math><mml:math id="M108" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mfenced close="}" open="{"><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>p</mml:mi><mml:mo>&#x02208;</mml:mo></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfenced><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">&#x027f6;</mml:mo><mml:msub><mml:mfenced close="}" open="{"><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>q</mml:mi><mml:mo>&#x02208;</mml:mo></mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfenced><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mi mathvariant="bold">with</mml:mi><mml:mspace width="1em"/><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mfenced close="]" open="["><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close="]" open="["><mml:msub><mml:mi>y</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mfenced></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>Here, we have switched from molecule-like term names <inline-formula id="IEq47"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_\alpha $$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mi>A</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq47.gif"/></alternatives></inline-formula> to more generic logic-like term names <inline-formula id="IEq48"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau _{\alpha ( p)}$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq48.gif"/></alternatives></inline-formula>. The parameters <inline-formula id="IEq49"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{p}, y_{q}$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq49.gif"/></alternatives></inline-formula> of each term (indexed by positions <italic>p</italic>,&#x000a0;<italic>q</italic> in their respective argument lists, and which may themselves be vectors <inline-formula id="IEq50"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\varvec{x}}}}_{p}$$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq50.gif"/></alternatives></inline-formula>) introduce a new aspect of the language, analogous to the difference between predicate calculus and first-order logic: each parameter can appear as a constant or as a variable, and the same variable <inline-formula id="IEq51"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_c$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi>X</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq51.gif"/></alternatives></inline-formula> can be repeated in several components of several parameter lists in a single rule. Thus, it is impossible in general to say whether two parameters in a rule are equal or not, and thus whether two terms <inline-formula id="IEq52"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \tau _{\alpha ( p) }[ x_{p}] $$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq52.gif"/></alternatives></inline-formula> in a rule are the same or not, just from looking at the rule&#x02014;that fact may depend on the values of the variables, known only at simulation time. The <italic>p</italic>,&#x000a0;<italic>q</italic> subindex notation is as in Mjolsness (<xref ref-type="bibr" rid="CR35">2013</xref>). The reaction rate <inline-formula id="IEq53"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _{r}( [ x_{p}] ,[ y_{q}] )$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq53.gif"/></alternatives></inline-formula> now depends on parameters on one or both sides of the rewrite rule which can be factored [automatically in a declarative environment (Yosiphon <xref ref-type="bibr" rid="CR54">2009</xref>)] into a rate depending on the LHS parameters only and a conditional distribution of RHS given LHS parameters.</p><sec id="Sec5"><title>Examples: Cell Division and Dynamic Cytoskeleton</title><p id="Par27">Both multicellular tissue and intracellular cytoskeleton topologies change, discontinuously of course, in ways that could be modeled with parameterized reaction rules in a flexible declarative language. For example, a stem cell of volume <italic>V</italic> might divide asymmetrically yielding a stem cell and a transit-amplifying cell in for example mouse olfactory epithelium (Yosiphon <xref ref-type="bibr" rid="CR54">2009</xref>):<disp-formula id="Equ9"><label>7</label><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned}&#x00026;{\text {stemcell}}[ {{{\varvec{x}}}},V,\ldots ] \longrightarrow {\text {TAcell}}[ {{{\varvec{x}}}}+{\Delta } {{\varvec{x}}},V/2,\ldots ] ,{\text {stemcell}}[ {{{\varvec{x}}}}-{\Delta } {{{\varvec{x}}}},V/2,\ldots ] \\&#x00026;\quad \mathbf{with }\ \ {\hat{\rho }}( V) {\mathcal {N}}( {\Delta } {{{\varvec{x}}}};c V^{1/d}) , \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="M124" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mtext>stemcell</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">&#x027f6;</mml:mo><mml:mtext>TAcell</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mtext>stemcell</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mi mathvariant="bold">with</mml:mi><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mover accent="true"><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>&#x0037e;</mml:mo><mml:mi>c</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq54"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\rho }}( V)$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mover accent="true"><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq54.gif"/></alternatives></inline-formula> is a probability per unit time or &#x0201c;propensity&#x0201d; for cell division depending on cell volume, and <inline-formula id="IEq55"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {N}}( {\Delta } {\mathbf{x }};c V^{1/d})$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi mathvariant="bold">x</mml:mi><mml:mo>&#x0037e;</mml:mo><mml:mi>c</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq55.gif"/></alternatives></inline-formula> is a Gaussian or normal probability density function with diagonal covariance proportional to a lengthscale set by cell volume. It is up to the modeler to impose appropriate invariances in such a model. In this case, Galilean invariance is ensured by fact that the propensity function depends on position only through <inline-formula id="IEq56"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Delta } {{{\varvec{x}}}}$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq56.gif"/></alternatives></inline-formula>, a difference of cell position vectors. Rotational symmetry could be broken by the prominent apical-basal axis in such a <inline-formula id="IEq57"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d=2$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq57.gif"/></alternatives></inline-formula> model of a pseudostratified epithelium.</p><p id="Par28">Another stem cell application was to models of plant root growth and pattern formation regulated by the auxin growth hormone (Yosiphon <xref ref-type="bibr" rid="CR54">2009</xref>; Mironova et&#x000a0;al. <xref ref-type="bibr" rid="CR28">2012</xref>; Mjolsness <xref ref-type="bibr" rid="CR35">2013</xref>), implemented in a computer algebra system (Yosiphon <xref ref-type="bibr" rid="CR54">2009</xref>; Shapiro et&#x000a0;al. <xref ref-type="bibr" rid="CR43">2013</xref>); cf. Julien et. al (<xref ref-type="bibr" rid="CR23">2019</xref>) in this issue for auxin-based plant shoot patterning. These examples show that with parameters, reaction-like rewrite rules can represent (for example) both cellular and molecular processes in the same model, and of course their interactions, which is a key expressiveness capability for multiscale modeling. Further discussion of this and other cell division examples is presented in Supplementary Material Section 7.3.1.</p><p id="Par29">The grammar of Equation&#x000a0;(35) happens to have just one object on the LHS of each rule, so it is &#x0201c;context free&#x0201d; and amenable to analysis. Generally, that is not the case even for cell division grammars like Equation&#x000a0;(34); even less so for biological many-to-one transitions such as the fusion of mitochondria or of muscle cell, or the merging of microtubule fibers in cytoskeleton.</p><p id="Par30">A related but more detailed approach to 2D and 3D cell division modeling was taken in the shoot apical meristem (SAM) dynamical patterning model of J&#x000f6;nsson et&#x000a0;al. (<xref ref-type="bibr" rid="CR20">2006</xref>), in which cell positions and radii were again (as in 1D) the dynamical variables, determined by the mechanics of breakable springs in viscous media, and cell&#x02013;cell interface areas were determined by the chordal intersections of corresponding cellular regions (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a). The &#x0201c;Organism&#x0201d; C++ code in which this model was implemented (J&#x000f6;nsson et&#x000a0;al. <xref ref-type="bibr" rid="CR21">2018</xref>) is not fully declarative, but is flexible enough to serve as the back end for a declarative model by translation of input files and to output similar files.<xref ref-type="fn" rid="Fn1">1</xref> It supports bidirectional coupling of regulatory networks such as regulated active auxin transport and/or gene regulation network models of SAM morphogenetic patterning [e.g., J&#x000f6;nsson et&#x000a0;al. (<xref ref-type="bibr" rid="CR19">2005</xref>); see also Banwarth-Kuhn et&#x000a0;al. (<xref ref-type="bibr" rid="CR1">2018</xref>) in this issue] to the biomechanics. A similar mechanical/regulatory model with breakable springs for the stem cell niche of mouse olfactory receptor neurons was implemented in the Plenum prototype implementation of the dynamical grammars declarative modeling language (Yosiphon <xref ref-type="bibr" rid="CR54">2009</xref>). A similar cell-centered model was used recently to model neural crest cell group migration, with stronger springs at the rear of each cell group representing multicellular cytoskeletal structures there (Shellard et&#x000a0;al. <xref ref-type="bibr" rid="CR46">2018</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p><bold>a</bold> Cell&#x02013;cell spring biomechanical model. Potential energy <italic>V</italic> for each spring can be something like, e.g., a Lennard&#x02013;Jones potential that is repulsive at short range, attractive at intermediate range, and flat (implies forceless) at long range; another such form is a breakable spring with <inline-formula id="IEq58"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V(\mathbf{x }_p , \mathbf{x }_q)= (1/2)\sum _{q \in \text {Nbrs}(p)} k_{pq} c_{pq} [(|\mathbf{x }_p - \mathbf{x }_q| - l_{pq}|^2 - {{\Delta } l_{pq}}^2]$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mtext>Nbrs</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="italic">pq</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">pq</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo></mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi mathvariant="italic">pq</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msup><mml:mo stretchy="false">|</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi mathvariant="italic">pq</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq58.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq59"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{pq} \in \{0,1\}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">pq</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq59.gif"/></alternatives></inline-formula> is chosen to minimize <italic>V</italic> at large separations (<inline-formula id="IEq60"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{pq} = 0$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">pq</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq60.gif"/></alternatives></inline-formula> corresponds to a broken spring with continuity of potential energy at the breaking point). Parameters are spring constant (strength) <inline-formula id="IEq61"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_{pq}$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="italic">pq</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq61.gif"/></alternatives></inline-formula>, resting length <inline-formula id="IEq62"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l_{pq}$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi mathvariant="italic">pq</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq62.gif"/></alternatives></inline-formula>, and breaking stretch distance <inline-formula id="IEq63"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\Delta } l_{pq}}$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi mathvariant="italic">pq</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq63.gif"/></alternatives></inline-formula>. <bold>b</bold> Cell wall spring biomechanical model. Springs again have nonzero resting lengths, but cannot break. Cf. more detailed polygonal tessellation models in Wolff et&#x000a0;al. (<xref ref-type="bibr" rid="CR51">2019</xref>). Reproduced from Shapiro et&#x000a0;al. (<xref ref-type="bibr" rid="CR43">2013</xref>); courtesy Bruce Shapiro</p></caption><graphic xlink:href="11538_2019_628_Fig2_HTML" id="MO11"/></fig></p><p id="Par32">As described in Supplementary Material Section 7.3.2, more detailed quantitative cell division rules can create growing convex polygonal patterns that appear qualitatively similar to those of derived from microscope imagery of SAM tissue as shown in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>.<fig id="Fig3"><label>Fig. 3</label><caption><p><bold>a</bold> Trimmed Voronoi diagram closely matches cell walls in <italic>Arabidopsis thaliana</italic> shoot apical meristem outer L1 cell layer 2D geometry derived from confocal laser scanning microscopy. Green: cell wall marker. Yellow: Voronoi diagram edges. Red: nuclear marker. Reproduced from Shapiro et&#x000a0;al. (<xref ref-type="bibr" rid="CR42">2012</xref>); courtesy Bruce Shapiro and Marcus Heisler. <bold>b</bold> Growing SAM geometry produced by Cellzilla declarative model, using optimized cell division rule as described in the text. Reproduced from Shapiro et&#x000a0;al. (<xref ref-type="bibr" rid="CR43">2013</xref>) (Color figure online)</p></caption><graphic xlink:href="11538_2019_628_Fig3_HTML" id="MO12"/></fig></p><p id="Par33"><italic>Dynamic cytoskeleton</italic> All of these examples of coarse-scale models of plant cell division could and probably should be elaborated at a much finer biophysical scale. But doing so requires the introduction of models of cytoskeleton in general and microtubule dynamics in particular, a problem of current research interest (Vemu et&#x000a0;al. <xref ref-type="bibr" rid="CR48">2018</xref>; Chakrabortty et&#x000a0;al. <xref ref-type="bibr" rid="CR6">2018</xref>). That is because the role microtubules play in determining the plane of the cortical pre-prophase band, which in turn correlates well with the subsequent septation and choice of division plane. Here, we simply observe the composable rule-like behavior of some of the principal processes that cortical microtubules undergo: (1) nucleation of new MTs, often in association with old ones; (2) treadmilling, in which tubulin subunits are added to the ragged growing &#x0201c;+ end&#x0201d; of a microtubule and removed from the &#x0201c;&#x02212; end&#x0201d;; (3) probabilistic transitions of <inline-formula id="IEq64"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+$$\end{document}</tex-math><mml:math id="M146"><mml:mo>+</mml:mo></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq64.gif"/></alternatives></inline-formula> end state among growth, pause, and catastrophic depolymerization (Shaw et&#x000a0;al. <xref ref-type="bibr" rid="CR45">2003</xref>); (4) collision of one CMT into the side of another in the 2-dimensional cell cortex, resulting depending on collision angle in (4a) &#x0201c;zippering&#x0201d; or &#x0201c;bundling&#x0201d; into a CMT bundle if the collision angle is small, or else (4b) an apparently stochastic choice between (4b1) colliding <inline-formula id="IEq65"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+$$\end{document}</tex-math><mml:math id="M148"><mml:mo>+</mml:mo></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq65.gif"/></alternatives></inline-formula> end goes into catastrophe state, or (3b2) colliding <inline-formula id="IEq66"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+$$\end{document}</tex-math><mml:math id="M150"><mml:mo>+</mml:mo></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq66.gif"/></alternatives></inline-formula> end crosses over and continues past the other CMT, forming a stable junction with it; (5) katanin-induced severing of a CMT far from either end; and (6) biomechanics of bending. Other processes may have to do with anchoring the CMT to the cell membrane and cell wall. Processes 4a, 4b1 and 4b2 are illustrated in Supplementary Material Section 7.3.3, Figures&#x000a0;7 and 8. One way to express some of these processes [(1), (2), part of (3), and (4a)] in a graph grammar will be discussed in Sect.&#x000a0;<xref rid="Sec10" ref-type="sec">3.2</xref>.</p><p id="Par34">Even for multilevel modeling of a single-scale reaction network, dynamic parameters allow for the possibility of aggregate objects that keep track of many individual particles including their number. Such aggregate objects would have their own rules as discussed in Yosiphon (<xref ref-type="bibr" rid="CR54">2009</xref>,&#x000a0;Section 6.4), possibly obtained from fine-scale reaction rules by meta-rule transformation.</p><p id="Par35">A detailed description of the semantics of <italic>parameterized</italic> rewrite rules as developed in Mjolsness (<xref ref-type="bibr" rid="CR33">2010</xref>) is presented in Supplementary Material Section&#x000a0;7.2.2. It is followed in Section&#x000a0;7.2.3 by a discussion of the high degree of intrinsic parallelism of the resulting semantics.</p><p id="Par36">Equations (<xref rid="Equ8" ref-type="">6</xref>) and (28) comprise the syntax and semantics of the basic ruleset portion of stochastic parameterized grammars (SPG) language of Mjolsness and Yosiphon (<xref ref-type="bibr" rid="CR31">2006</xref>) and Yosiphon (<xref ref-type="bibr" rid="CR54">2009</xref>). A simulation algorithm is derived in Mjolsness (<xref ref-type="bibr" rid="CR35">2013</xref>). <italic>Equivalence</italic> of models can again be defined as &#x0201c;particle equivalence,&#x0201d; Equation&#x000a0;(25). Other features such as submodels, object type polymorphism, and graph grammars were also included. The idea of a biological modeling language whose models take the form of grammars goes back to L-systems (discussed below); continuous-time versions of biomodel grammars to which it would be easy to add differential equation rules goes back at least to Mjolsness et&#x000a0;al. (<xref ref-type="bibr" rid="CR29">1991</xref>) and Prusinkiewicz et&#x000a0;al. (<xref ref-type="bibr" rid="CR40">1993</xref>); in the former case there is also in principle an optimization-based semantics for choosing which collection of discrete-time rules to fire.</p><p id="Par37">Parameterized reaction rule notation is fundamentally more powerful than pure chemical reactions, because now reaction/process rates <inline-formula id="IEq67"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _{r}( [ x_{p}] ,[ y_{q}] )$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq67.gif"/></alternatives></inline-formula> can be functions of all the parameters involved in a rule, <italic>and</italic> a rule firing event can change those parameters. It becomes possible to express sorcerer&#x02019;s apprentice models which purport to accomplish an infinite amount of computing in a finite simulated time, though this situation can also be avoided with extra constraints on the rate functions in the language.</p><p id="Par38">Brief comparisons to other rule- or grammar-like modeling languages, namely L-systems and the BioNetGen modeling languages, are provided in Supplementary Material Section 7.2.4. Another relevant graph rewrite rule modeling language is Kappa (Danos et&#x000a0;al. <xref ref-type="bibr" rid="CR7">2007</xref>) discussed in Sect.&#x000a0;<xref rid="Sec10" ref-type="sec">3.2</xref>.</p><p id="Par39">We have argued that summation of time-evolution operators corresponds to model compositionality in terms of processes. To a lesser extent, models are compositional in their <italic>objects</italic> as a result, since each object participates in a limited set of processes particularly if processes are disaggregated by spatial position as they will be in Sect.&#x000a0;<xref rid="Sec6" ref-type="sec">2.3</xref>; thus locality expressed as commutation of spacelike separated operators helps to license a degree of decomposition by object as well. But process compositionality is primary.</p><p id="Par40">Parameterized rewrite rule models would seem to be non-spatial, but particle movement through space can already be encoded using discrete or continuous parameters that denote spatial location. Such motion would however have to occur in discrete steps due to discrete-time rule firing. The solution to that limitation (among others) is another language escalation.</p></sec></sec><sec id="Sec6"><title>Differential Equation Rules</title><p id="Par41">Another form for parameterized rewrite rules licenses locally attached ordinary differential equations (ODEs) for continuous parameters, as in Mjolsness et&#x000a0;al. (<xref ref-type="bibr" rid="CR29">1991</xref>), Prusinkiewicz et&#x000a0;al. (<xref ref-type="bibr" rid="CR40">1993</xref>) and Mjolsness (<xref ref-type="bibr" rid="CR35">2013</xref>), as part of the language <italic>L</italic>:<disp-formula id="Equ10"><label>8</label><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned}&#x00026;{\left\{ \tau _{\alpha ( p) }[ x_{p}] |p \in L_{r}=R_{r} \right\} }_{*} \longrightarrow {\left\{ \tau _{\alpha ( p) }[ x_{p}+d x_{p}] | q \in R_{r}= L_{r} \right\} }_{*} \\&#x00026;\quad {\;\mathbf with \;} \Bigg \{ {d x_{p}}=v_{p}( \left[ x_{k}\right] ){d t} \Bigg | p \Bigg \} \text { , i.e., } \\&#x00026;{\left\{ \tau _{\alpha ( p) }[ x_{p}] |p \in L_{r}=R_{r} \right\} }_{*} \longrightarrow {\left\{ \tau _{\alpha ( p) }[ x_{p}] | q \in R_{r}= L_{r} \right\} }_{*} \\&#x00026;\quad {\; \mathbf with \;} \Bigg \{ \frac{\mathrm{d} x_{p,j}}{\mathrm{d} t}=v_{p,j}( \left[ x_{k}\right] ) \Bigg | p,j \Bigg \} , \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="M154" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mfenced close="}" open="{"><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>p</mml:mi><mml:mo>&#x02208;</mml:mo></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfenced><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">&#x027f6;</mml:mo><mml:msub><mml:mfenced close="}" open="{"><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>q</mml:mi><mml:mo>&#x02208;</mml:mo></mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfenced><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mrow><mml:mspace width="0.277778em"/><mml:mi mathvariant="bold">w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mspace width="0.277778em"/></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfenced close="]" open="["><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">|</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>, i.e.,</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mfenced close="}" open="{"><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>p</mml:mi><mml:mo>&#x02208;</mml:mo></mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfenced><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">&#x027f6;</mml:mo><mml:msub><mml:mfenced close="}" open="{"><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>q</mml:mi><mml:mo>&#x02208;</mml:mo></mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mfenced><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mrow><mml:mspace width="0.277778em"/><mml:mi mathvariant="bold">w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mspace width="0.277778em"/></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">{</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfenced close="]" open="["><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">|</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>where the second form uses component rather than vector notation for all the ODEs. The first form is more readily generalizable to stochastic differential equations (SDEs) <inline-formula id="IEq68"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{d x_{p}=v_{p}( [ x_{k}] ){d t} + w_{p}( [ x_{k}]) dB_t$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dt</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq68.gif"/></alternatives></inline-formula> where <inline-formula id="IEq69"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ dB_t$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>B</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq69.gif"/></alternatives></inline-formula> is a Brownian motion. The ODE semantics is given by the corresponding differential operators:<disp-formula id="Equ11"><label>9</label><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\hat{W}}}_{\mathrm {drift}}=-\int \mathrm{d}\left\{ x\right\} \int \mathrm{d}\left\{ y\right\} {\hat{a}}( \left[ y\right] ) a( \left[ x\right] ) \left( \sum \limits _{j}\nabla _{ y_{j}}v_{j}( \left[ y\right] ) \prod \limits _{k}\delta ( y_{k}-x_{k}) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="M160" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi mathvariant="normal">drift</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mo>&#x0222b;</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mfenced close="}" open="{"><mml:mi>x</mml:mi></mml:mfenced><mml:mo>&#x0222b;</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mfenced close="}" open="{"><mml:mi>y</mml:mi></mml:mfenced><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfenced close="]" open="["><mml:mi>y</mml:mi></mml:mfenced><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>a</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfenced close="]" open="["><mml:mi>x</mml:mi></mml:mfenced><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfenced close=")" open="("><mml:munder><mml:mo movablelimits="false">&#x02211;</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfenced close="]" open="["><mml:mi>y</mml:mi></mml:mfenced><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>as shown for example in Mjolsness (<xref ref-type="bibr" rid="CR35">2013</xref>). The SDE case is discussed in Mjolsness and Yosiphon (<xref ref-type="bibr" rid="CR31">2006</xref>, section 5.3).</p><p id="Par42">Equations (<xref rid="Equ8" ref-type="">6</xref>), (<xref rid="Equ10" ref-type="">8</xref>) and (28), (<xref rid="Equ11" ref-type="">9</xref>) comprise the syntax and semantics, respectively, of the basic ruleset portion of dynamical grammars (DG) language of Mjolsness and Yosiphon (<xref ref-type="bibr" rid="CR31">2006</xref>) and Yosiphon (<xref ref-type="bibr" rid="CR54">2009</xref>), by addition of differential equations to SPGs. A simulation algorithm is derived from the time-ordered product expansion in Mjolsness (<xref ref-type="bibr" rid="CR35">2013</xref>). The generalization to operator algebra semantics for partial differential equations (PDEs) and stochastic partial differential equations (SPDEs), as a limit of spatially discretized ODE and SDE systems, is outlined in Mjolsness (<xref ref-type="bibr" rid="CR33">2010</xref>). These differential equation bearing rules can be used to describe processes of growth and movement of individual particle-like objects, as in &#x0201c;agent-based&#x0201d; modeling. Further comments on differential equation rules are made in Supplementary Material 7.2.5. Further comments on the reduction relations between alternative semantic maps are made in Supplementary Material 7.2.6.</p><p id="Par43">Complex biological objects often have <italic>substructure</italic> whose dynamics is not easily captured by a fixed list of parameters and a rate function or differential equation that depends on those parameters. Extended objects such as molecular complexes, cytoskeletal networks, membranes, and tissues comprising many cells linked by extra-cellular matrix are all cases in point. There can and sometimes should be several levels of substructure in a single biological model. We now wish to extend the syntax and semantics of the foregoing class of declarative languages to handle extended objects systematically, by creating a compositional language and semantics for biological <italic>objects</italic> as well as processes, and then extending the semantics for processes accordingly. In the case of discrete substructure, this can be done with labeled graph structures (discussed in Sect.&#x000a0;<xref rid="Sec8" ref-type="sec">3.1</xref>). In some cases, the sub-objects (such as lipid molecules in a membrane, or long polymers in cytoskeleton) are so numerous that an approximate spatial continuum object model is justified and simpler than a large spatially discrete model. Spatial continuum models with geometric objects can be built out of manifolds and their embeddings, along with biophysical fields represented as functions defined on these geometries, in various ways we discuss in Sect.&#x000a0;<xref rid="Sec7" ref-type="sec">3</xref>.</p></sec></sec><sec id="Sec7"><title>Extended Objects</title><p id="Par44">Can we declaratively model non-pointlike, extended biological objects such as polymer networks, membranes, or entire tissues in biological development? To achieve constructive generality in treating such extended objects we introduce, in Sect.&#x000a0;<xref rid="Sec8" ref-type="sec">3.1</xref>, ideas based on discrete graphs and their possible continuum limits. These ideas include: graded graphs, abstract cell complexes, stratified graphs, and combinations of these ideas. Dynamics by rewrite rules, beginning with graph rewrite rules, are developed in Sect.&#x000a0;<xref rid="Sec10" ref-type="sec">3.2</xref>. In Supplementary Material Section&#x000a0;7.4.2, we discuss the more general nonconstructive types of extended objects that we may wish to approximate constructively; here, we turn to constructive types of extended objects.</p><sec id="Sec8"><title>Constructive Extended Objects via Graphs</title><p id="Par45">Discrete graphs, especially when augmented with labels, are mathematical objects that can represent computable objects and expressions at a high level of abstraction. In Supplementary Material Section&#x000a0;7.2.7, we give standard definitions of graphs (directed and undirected) and graph homomorphisms, and thence (vertex-)labeled graphs, bipartite graphs, cliques, trees, directed acyclic graphs (DAGs), and their use in abstract syntax trees; also the standard functors from undirected to directed graphs and from edge-labeled to vertex-labeled graphs; also binary graph operators including graph sum, cross product, box product, strong product, and graph function.</p><p id="Par46">A special case of a labeled graph is a <italic>numbered graph</italic> with integer labels <inline-formula id="IEq70"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _i^{\prime } = i$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:msubsup><mml:mi>&#x003bb;</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq70.gif"/></alternatives></inline-formula>, <inline-formula id="IEq71"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{\varLambda }^{\prime }| \geqslant |V|$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi>&#x0039b;</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02a7e;</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq71.gif"/></alternatives></inline-formula>, and the labeled graph homomorphism to <inline-formula id="IEq72"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${K}^+_{{\varLambda }^\prime }$$\end{document}</tex-math><mml:math id="M166"><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mi>&#x0039b;</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>+</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq72.gif"/></alternatives></inline-formula> is one-to-one (but not necessarily onto), so each vertex receives a unique number in <inline-formula id="IEq73"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varLambda }^\prime = \{1 \ldots k \geqslant |V|\}$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x0039b;</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02026;</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02a7e;</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq73.gif"/></alternatives></inline-formula>. Then, one way to express a labeled graph <inline-formula id="IEq74"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G \rightarrow _\text {Graph} {K}^+_{{\varLambda }}$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mtext>Graph</mml:mtext></mml:msub><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mi>&#x0039b;</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq74.gif"/></alternatives></inline-formula> is as the composition <inline-formula id="IEq75"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G \rightarrow _\text {Graph} {K}^+_{{\varLambda }^\prime } \rightarrow _\text {Graph} {K}^+_{{\varLambda }}$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mtext>Graph</mml:mtext></mml:msub><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mi>&#x0039b;</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>+</mml:mo></mml:msubsup><mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mtext>Graph</mml:mtext></mml:msub><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mi>&#x0039b;</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq75.gif"/></alternatives></inline-formula> of a graph numbering <inline-formula id="IEq76"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G \rightarrow _\text {Graph} {K}^+_{{\varLambda }^\prime } $$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mi>G</mml:mi><mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mtext>Graph</mml:mtext></mml:msub><mml:msubsup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mi>&#x0039b;</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq76.gif"/></alternatives></inline-formula> followed by a relabeling determined by a mapping of sets <inline-formula id="IEq77"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varLambda }^\prime } \rightarrow _\text {Set} {{\varLambda }} \mathbin {{\dot{\cup }}} \{\varnothing \}$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x0039b;</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mtext>Set</mml:mtext></mml:msub><mml:mi>&#x0039b;</mml:mi><mml:mover accent="true"><mml:mo>&#x0222a;</mml:mo><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>&#x02205;</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq77.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq78"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varnothing $$\end{document}</tex-math><mml:math id="M178"><mml:mi>&#x02205;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq78.gif"/></alternatives></inline-formula> the value taken on unused number labels <italic>i</italic>. The possibility of unused numbers (<inline-formula id="IEq79"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{\varLambda }^{\prime }| \geqslant |V|$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi>&#x0039b;</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02a7e;</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq79.gif"/></alternatives></inline-formula>) will be needed when consistently labeling two different graphs. We consider graph homomorphisms to five particular integer-labeled graphs defined carefully in Supplementary Material Section&#x000a0;7.2.8: <inline-formula id="IEq80"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb {N}}}^+ $$\end{document}</tex-math><mml:math id="M182"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq80.gif"/></alternatives></inline-formula>, the nonnegative integers with successor links, for level number labels; <inline-formula id="IEq81"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${J}^+_D$$\end{document}</tex-math><mml:math id="M184"><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mi>D</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq81.gif"/></alternatives></inline-formula>, the integers <inline-formula id="IEq82"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{0, \ldots D\}$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq82.gif"/></alternatives></inline-formula> with direct and indirect predecessor links, for dimension labels; <inline-formula id="IEq83"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\mathbb {N}}}}_D^{+ \text {op}}$$\end{document}</tex-math><mml:math id="M188"><mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mtext>op</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq83.gif"/></alternatives></inline-formula>, the integers <inline-formula id="IEq84"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{0, \ldots D\}$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq84.gif"/></alternatives></inline-formula> with direct predecessor links; <inline-formula id="IEq85"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_D \equiv {{\mathbb {N}}}^+ \Box {J}^+_{D}$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>&#x02261;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>&#x025a1;</mml:mo><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mi>D</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq85.gif"/></alternatives></inline-formula>; and <inline-formula id="IEq86"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\tilde{C}}}_D \equiv {{\mathbb {N}}}^+ \Box {{{\mathbb {N}}}}_D^{+ \text {op}}$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>D</mml:mi></mml:msub><mml:mo>&#x02261;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>&#x025a1;</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mtext>op</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq86.gif"/></alternatives></inline-formula>. Then, we can define the following:</p><p id="Par47">A <italic>graded graph</italic> is a homomorphism from a graph <italic>G</italic> to <inline-formula id="IEq87"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb {N}}}^+$$\end{document}</tex-math><mml:math id="M196"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq87.gif"/></alternatives></inline-formula>. It labels vertices by a level number. Additional assumptions may allow an undirected graded graph to &#x0201c;approach&#x0201d; a continuum topology such as a manifold or other metric space, in the limit of large level number. The metric can be derived via a limit of a diffusion process on graphs. For example, <italic>D</italic>-dimensional rectangular meshes approach <inline-formula id="IEq88"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb {R}}}^D$$\end{document}</tex-math><mml:math id="M198"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq88.gif"/></alternatives></inline-formula> this way (e.g., Mjolsness and Cunha <xref ref-type="bibr" rid="CR34">2012</xref>).</p><p id="Par48">A <italic>stratified graph</italic> of dimension <italic>D</italic> is a homomorphism from a graph <italic>G</italic> to <inline-formula id="IEq89"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${J}_D^+$$\end{document}</tex-math><mml:math id="M200"><mml:msubsup><mml:mi>J</mml:mi><mml:mi>D</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq89.gif"/></alternatives></inline-formula>. It labels vertices by a &#x0201c;dimension&#x0201d; of the stratum of the stratum they are in. The reason for reversing the edges in the directed graph case, compared to the graded graph definition, is that the level-changing edges then correspond to standard boundary relationships from higher to lower dimensional strata. In the undirected graph case, such a homomorphism is equivalent to a graph whose vertices are labeled by dimension number, since it imposes no constraints on edges.</p><p id="Par49"><italic>Abstract cell complex</italic> a special case of a stratified graph of dimension <italic>D</italic> is a graph homomorphism from <italic>G</italic> to <inline-formula id="IEq90"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb {N}}}_D^{+ \text {op}}$$\end{document}</tex-math><mml:math id="M202"><mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mtext>op</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq90.gif"/></alternatives></inline-formula>, the directed graph of integers <inline-formula id="IEq91"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{0, \ldots D\}$$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq91.gif"/></alternatives></inline-formula> with self-connections and immediate predecessor connections <inline-formula id="IEq92"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\rightarrow i-1$$\end{document}</tex-math><mml:math id="M206"><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq92.gif"/></alternatives></inline-formula> within the set. Since <inline-formula id="IEq93"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb {N}}}_D^{+ \text {op}}$$\end{document}</tex-math><mml:math id="M208"><mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mtext>op</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq93.gif"/></alternatives></inline-formula> maps to <inline-formula id="IEq94"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${J}^+_{D}$$\end{document}</tex-math><mml:math id="M210"><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mi>D</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq94.gif"/></alternatives></inline-formula> by graph homomorphism, this is (equivalent to) a special case of stratified graphs.</p><p id="Par50">A <italic>graded stratified graph</italic> of dimension <italic>D</italic> is a graph homomorphism from <italic>G</italic> to <inline-formula id="IEq95"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_D = {{\mathbb {N}}}^+ \Box {J}^+_{D}$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>&#x025a1;</mml:mo><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mi>D</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq95.gif"/></alternatives></inline-formula>. Two nodes in <inline-formula id="IEq96"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_D$$\end{document}</tex-math><mml:math id="M214"><mml:msub><mml:mi>C</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq96.gif"/></alternatives></inline-formula> are connected, permitting corresponding edge connections in <italic>G</italic>, iff either their level numbers are equal (and, in the directed case, the source node dimension is <inline-formula id="IEq97"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\geqslant $$\end{document}</tex-math><mml:math id="M216"><mml:mo>&#x02a7e;</mml:mo></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq97.gif"/></alternatives></inline-formula> the target node dimension), or if their level numbers differ by one and their dimensions are equal. Because <italic>G</italic> projects to both <inline-formula id="IEq98"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb {N}}}^+$$\end{document}</tex-math><mml:math id="M218"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq98.gif"/></alternatives></inline-formula> and <inline-formula id="IEq99"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${J}^+_{D}$$\end{document}</tex-math><mml:math id="M220"><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mi>D</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq99.gif"/></alternatives></inline-formula>, a graded stratified graph maps straightforwardly (by functors) to both a graded graph and to a stratified graph. However, it enforces an additional consistency constraint on level number and dimension: they cannot both change along one edge (and, in the directed case, the source node dimension must be <inline-formula id="IEq100"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\geqslant $$\end{document}</tex-math><mml:math id="M222"><mml:mo>&#x02a7e;</mml:mo></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq100.gif"/></alternatives></inline-formula> the target node dimension).</p><p id="Par51">A <italic>graded abstract cell complex</italic> of dimension <italic>D</italic> is likewise a graph homomorphism from <italic>G</italic> to <inline-formula id="IEq101"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{C}}_D = {{\mathbb {N}}}^+ \Box {{\mathbb {N}}}_D^{+ \text {op}}$$\end{document}</tex-math><mml:math id="M224"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>D</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>&#x025a1;</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mtext>op</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq101.gif"/></alternatives></inline-formula>.</p><p id="Par52">Our aim with these definitions is to discretely and computably model continuum stratified spaces (including cell complexes) in the limit of sufficiently large level numbers. Stratified spaces are topological spaces decomposable into manifolds in more general ways than CW cell complexes are. In addition, we would like each manifold to be a differentiable manifold with a metric related to a Laplacian, since that will be the case in modeling spatially extended biological or physical objects.</p><p id="Par53">Thus, we arrive at the constructive <italic>slice categories</italic><inline-formula id="IEq102"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S(H): G \rightarrow H$$\end{document}</tex-math><mml:math id="M226"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq102.gif"/></alternatives></inline-formula> with morphisms <inline-formula id="IEq103"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h: G \rightarrow H$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:mi>h</mml:mi><mml:mo>:</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq103.gif"/></alternatives></inline-formula> that makes a commutative diagram <inline-formula id="IEq104"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varphi _G = h \circ \varphi _{G^{\prime }}$$\end{document}</tex-math><mml:math id="M230"><mml:mrow><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mo>&#x02218;</mml:mo><mml:msub><mml:mi>&#x003c6;</mml:mi><mml:msup><mml:mi>G</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq104.gif"/></alternatives></inline-formula>: <graphic position="anchor" xlink:href="11538_2019_628_Figa_HTML" id="MO15"/>where <inline-formula id="IEq105"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H = {{\mathbb {N}}}^+, \;\; {J}_D^+, \;\; {{\mathbb {N}}}_D^{+ \text {op}}, \;\; C_D, \;\; \mathrm{or } \;\; {\tilde{C}}_D$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:msubsup><mml:mi>J</mml:mi><mml:mi>D</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mtext>op</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:msub><mml:mi>C</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mi mathvariant="normal">or</mml:mi><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:msub><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq105.gif"/></alternatives></inline-formula>. Here, it is essential that each possible target graph <italic>H</italic> includes all self-connections. In particular, a homomorphism of graded graphs is a graph homomorphism with <inline-formula id="IEq106"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H={{\mathbb {N}}}^+$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq106.gif"/></alternatives></inline-formula>, so graded graphs together with level-preserving graph homomorphisms form a slice category.</p><p id="Par54">For a discrete approximation to a stratified space by a stratified graph, we can identify the &#x0201c;graph strata,&#x0201d; and their interconnections by boundary relationships, as connected components of constant dimension. So, by eliminating links between nodes of different dimension, and then finding the connected components that remain, we identify the <italic>strata</italic> in a stratified graph (or in a stratified labeled graph). In this commutative diagram: <graphic position="anchor" xlink:href="11538_2019_628_Figb_HTML" id="MO16"/>each inverse image <inline-formula id="IEq107"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\chi _{G_S}^{-1})(d)$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>&#x003c7;</mml:mi><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq107.gif"/></alternatives></inline-formula> must be a fully disconnected graph, with each vertex then corresponding (by <inline-formula id="IEq108"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h^{-1})$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq108.gif"/></alternatives></inline-formula> to a <italic>d</italic>-dimensional stratum (maximal connected <italic>d</italic>-dimensional component) in <italic>G</italic>. The directed graph associated to <inline-formula id="IEq109"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_S$$\end{document}</tex-math><mml:math id="M240"><mml:msub><mml:mi>G</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq109.gif"/></alternatives></inline-formula> (directed by dimension number in the case of undirected graphs) is a DAG, due to disconnection within each dimension. The graph homomorphism <italic>h</italic> becomes a homomorphism of stratified graphs.</p><sec id="FPar1"><title>Observation 1</title><p id="Par55">The resulting <inline-formula id="IEq110"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_S$$\end{document}</tex-math><mml:math id="M242"><mml:msub><mml:mi>G</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq110.gif"/></alternatives></inline-formula> in Diagram 2 is the graph of strata, a minimal structure for modeling complex geometries. <italic>It is therefore a natural graph on which to specify rewriting rules for major structure-changing processes</italic> such as biological cell division, mitochondrial fission/fusion, neurite or cytoskeletal branching, and other essential processes of biological development.</p><p>The geometry of cytoskeleton, in particular, is better captured by stratified graphs and stratified spaces than by cell complexes, because 1D and 0D cytoskeleton is often embedded directly into 3D cytosol rather than into 2D membrane structures (this violates the CW complex assumption that cells are <italic>d</italic>-dimensional balls, whose boundaries map continuously into finite unions of lower dimensional balls, both because dimension 2 is skipped between 3 and 1, and because 3D cytosol is not generally homeomorphic to a ball if it can be punctured by a <inline-formula id="IEq111"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\hbox {D}+0\hbox {D}$$\end{document}</tex-math><mml:math id="M244"><mml:mrow><mml:mn>1</mml:mn><mml:mtext>D</mml:mtext><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:mtext>D</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq111.gif"/></alternatives></inline-formula> cytoskeleton with 1D loops and/or multiple anchor points in the biological cell&#x02019;s surface).</p><p>In many developmental biology systems, the spatial dynamics involves nontrivial changes in geometry and/or topology of extended biological objects. By using rewrite rules for the graph of strata, together ODE-bearing rules for the parametric embeddings of individual strata into 3D space, we now have in principle a way to represent such dynamics mathematically and computationally.</p></sec><sec id="FPar2"><title>Observation 2</title><p id="Par58">In a graded stratified graph (and therefore also in a graded abstract cell complex), a useful special case occurs if <inline-formula id="IEq112"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_S$$\end{document}</tex-math><mml:math id="M246"><mml:msub><mml:mi>G</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq112.gif"/></alternatives></inline-formula> restricted by level number stabilizes beyond a constant number of levels, so the description in terms of strata has a continuum limit <inline-formula id="IEq113"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G^*_S$$\end{document}</tex-math><mml:math id="M248"><mml:msubsup><mml:mi>G</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq113.gif"/></alternatives></inline-formula>. In that case, <italic>the limiting</italic><inline-formula id="IEq114"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_S$$\end{document}</tex-math><mml:math id="M250"><mml:msub><mml:mi>G</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq114.gif"/></alternatives></inline-formula><italic>is also the natural locus for verification of compatible boundary conditions between PDEs</italic> of different dimensionality governing the evolution of biophysical fields defined on continuum-limit strata. Here, &#x0201c;compatibility&#x0201d; includes local conservation laws.</p><p>The edges remaining in <inline-formula id="IEq115"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_S$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mi>G</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq115.gif"/></alternatives></inline-formula>, connecting strata of unequal dimensionality, model in-contact relations such as &#x0201c;boundary&#x0201d; and/or &#x0201c;inside&#x0201d;. Further constraints are needed to disentangle these alternatives. Similar ideas to <inline-formula id="IEq116"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G^*_S$$\end{document}</tex-math><mml:math id="M254"><mml:msubsup><mml:mi>G</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02217;</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq116.gif"/></alternatives></inline-formula> may be involved in the &#x0201c;persistent homology&#x0201d; approach to unsupervised learning of data structure (Bendich et&#x000a0;al. <xref ref-type="bibr" rid="CR3">2007</xref>). A further discussion of the relation between stratified graphs abstract cell complexes as defined here, and abstract cell complexes as defined elsewhere is given in Supplementary Material Section&#x000a0;7.2.8.</p><p>Given an extended object <italic>G</italic> constructed as outlined here, it is generally also necessary to define some dynamics that run &#x0201c;in&#x0201d; or &#x0201c;on&#x0201d; such an object: diffusing or otherwise moving particles with position <inline-formula id="IEq117"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in G$$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq117.gif"/></alternatives></inline-formula> described by a spatial probability distribution <italic>p</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>), or other dynamical fields <italic>f</italic>(<italic>x</italic>) at a given moment of time <italic>t</italic>. Several approaches to this issue are outlined in Supplementary Material Section 7.4.3.</p></sec><sec id="Sec9"><title>Relation to PDEs</title><p id="Par61">If some of the strata in <inline-formula id="IEq118"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_S$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mi>G</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq118.gif"/></alternatives></inline-formula> are host to partial differential equations (respecting possibly dynamical boundary conditions at adjacent lower and higher dimensional strata) then <inline-formula id="IEq119"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_S$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mi>G</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq119.gif"/></alternatives></inline-formula> will be too minimal for solution algorithms like finite elements or finite volumes, and those strata may have to be meshed. In that case, the strata of <inline-formula id="IEq120"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_S$$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mi>G</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq120.gif"/></alternatives></inline-formula> may need to be subdivided sufficiently finely into patches that can each host a local coordinate system, compatible with its neighboring patches of different dimension and (under one possible strategy) separated by extra artificial boundary strata patches from its neighbors of the same dimension. More detailed approaches to this issue are outlined in Supplementary Material Section 7.4.3.</p><p id="Par62">By these various means, one would like to generalize from ODE-bearing rules to PDE-bearing rules which would be of two basic types: (1) PDEs for the evolution of biophysical fields such as diffusion within a manifold (possibly including a hyperbolic term for finite speed <italic>causal</italic> information propagation, as in the hyperbolic Telegrapher&#x02019;s Equation derivable for stochastic diffusion (Kac <xref ref-type="bibr" rid="CR24">1974</xref>) which has as a limit the parabolic heat equation), and (2) PDEs for the evolution of the embeddings of strata into higher strata, such as cytoskeleton mechanics (1D into 2D or 3D) or the biomechanics of 2D membranes embedded into ordinary three dimensional Euclidean space. This could be accomplished by way of level sets and local stress fields, for example.</p><p id="Par63">Such dynamic biophysical fields can also influence the (discontinuous and usually much slower) topology-changing dynamics by which the number and connectivity of a model&#x02019;s geometric strata change&#x02014;such as in plant or animal cell division. We study such dynamic graph structure next.</p></sec></sec><sec id="Sec10"><title>Dynamics of Graphs</title><p id="Par64">There are at least two ways to mathematically define the semantics of graph rewrite rules for use in biological modeling of extended objects. The operator algebra approach pursued in this paper, extending the form of rewrite rule semantics given in Sect.&#x000a0;<xref rid="Sec2" ref-type="sec">2</xref>, has been used as the theory behind some molecular complex modeling and tissue-level developmental modeling methods (Johnson et&#x000a0;al. <xref ref-type="bibr" rid="CR18">2015</xref>; Mjolsness <xref ref-type="bibr" rid="CR35">2013</xref>). It takes advantage of the algebra of operators to blend with continuous-time process models by scalar multiplication of rates and operator addition of parallel processes, thereby also gaining compatibility with quantitative methods of statistical mechanics and field theory in physics, and with machine learning by continuous optimization. The essential step is to express natural graph-changing operations, including a collection of graph rewrite rules, in terms of an operator algebra generated by the operators for the individual rules. A second approach, the graph homomorphism pushout diagram approach championed in Ehrig et&#x000a0;al. (<xref ref-type="bibr" rid="CR12">2006</xref>), has been used in molecular complex modeling (Danos et&#x000a0;al. <xref ref-type="bibr" rid="CR8">2012</xref>) by providing a mathematical semantics for the &#x0201c;Kappa&#x0201d; modeling language (Danos et&#x000a0;al. <xref ref-type="bibr" rid="CR7">2007</xref>). It takes advantage of the category theory formulation of graphs, discussed above. We will first develop operator algebra semantics for graph grammars in continuous time in detail. Then, we will briefly compare it with the pushout semantics approach which leverages category theory in a way similar to our discussion above.</p><sec id="Sec11"><title>Graph Rewrite Rule Operators</title><p id="Par65">By generating unique (e.g., integer-valued) &#x0201c;ObjectID&#x0201d; parameters for each new object created in a parameterized grammar rule, it is possible to implement graph grammar rules by parameterized grammar rules (Sect.&#x000a0;<xref rid="Sec4" ref-type="sec">2.2</xref>) alone, just using repeated ObjectID values to represent graph links. Since parameterized grammar rules are mapped by semantic map <inline-formula id="IEq121"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }(M)$$\end{document}</tex-math><mml:math id="M264"><mml:mrow><mml:mi>&#x003a8;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq121.gif"/></alternatives></inline-formula> to an operator algebra, the composition of two maps <inline-formula id="IEq122"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\mathcal {I}}}} \circ {\varPsi }$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mi mathvariant="script">I</mml:mi><mml:mo>&#x02218;</mml:mo><mml:mi>&#x003a8;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq122.gif"/></alternatives></inline-formula> defines an operator algebra semantics for graph grammars. This route was detailed in Mjolsness (<xref ref-type="bibr" rid="CR30">2005</xref>) and Mjolsness and Yosiphon (<xref ref-type="bibr" rid="CR31">2006</xref>), and implemented declaratively in Yosiphon (<xref ref-type="bibr" rid="CR54">2009</xref>). But it is also possible (Mjolsness <xref ref-type="bibr" rid="CR33">2010</xref>) to define graph grammar rewrite rule semantics directly as a continuous-time dynamical system, using operator algebra as in the previous semantics definitions of Sect.&#x000a0;<xref rid="Sec2" ref-type="sec">2</xref>.</p><p id="Par66">Suppose we have two labeled graphs <inline-formula id="IEq123"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G _1: G^{\text {pure}}_1 \rightarrow _\text {Graph} K^+_{{\varLambda }_1}$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mn>1</mml:mn><mml:mtext>pure</mml:mtext></mml:msubsup><mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mtext>Graph</mml:mtext></mml:msub><mml:msubsup><mml:mi>K</mml:mi><mml:msub><mml:mi>&#x0039b;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq123.gif"/></alternatives></inline-formula> and <inline-formula id="IEq124"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_2: G^{\text {pure}}_2 \rightarrow _\text {Graph} K^+_{{\varLambda }_2}$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mn>2</mml:mn><mml:mtext>pure</mml:mtext></mml:msubsup><mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mtext>Graph</mml:mtext></mml:msub><mml:msubsup><mml:mi>K</mml:mi><mml:msub><mml:mi>&#x0039b;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq124.gif"/></alternatives></inline-formula>. We decompose them each into a numbered graph <inline-formula id="IEq125"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G^{\text {num}}_i : G^{\text {pure}}_i \rightarrow _\text {Graph} K^+_{\{1,\ldots k_i \geqslant |V_i|\}} $$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:msubsup><mml:mi>G</mml:mi><mml:mi>i</mml:mi><mml:mtext>num</mml:mtext></mml:msubsup><mml:mo>:</mml:mo><mml:msubsup><mml:mi>G</mml:mi><mml:mi>i</mml:mi><mml:mtext>pure</mml:mtext></mml:msubsup><mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mtext>Graph</mml:mtext></mml:msub><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02a7e;</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq125.gif"/></alternatives></inline-formula> and a relabeling <inline-formula id="IEq126"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ K^+_{\{1,\ldots k_i \geqslant |V_i|\}} \rightarrow _\text {Graph} K^+_{{\varLambda }_i}$$\end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02a7e;</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mtext>Graph</mml:mtext></mml:msub><mml:msubsup><mml:mi>K</mml:mi><mml:msub><mml:mi>&#x0039b;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq126.gif"/></alternatives></inline-formula> determined by a mapping of sets <inline-formula id="IEq127"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{1,\ldots k_i \} \rightarrow _\text {Set} {{\varLambda }_i}$$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mtext>Set</mml:mtext></mml:msub><mml:msub><mml:mi>&#x0039b;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq127.gif"/></alternatives></inline-formula>, determined in turn by an ordered listing of labels <inline-formula id="IEq128"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\lambda }}_i$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq128.gif"/></alternatives></inline-formula>, possibly augmented by the nullset symbol <inline-formula id="IEq129"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varnothing $$\end{document}</tex-math><mml:math id="M280"><mml:mi>&#x02205;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq129.gif"/></alternatives></inline-formula>. The whole decomposition can be denoted <inline-formula id="IEq130"><inline-graphic xlink:href="11538_2019_628_IEq130_HTML.gif"/></inline-formula>. We are interested in graph rewrite rules <inline-formula id="IEq131"><inline-graphic xlink:href="11538_2019_628_IEq131_HTML.gif"/></inline-formula> that respect a single consistent numbering of vertices of the two numbered graphs before their relabelings. In that case, vertices in <inline-formula id="IEq132"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_1$$\end{document}</tex-math><mml:math id="M282"><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq132.gif"/></alternatives></inline-formula> and <inline-formula id="IEq133"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_2$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq133.gif"/></alternatives></inline-formula> that share a vertex number are regarded as &#x0201c;the same&#x0201d; vertex <italic>v</italic>, before and after rewriting (similar to the shared graph &#x0201c;<italic>K</italic>&#x0201d; in the double pushout approach discussed in Supplementary Material Section&#x000a0;7.2.10), so that any graph edges contacting <italic>v</italic> and not mentioned in the rewrite rule are preserved.</p><p id="Par67"><italic>3.2.1.1 Graph Rewrite Rule Examples</italic> Here (Eq.&#x000a0;<xref rid="Equ12" ref-type="">10</xref>) is an example pertaining to refinement of triangular meshes in 2D. This is one of four rewrite rules that suffice to implement a standard triangular mesh refinement scheme [similar examples were studied in Maignan et&#x000a0;al. (<xref ref-type="bibr" rid="CR26">2015</xref>)]. Three of those rules including this one deal with partially refined triangle edges, an intermediate state produced by the previous refinement of nearby triangles. It can also be interpreted as an (unlabeled) graded graph rewrite rule since it preserves the graded graph constraints on level numbers <italic>l</italic>, if they are satisfied initially (the other rewrite rules are similar but deal with the cases of zero, two, or three partially refined triangle sides). The labeled graph rewrite rule is:<disp-formula id="Equ12"><label>10</label><graphic xlink:href="11538_2019_628_Equ12_HTML.gif" position="anchor"/></disp-formula>Note that in this example, there is a shared numbering of nodes of the two graphs, and node numbers 1&#x02013;4 occur in both graphs. This is equivalent to identifying the shared subgraph <italic>K</italic> in the double pushout semantics of Diagram 4 in Supplementary Material Section&#x000a0;7.2.10. Any extra edges that contact nodes 1&#x02013;4 in a subgraph of the pool graph, e.g., parts of other nearby triangles, will remain after this rule fires. The other required rules are discussed in Supplementary Material Section&#x000a0;7.3.4, along with several variant grammars that would refine an initial triangular mesh in different ways.</p><p id="Par68">In addition to the forgoing geometric example, we consider briefly how one might express some of the dynamics of visible plant cortical microtubule bundles previously described, in particular growth at a growing end (whether <inline-formula id="IEq134"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$+$$\end{document}</tex-math><mml:math id="M286"><mml:mo>+</mml:mo></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq134.gif"/></alternatives></inline-formula> or &#x02212; ends of individual MTs in the bundle); retraction at a retracting end, and bundling following front-to-side collision, in terms of graph grammar rules. Let a microtubule be an extended object represented as a chain of super-particles (each much larger than a tubulin dimer, representing a roughly straight cylindrical segment of one MT of length approximately on a lengthscale <italic>L</italic> that is several times an MT diameter, <italic>or</italic> of a parallel and/or antiparallel bundle of a few such cylindrical segments). Continuous parameters of such a fiber segment super-particle will include its center-of-mass position, and a unit vector pointing toward the growing end and away from the retracting end of an end segment (interior segments will have lengthwise unit vectors too, but their sign shouldn&#x02019;t matter). Discrete parameters will include a four-valued categorical label <inline-formula id="IEq135"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s \in \{{\text {internal}}, {\text {grow}}\_{{\text {end}}}, {\text {retract}}\_{{\text {end}}}, {\text {junct}} \}$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:mi>s</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mtext>internal</mml:mtext><mml:mo>,</mml:mo><mml:mtext>grow</mml:mtext><mml:mi>_</mml:mi><mml:mtext>end</mml:mtext><mml:mo>,</mml:mo><mml:mtext>retract</mml:mtext><mml:mi>_</mml:mi><mml:mtext>end</mml:mtext><mml:mo>,</mml:mo><mml:mtext>junct</mml:mtext><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq135.gif"/></alternatives></inline-formula> (or <inline-formula id="IEq136"><inline-graphic xlink:href="11538_2019_628_IEq136_HTML.gif"/></inline-formula> in diagrams) for status as interior segment, growth-capable end segment, retraction-capable end, or junction segment, respectively.</p><p id="Par69">A diagrammatic presentation of an MT graph grammar, with subscripts for the rule-local arbitrary but consistent numbering of vertices in left- and right-hand-side graphs of each rule, is here:<disp-formula id="Equ13"><label>11</label><graphic xlink:href="11538_2019_628_Equ13_HTML.gif" position="anchor"/></disp-formula>A corresponding textual presentation of this MT dynamic graph grammar (DGG) is given in Supplementary Material Section 7.3.3.</p><p id="Par70"><italic>3.2.1.2 Graph Rewrite Rule Theory</italic><italic>In general</italic> now, suppose <italic>G</italic> and <inline-formula id="IEq137"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G^{\prime } $$\end{document}</tex-math><mml:math id="M290"><mml:msup><mml:mi>G</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq137.gif"/></alternatives></inline-formula> are numbered graphs sharing a common numbering of their vertices, with index-ordered adjacency matrices <inline-formula id="IEq138"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[g_{p q} | p, q]$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="italic">pq</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq138.gif"/></alternatives></inline-formula> and <inline-formula id="IEq139"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[g^{\prime }_{p^{\prime } q^{\prime }} | p^{\prime }, q^{\prime }]$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:msup><mml:mi>q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq139.gif"/></alternatives></inline-formula> whose elements take values in <inline-formula id="IEq140"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{0,1\}$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq140.gif"/></alternatives></inline-formula>. Then, an unambiguous graph rewrite rule can be expressed as:<disp-formula id="Equ14"><label>12</label><graphic xlink:href="11538_2019_628_Equ14_HTML.gif" position="anchor"/></disp-formula>where the double angle brackets denote label substitutions: <inline-formula id="IEq141"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma (1) \mapsto \lambda _1, \sigma (2) \mapsto \lambda _2, \dots $$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:mi>&#x003c3;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x021a6;</mml:mo><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003c3;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x021a6;</mml:mo><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq141.gif"/></alternatives></inline-formula> and <inline-formula id="IEq142"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^{\prime }(1) \mapsto \lambda ^{\prime }_1, \sigma ^{\prime }(2) \mapsto \lambda ^{\prime }_2, \dots $$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:msup><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x021a6;</mml:mo><mml:msubsup><mml:mi>&#x003bb;</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x021a6;</mml:mo><mml:msubsup><mml:mi>&#x003bb;</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq142.gif"/></alternatives></inline-formula> where <inline-formula id="IEq143"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma : {{\mathbb {N}}} \rightarrow {{\mathbb {N}}} $$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:mi>&#x003c3;</mml:mi><mml:mo>:</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq143.gif"/></alternatives></inline-formula> and <inline-formula id="IEq144"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^{\prime }: {{\mathbb {N}}} \rightarrow {{\mathbb {N}}} $$\end{document}</tex-math><mml:math id="M304"><mml:mrow><mml:msup><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>:</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq144.gif"/></alternatives></inline-formula> are strictly monotonically increasing mappings of initial segments of integers into the shared index space.</p><p id="Par71">Given the foregoing graph rewrite rule syntax for graphs <italic>G</italic> and <inline-formula id="IEq145"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G^{\prime }$$\end{document}</tex-math><mml:math id="M306"><mml:msup><mml:mi>G</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq145.gif"/></alternatives></inline-formula> with adjacency matrices <italic>g</italic> and <inline-formula id="IEq146"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g^{\prime }$$\end{document}</tex-math><mml:math id="M308"><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq146.gif"/></alternatives></inline-formula>, we now define an operator algebra semantics sufficient to bring all such graph rewrite rules into the general operator algebra/master equation formalism of previous sections. This is necessary to incorporate all the capabilities of the previously discussed languages by summing up time-evolution operators of the corresponding old and new kinds.</p><p id="Par72">We give graph grammar rule operator semantics for the case of directed graphs in terms of binary state vectors for node and edge existence; in this case creation and annihilation operators all have dimension <inline-formula id="IEq147"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2 \times 2$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:mn>2</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq147.gif"/></alternatives></inline-formula>. As before, the notation is that indices may have primes or subscripts and are usually deployed as follows: <italic>r</italic> indexes rewrite rules, <italic>i</italic> and <italic>j</italic> index individual domain objects (now nodes or vertices in a graph), <inline-formula id="IEq148"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="M312"><mml:mi>&#x003b1;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq148.gif"/></alternatives></inline-formula> and <inline-formula id="IEq149"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \beta $$\end{document}</tex-math><mml:math id="M314"><mml:mi>&#x003b2;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq149.gif"/></alternatives></inline-formula> are generic indices or multiple indices, and <italic>p</italic> and <italic>q</italic> index elements in either side of a rule. Assuming there is at least one label that can be used to indicate node allocation from available memory, and provided the global state is initialized to have zero probability of active edges for unused nodes, then the off-diagonal portion of the operator algebra semantics is slightly modified from Mjolsness (<xref ref-type="bibr" rid="CR33">2010</xref>):<disp-formula id="Equ15"><label>13</label><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned}&#x00026;{{\hat{W}}}_{r} \; \propto \; \rho _{r}({{\varvec{\lambda }}} , {{\varvec{\lambda }}^{\prime }}) \sum \limits _{{\langle i_{1},\ldots i_{k}\rangle }_{\ne }} \Bigg [ \prod \limits _{p \in {\text {lhs}}(r) {\setminus } {\text {rhs}}(r)} \Big ( \prod _i E_{i_{p} \; i} E_{i \; i_{p}} \Big ) \Bigg ] \\&#x00026;\quad \times \Bigg [ \prod \limits _{p^{\prime }, q^{\prime } \in {\text {rhs}}( r) } {\left( {{\hat{a}}}_{i_{p^{\prime }} i_{q^{\prime }}}\right) }^{{g^{\prime }}_{p^{\prime } \; q^{\prime } }} \Bigg ] \Bigg [ \prod \limits _{p^{\prime } \in {\text {rhs}}( r) } {{\hat{a}}}_{i_{p^{\prime }} {\lambda ^{\prime }}_{p^{\prime }}} \Bigg ] \\&#x00026;\quad \times \Bigg [ \prod \limits _{p, q \in {\text {lhs}}( r) } {\left( a_{i_{p} i_{q}}\right) }^{g_{p \; q}} \Bigg ] \Bigg [ \prod \limits _{p \in {\text {lhs}}(r) } a_{i_{p} \lambda _{p}} \Bigg ] . \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="M316" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub><mml:mspace width="0.277778em"/><mml:mo>&#x0221d;</mml:mo><mml:mspace width="0.277778em"/><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x02211;</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">&#x027e8;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">&#x027e9;</mml:mo></mml:mrow><mml:mo>&#x02260;</mml:mo></mml:msub></mml:munder><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mtext>lhs</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mtext>rhs</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:munder><mml:mo>&#x0220f;</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mspace width="0.277778em"/><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.277778em"/><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mtext>rhs</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mspace width="0.277778em"/><mml:msup><mml:mi>q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:msub></mml:msup><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mtext>rhs</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub><mml:msub><mml:mrow><mml:msup><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mtext>lhs</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mspace width="0.277778em"/><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:msup><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mtext>lhs</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>The sum over indices <inline-formula id="IEq150"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{\langle i_{1},\ldots i_{k}\rangle _{\ne }}$$\end{document}</tex-math><mml:math id="M318"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">&#x027e8;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">&#x027e9;</mml:mo></mml:mrow><mml:mo>&#x02260;</mml:mo></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq150.gif"/></alternatives></inline-formula> means that none of the indices are allowed to be equal to any of the others, in the sum. As in Equation&#x000a0;(28) there could also be an integration over all the possible values of some rule variables, in this case a subset of the incoming and outgoing labels <inline-formula id="IEq151"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\lambda }}}$$\end{document}</tex-math><mml:math id="M320"><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq151.gif"/></alternatives></inline-formula> and <inline-formula id="IEq152"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {{\varvec{\lambda }}^{\prime }}$$\end{document}</tex-math><mml:math id="M322"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq152.gif"/></alternatives></inline-formula>.<disp-formula id="Equ16"><label>14</label><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\hat{W}}}_{r} = \int \mathrm{d} X {{\hat{W}}}_{r}({{\varvec{\lambda }}}(X) , {{\varvec{\lambda }}^{\prime }}(X)) \end{aligned}$$\end{document}</tex-math><mml:math id="M324" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>&#x0222b;</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mi>X</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq153"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {{\hat{W}}}_{r}({{\varvec{\lambda }}}, {{\varvec{\lambda }}^{\prime }})$$\end{document}</tex-math><mml:math id="M326"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq153.gif"/></alternatives></inline-formula> is given by Eq.&#x000a0;(<xref rid="Equ15" ref-type="">13</xref>). However, we will not have occasion to use this extra flexibility. Additional technical discussion of the label encoding from which <inline-formula id="IEq154"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M328"><mml:mi>&#x003bb;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq154.gif"/></alternatives></inline-formula> is drawn appears in Supplementary Material Section 7.2.9.</p><p id="Par73">The main four factors in lines 2 and 3 of Eq.&#x000a0;(<xref rid="Equ15" ref-type="">13</xref>) are as in Mjolsness (<xref ref-type="bibr" rid="CR33">2010</xref>) and act in an analogous way to the previous rule semantics definitions: first (reading operator products right-to-left) all the vertex labels, hence all the vertices, of the incoming (LHS) graph are annihilated in an arbitrary order, &#x0201c;then&#x0201d; (instantaneously) all the edges of the incoming graph are annihilated in an arbitrary order, then all the vertices and vertex labels of the outgoing (RHS) graph are created, and then all the edges of the incoming graph are created. However, these ordered operations all happen with zero time delay in the model, and with the same binding of the indices <inline-formula id="IEq155"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_*$$\end{document}</tex-math><mml:math id="M330"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq155.gif"/></alternatives></inline-formula>. We note that the RHS vertex indices <inline-formula id="IEq156"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{p^{\prime }}$$\end{document}</tex-math><mml:math id="M332"><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq156.gif"/></alternatives></inline-formula> get assigned uniquely since <inline-formula id="IEq157"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\hat{a}}_i)^2 = {\mathbf{0 }}$$\end{document}</tex-math><mml:math id="M334"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn mathvariant="bold">0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq157.gif"/></alternatives></inline-formula>.</p><p id="Par74">In addition to the main four factors, in line 1 provision is made for allocation and deallocation of integer-valued graph vertex indices <italic>i</italic> from a single central index list. The erasure operators <inline-formula id="IEq158"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \Big ( \prod _i E_{i_{p} \; i} E_{i \; i_{p}} \Big )$$\end{document}</tex-math><mml:math id="M336"><mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mo>&#x0220f;</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mspace width="0.277778em"/><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.277778em"/><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq158.gif"/></alternatives></inline-formula> serve to maintain the invariance of the statements that (a) every vertex has either 0 or 1 labels present (1 defining an &#x0201c;active&#x0201d; vertex), and (b) edges that are present must connect two active vertices. Additional technical discussion of these points appears in Supplementary Material Section 7.2.9.</p><p id="Par75">Equations&#x000a0;(<xref rid="Equ14" ref-type="">12</xref>) and (<xref rid="Equ15" ref-type="">13</xref>), elaborated here from Mjolsness (<xref ref-type="bibr" rid="CR33">2010</xref>) which omitted <italic>E</italic> factors, provide the built-in syntax and semantics for the basic ruleset portion of a proposed dynamical graph grammar (DGG) generalization of stochastic parameterized grammars (<xref rid="Equ8" ref-type="">6</xref>) and (28) or dynamical grammars (<xref rid="Equ8" ref-type="">6</xref>), (<xref rid="Equ10" ref-type="">8</xref>) and (28),(<xref rid="Equ11" ref-type="">9</xref>), all as outlined in Mjolsness <xref ref-type="bibr" rid="CR30">2005</xref>; Mjolsness <xref ref-type="bibr" rid="CR33">2010</xref> and Mjolsness and Yosiphon (<xref ref-type="bibr" rid="CR31">2006</xref>). The latter two references also map graph grammars to operator algebras by way of unique ObjectID node labels&#x02014;similar to indices <inline-formula id="IEq159"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_p$$\end{document}</tex-math><mml:math id="M338"><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq159.gif"/></alternatives></inline-formula> in that all that matters about them for the graph grammar is not their numerical values, but just whether two such numbers are equal or not.</p><p id="Par76">Additional discussion of model equivalence under this semantics, together with comparison and contrast with related work on graph grammar rule semantics, appears in Supplementary Material Section 7.2.9.</p></sec><sec id="Sec12"><title>Product of Graph Grammar Rules</title><p id="Par77">We approach the multiplication of grammar rule operators in two steps. First, we consider the simpler form omitting cleanup post-factors:<disp-formula id="Equ17"><label>15</label><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned}&#x00026;{{\hat{W}}}_{r} \; \propto \; \rho _{r}({{\varvec{\lambda }}} , {{\varvec{\lambda }}^{\prime }}) \sum \limits _{\langle i_{1},\ldots i_{k}\rangle _{\ne } } \Bigg [ \prod \limits _{p^{\prime }, q^{\prime } \in {\text {rhs}}( r) } {\left( {{\hat{a}}}_{i_{p^{\prime }} i_{q^{\prime }}}\right) }^{{g^{\prime }}_{p^{\prime } \; q^{\prime } }} \Bigg ] \Bigg [ \prod \limits _{p^{\prime } \in {\text {rhs}}( r) } ({{\hat{a}}}_{i_{p^{\prime }} {\lambda ^{\prime }}_{p^{\prime }}})^{h^{\prime }_{p^{\prime }}} \Bigg ] \\&#x00026;\quad \times \Bigg [ \prod \limits _{p, q \in {\text {lhs}}( r) } {\left( a_{i_{p} i_{q}}\right) }^{g_{p \; q}} \Bigg ] \Bigg [ \prod \limits _{p \in {\text {lhs}}(r) } (a_{i_{p} \lambda _{p}})^{h_{p}} \Bigg ] . \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="M340" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub><mml:mspace width="0.277778em"/><mml:mo>&#x0221d;</mml:mo><mml:mspace width="0.277778em"/><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x02211;</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">&#x027e8;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">&#x027e9;</mml:mo></mml:mrow><mml:mo>&#x02260;</mml:mo></mml:msub></mml:munder><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mtext>rhs</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mspace width="0.277778em"/><mml:msup><mml:mi>q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:msub></mml:msup><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mtext>rhs</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub><mml:msub><mml:mrow><mml:msup><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:msup><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mtext>lhs</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mspace width="0.277778em"/><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:msup><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mtext>lhs</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:msup><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq160"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h_{i_p} \in \{0,1\}$$\end{document}</tex-math><mml:math id="M342"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq160.gif"/></alternatives></inline-formula> is an indicator function for inclusion of vertex <inline-formula id="IEq161"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_p$$\end{document}</tex-math><mml:math id="M344"><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq161.gif"/></alternatives></inline-formula> independent of its edges. Again, the sum over indices <inline-formula id="IEq162"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{\langle i_{1},\ldots i_{k}\rangle _{\ne }}$$\end{document}</tex-math><mml:math id="M346"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">&#x027e8;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">&#x027e9;</mml:mo></mml:mrow><mml:mo>&#x02260;</mml:mo></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq162.gif"/></alternatives></inline-formula> means that none of the indices are allowed to be equal to any of the others, in the sum. This form can leave and/or delete undeleted hanging edges, owing to the lack of erasure post-factor. If all <inline-formula id="IEq163"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h_{i_p}=1$$\end{document}</tex-math><mml:math id="M348"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq163.gif"/></alternatives></inline-formula> this is the form used in Mjolsness (<xref ref-type="bibr" rid="CR33">2010</xref>). The advantages of this form are that it is (a) subpermutation-invariant with respect to indexing, like Eq.&#x000a0;(<xref rid="Equ15" ref-type="">13</xref>), and (b) already in normal form (monomial in <inline-formula id="IEq164"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{a}}_*$$\end{document}</tex-math><mml:math id="M350"><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq164.gif"/></alternatives></inline-formula> times monomial in <inline-formula id="IEq165"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_*$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq165.gif"/></alternatives></inline-formula>), and therefore, the product of two such expressions takes the same general form, by repeatedly using the basic commutation relations of Sect.&#x000a0;<xref rid="Sec3" ref-type="sec">2.1</xref> or Supplementary Material Section&#x000a0;7.2.1, Equation&#x000a0;(23d):</p><sec id="FPar3"><title>Proposition 1</title><p id="Par78">The product of two operators taking the form of Eq.&#x000a0;(<xref rid="Equ17" ref-type="">15</xref>) can be rewritten as an signed-integer-weighted sum of expressions taking the same form. The product and the sum are equal, and graph-equivalent, and each is subpermutation-invariant with respect to indexing.</p><p>The proof is given in Supplementary Material Section 7.4.4.</p><p>Alternatively as in the graph rule semantics of Eq.&#x000a0;(<xref rid="Equ15" ref-type="">13</xref>), we may wish to eliminate hanging edges as part of the mechanics of the grammar operator algebra. So we consider the more general form:<disp-formula id="Equ18"><label>16</label><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned}&#x00026;{{\hat{W}}}_{r} \; \propto \; \rho _{r}({{\varvec{\lambda }}} , {{\varvec{\lambda }}^{\prime }}) \sum \limits _{\langle i_{1},\ldots i_{k}\rangle _{\ne }} \Bigg [ \Big ( \prod \limits _{p \in B_r} \; \prod _{ i \ne i_q | \forall q \in {\bar{B}}_{r p}} E_{i_{p} \; i} \Big ) \Big ( \prod \limits _{p \in C_r} \; \prod _{ i \ne i_q | \forall q \in {\bar{C}}_{r p} } E_{i \; i_{p}} \Big ) \Bigg ] \\&#x00026;\quad \times \Bigg [ \prod \limits _{p^{\prime }, q^{\prime } \in {\text {rhs}}( r) } {\left( {{\hat{a}}}_{i_{p^{\prime }} i_{q^{\prime }}}\right) }^{{g^{\prime }}_{p^{\prime } \; q^{\prime } }} \Bigg ] \Bigg [ \prod \limits _{p^{\prime } \in {\text {rhs}}( r) } ({{\hat{a}}}_{i_{p^{\prime }} {\lambda ^{\prime }}_{p^{\prime }}})^{h_{p^{\prime }}} \Bigg ] \\&#x00026;\quad \times \Bigg [ \prod \limits _{p, q \in {\text {lhs}}( r) } {\left( a_{i_{p} i_{q}}\right) }^{g_{p \; q}} \Bigg ] \Bigg [ \prod \limits _{p \in {\text {lhs}}(r) } (a_{i_{p} \lambda _{p}})^{h_{p}} \Bigg ] . \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="M354" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub><mml:mspace width="0.277778em"/><mml:mo>&#x0221d;</mml:mo><mml:mspace width="0.277778em"/><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x02211;</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">&#x027e8;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">&#x027e9;</mml:mo></mml:mrow><mml:mo>&#x02260;</mml:mo></mml:msub></mml:munder><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mspace width="0.277778em"/><mml:munder><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02260;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mi>q</mml:mi><mml:mo>&#x02208;</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">&#x000af;</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">rp</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mspace width="0.277778em"/><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mspace width="0.277778em"/><mml:munder><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02260;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mi>q</mml:mi><mml:mo>&#x02208;</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">&#x000af;</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">rp</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mspace width="0.277778em"/><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mtext>rhs</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mspace width="0.277778em"/><mml:msup><mml:mi>q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:msub></mml:msup><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mtext>rhs</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub><mml:msub><mml:mrow><mml:msup><mml:mi>&#x003bb;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:msup><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mtext>lhs</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mspace width="0.277778em"/><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:msup><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">[</mml:mo></mml:mrow><mml:munder><mml:mo movablelimits="false">&#x0220f;</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mtext>lhs</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:msup><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>where sets <inline-formula id="IEq166"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_r$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mi>B</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq166.gif"/></alternatives></inline-formula>, <inline-formula id="IEq167"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_r$$\end{document}</tex-math><mml:math id="M358"><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq167.gif"/></alternatives></inline-formula>, <inline-formula id="IEq168"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{B}}_r$$\end{document}</tex-math><mml:math id="M360"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">&#x000af;</mml:mo></mml:mrow></mml:mover><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq168.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq169"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{C}}_r$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">&#x000af;</mml:mo></mml:mrow></mml:mover><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq169.gif"/></alternatives></inline-formula> are finite (assuming <inline-formula id="IEq170"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {lhs}(r)$$\end{document}</tex-math><mml:math id="M364"><mml:mrow><mml:mtext>lhs</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq170.gif"/></alternatives></inline-formula> and <inline-formula id="IEq171"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {rhs}(r)$$\end{document}</tex-math><mml:math id="M366"><mml:mrow><mml:mtext>rhs</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq171.gif"/></alternatives></inline-formula> are both finite); this form encompasses Eq.&#x000a0;(<xref rid="Equ15" ref-type="">13</xref>) in which case <inline-formula id="IEq172"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_r = C_r = \text {lhs}(r) {\setminus } \text {rhs}(r)$$\end{document}</tex-math><mml:math id="M368"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>lhs</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mtext>rhs</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq172.gif"/></alternatives></inline-formula> and <inline-formula id="IEq173"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{B}}_{r p}= {\bar{C}}_{r p} = \varnothing $$\end{document}</tex-math><mml:math id="M370"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">&#x000af;</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">rp</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">&#x000af;</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">rp</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>&#x02205;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq173.gif"/></alternatives></inline-formula> for all <italic>p</italic>. Owing to the sum over indices <inline-formula id="IEq174"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{i_1, \ldots i_k\}$$\end{document}</tex-math><mml:math id="M372"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq174.gif"/></alternatives></inline-formula> is again subpermutation-invariant.</p></sec><sec id="FPar4"><title>Proposition 2</title><p id="Par81">The product of two operators taking the form of Eq.&#x000a0;(<xref rid="Equ18" ref-type="">16</xref>) can be rewritten as an signed-integer-weighted sum of expressions taking the same form. The product and the sum are equal, and graph-equivalent, and each is subpermutation-invariant with respect to indexing.</p><p>Note: Less formally, the product of two graph rewrite rule operators is an integer-weighted sum of other graph rewrite rule operators in a slightly expanded operator algebra. This proposition establishes <italic>an operator algebra of natural graph-rewriting operations</italic>, including all operations in any given collection of graph rewrite rules, as the operator algebra generated by the probability inflow operators <inline-formula id="IEq175"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\hat{W}}_r}$$\end{document}</tex-math><mml:math id="M374"><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq175.gif"/></alternatives></inline-formula> for the individual rules. The probability outflow operators <inline-formula id="IEq176"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_r$$\end{document}</tex-math><mml:math id="M376"><mml:msub><mml:mi>D</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq176.gif"/></alternatives></inline-formula> are also encompassed, by a variant of Equation&#x000a0;(24) shown in Corollary&#x000a0;<xref ref-type="sec" rid="FPar6">2</xref>.</p><p>The proof is given in Supplementary Material Section 7.4.4. As in Proposition&#x000a0;<xref ref-type="sec" rid="FPar3">1</xref>, it uses commutation relations to convert expressions to normal form.</p></sec><sec id="FPar5"><title>Corollary 1</title><p id="Par84">The commutator <inline-formula id="IEq177"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[{\hat{W}}_{r_1}, {\hat{W}}_{r_2}]$$\end{document}</tex-math><mml:math id="M378"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq177.gif"/></alternatives></inline-formula> of two operators under the semantics of Proposition&#x000a0;&#x000a0;<xref ref-type="sec" rid="FPar4">2</xref> [taking the form of Eq.&#x000a0;(<xref rid="Equ18" ref-type="">16</xref>)] can also be rewritten as an integer-weighted sum of expressions taking the same form. The product and the sum are equal, and graph-equivalent, and each is subpermutation-invariant with respect to indexing. Likewise, the commutator <inline-formula id="IEq178"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[{\hat{W}}_{r_1}, {\hat{W}}_{r_2}]$$\end{document}</tex-math><mml:math id="M380"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq178.gif"/></alternatives></inline-formula> of two operators under the semantics of Proposition&#x000a0;&#x000a0;<xref ref-type="sec" rid="FPar3">1</xref> [taking the form of Eq.&#x000a0;(<xref rid="Equ15" ref-type="">13</xref>)] can also be rewritten as an integer-weighted sum of expressions taking the same form (<xref rid="Equ15" ref-type="">13</xref>). Compared to the product <inline-formula id="IEq179"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{W}}_{r_1} {\hat{W}}_{r_2}$$\end{document}</tex-math><mml:math id="M382"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq179.gif"/></alternatives></inline-formula>, however, many summands may cancel in a commutator.</p></sec><sec id="FPar6"><title>Corollary 2</title><p id="Par85">The product and the commutator of two full graph rewrite rule operators <inline-formula id="IEq180"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{r_1}, W_{r_2}$$\end{document}</tex-math><mml:math id="M384"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq180.gif"/></alternatives></inline-formula> (including their negative diagonal terms <inline-formula id="IEq181"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-{\hat{D}}_{r_1}, -{\hat{D}}_{r_2}$$\end{document}</tex-math><mml:math id="M386"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq181.gif"/></alternatives></inline-formula>) under the semantics of Proposition&#x000a0;&#x000a0;<xref ref-type="sec" rid="FPar4">2</xref> [taking the form of Eq.&#x000a0;(<xref rid="Equ18" ref-type="">16</xref>)] can also be rewritten as an integer-weighted sum of expressions taking the same form. Likewise the product and the commutator of two full graph rewrite rule operators <inline-formula id="IEq182"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{r_1}, W_{r_2}$$\end{document}</tex-math><mml:math id="M388"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq182.gif"/></alternatives></inline-formula> under the semantics of Proposition&#x000a0;&#x000a0;<xref ref-type="sec" rid="FPar3">1</xref> [taking the form of Eq.&#x000a0;(<xref rid="Equ15" ref-type="">13</xref>)] can also be rewritten as an integer-weighted sum of expressions taking the same form. In either case, the product (or commutator) and the sum are equal, and graph-equivalent, and each is subpermutation-invariant with respect to indexing.</p></sec><sec id="FPar7"><title>Proof</title><p id="Par86">The diagonal terms <inline-formula id="IEq183"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_r$$\end{document}</tex-math><mml:math id="M390"><mml:msub><mml:mi>D</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq183.gif"/></alternatives></inline-formula> are equal to <inline-formula id="IEq184"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{W}}_{r^{\prime }}$$\end{document}</tex-math><mml:math id="M392"><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msup><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq184.gif"/></alternatives></inline-formula> for a new rule <inline-formula id="IEq185"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{\prime }$$\end{document}</tex-math><mml:math id="M394"><mml:msup><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq185.gif"/></alternatives></inline-formula>, not included in the model, in which the LHS of <italic>r</italic> is both the LHS and the RHS of <inline-formula id="IEq186"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r^{\prime }$$\end{document}</tex-math><mml:math id="M396"><mml:msup><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq186.gif"/></alternatives></inline-formula>. The reason is that the LHS <inline-formula id="IEq187"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\setminus }$$\end{document}</tex-math><mml:math id="M398"><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq187.gif"/></alternatives></inline-formula> RHS post-factor and any RHS <inline-formula id="IEq188"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\setminus }$$\end{document}</tex-math><mml:math id="M400"><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq188.gif"/></alternatives></inline-formula> LHS prefactor of <inline-formula id="IEq189"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{W}}_{r^{\prime }}$$\end{document}</tex-math><mml:math id="M402"><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msup><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq189.gif"/></alternatives></inline-formula> are both empty, so Equation&#x000a0;(32) for <inline-formula id="IEq190"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_r$$\end{document}</tex-math><mml:math id="M404"><mml:msub><mml:mi>D</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq190.gif"/></alternatives></inline-formula> also equals <inline-formula id="IEq191"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{W}}_{r^{\prime }}$$\end{document}</tex-math><mml:math id="M406"><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msup><mml:mi>r</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq191.gif"/></alternatives></inline-formula> from Eq.&#x000a0;(<xref rid="Equ15" ref-type="">13</xref>). Thus, <inline-formula id="IEq192"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_r = {\hat{W}}_{LHS_r \rightarrow LHS_r}$$\end{document}</tex-math><mml:math id="M408"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>L</mml:mi><mml:mi>H</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq192.gif"/></alternatives></inline-formula>, as in Equation&#x000a0;(24) for particle semantics, but now for graphs. Proposition&#x000a0;<xref ref-type="sec" rid="FPar4">2</xref> then applies to <inline-formula id="IEq193"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{W}}_{r}$$\end{document}</tex-math><mml:math id="M410"><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq193.gif"/></alternatives></inline-formula> and <inline-formula id="IEq194"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_r$$\end{document}</tex-math><mml:math id="M412"><mml:msub><mml:mi>D</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq194.gif"/></alternatives></inline-formula> alike, for all rules <italic>r</italic> in the model. <inline-formula id="IEq195"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="M414"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq195.gif"/></alternatives></inline-formula></p></sec><sec id="FPar8"><title>Observation 3</title><p id="Par87">In this sense (Propositions&#x000a0;<xref ref-type="sec" rid="FPar3">1</xref> and <xref ref-type="sec" rid="FPar4">2</xref> and Corollaries&#x000a0;<xref ref-type="sec" rid="FPar5">1</xref> and <xref ref-type="sec" rid="FPar6">2</xref>), there is a higher-level algebra, generated by any collection of graph rewrite rule operators, together with the identity operator <inline-formula id="IEq196"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I =N^{(\varnothing )}= {\hat{W}}_{\varnothing \rightarrow \varnothing }$$\end{document}</tex-math><mml:math id="M416"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x02205;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>&#x02205;</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>&#x02205;</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq196.gif"/></alternatives></inline-formula> that can be &#x0201c;implemented&#x0201d; by (mapped compositionally by operator algebra homomorphism to) a sufficiently large indexed collection of binary state variables with their own lower-level state-changing operator algebra.</p></sec><sec id="FPar9"><title>Observation 4</title><p id="Par88"><italic>Semantics alternatives.</italic> An alternative semantics to Eq.&#x000a0;(<xref rid="Equ15" ref-type="">13</xref>) could include factors of <inline-formula id="IEq197"><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\prod _\mathrm{LHS} (Z_{i_p i_q})^{{\bar{g}}_{p q}}$$\end{document}</tex-math><mml:math id="M418"><mml:mrow><mml:msub><mml:mo>&#x0220f;</mml:mo><mml:mi mathvariant="normal">LHS</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">&#x000af;</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mi mathvariant="italic">pq</mml:mi></mml:mrow></mml:msub></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq197.gif"/></alternatives></inline-formula> where <inline-formula id="IEq198"><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{g}}$$\end{document}</tex-math><mml:math id="M420"><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">&#x000af;</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq198.gif"/></alternatives></inline-formula> is a 0/1-valued matrix representing a second type of graph edge that identifies <italic>prohibited</italic> connections on the LHS, and likewise <inline-formula id="IEq199"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\prod _\mathrm{RHS} (Z_{i_p^{\prime } i_q^{\prime }})^{{\bar{g}}^{\prime }_{p^{\prime } q^{\prime } }}$$\end{document}</tex-math><mml:math id="M422"><mml:mrow><mml:msub><mml:mo>&#x0220f;</mml:mo><mml:mi mathvariant="normal">RHS</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:msubsup><mml:mi>i</mml:mi><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:msubsup><mml:mi>i</mml:mi><mml:mi>q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">&#x000af;</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:msup><mml:mi>q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq199.gif"/></alternatives></inline-formula> for the RHS. The normal form could put these new <italic>Z</italic> product factors just to the right of (acting just before) the corresponding factors for <italic>g</italic> and <inline-formula id="IEq200"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g^{\prime }$$\end{document}</tex-math><mml:math id="M424"><mml:msup><mml:mi>g</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq200.gif"/></alternatives></inline-formula> in Eq.&#x000a0;(<xref rid="Equ15" ref-type="">13</xref>). If corresponding entries of <italic>g</italic> and <inline-formula id="IEq201"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\bar{g}}$$\end{document}</tex-math><mml:math id="M426"><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">&#x000af;</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq201.gif"/></alternatives></inline-formula> both take the value 1, that inconsistency has no effect since their product has a factor <inline-formula id="IEq202"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a Z = a (I-{\hat{a}}a) = a - (a {\hat{a}})a= a - (I-{\hat{a}}a)a = a - a + {\hat{a}}a^2 = 0$$\end{document}</tex-math><mml:math id="M428"><mml:mrow><mml:mi>a</mml:mi><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msup><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq202.gif"/></alternatives></inline-formula>.</p><p>Instead of the creation and annihilation operators for Boolean edge variables, we could use creation and annihilation operators for <inline-formula id="IEq203"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb {N}}}$$\end{document}</tex-math><mml:math id="M430"><mml:mi mathvariant="double-struck">N</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq203.gif"/></alternatives></inline-formula>-valued numbers of identical particles in definition (<xref rid="Equ15" ref-type="">13</xref>) of <inline-formula id="IEq204"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{W}}_r$$\end{document}</tex-math><mml:math id="M432"><mml:msub><mml:mover accent="true"><mml:mi>W</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq204.gif"/></alternatives></inline-formula>. But (1) the handling of memory allocation and deallocation by <italic>E</italic> factors might have to be revised, and (2) graph grammar rules could have unintended semantics in terms of multigraphs: graphs with nonnegative integer edge weights. On the other hand, multigraphs and multigraph grammar rules can also be useful, if that is the intended semantics.</p></sec></sec><sec id="Sec13"><title>Slice Rewrite Rule Operators</title><p id="Par90">The slice categories of Diagram 1, with <inline-formula id="IEq205"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H = {{\mathbb {N}}}^+, \; {J}_D^+, \; {{\mathbb {N}}}_D^{+ \text {op}}, \; C_D, \; \mathrm{or } \; {\tilde{C}}_D$$\end{document}</tex-math><mml:math id="M434"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:msubsup><mml:mi>J</mml:mi><mml:mi>D</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:msubsup><mml:mi mathvariant="double-struck">N</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mtext>op</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:msub><mml:mi>C</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mi mathvariant="normal">or</mml:mi><mml:mspace width="0.277778em"/><mml:msub><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq205.gif"/></alternatives></inline-formula> for graded graph, stratified graph, abstract cell complex, graded stratified graph, and graded abstract cell complex, respectively, are all variants of the category of labeled graphs <inline-formula id="IEq206"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varphi : G \rightarrow H$$\end{document}</tex-math><mml:math id="M436"><mml:mrow><mml:mi>&#x003c6;</mml:mi><mml:mo>:</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq206.gif"/></alternatives></inline-formula> whose labels <inline-formula id="IEq207"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa $$\end{document}</tex-math><mml:math id="M438"><mml:mi>&#x003ba;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq207.gif"/></alternatives></inline-formula> are nodes of <italic>H</italic>, with extra constraints added on the integer-valued labels. We can encode these constraints in each case with a predicate <inline-formula id="IEq208"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_H({\varphi })$$\end{document}</tex-math><mml:math id="M440"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c6;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq208.gif"/></alternatives></inline-formula>, and enforce them with a real-valued &#x0201c;gating&#x0201d; indicator function <inline-formula id="IEq209"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varTheta }(P_H({\varphi }))$$\end{document}</tex-math><mml:math id="M442"><mml:mrow><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c6;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq209.gif"/></alternatives></inline-formula> which takes the value 1 if the predicate is satisfied and zero otherwise. If an ordering on the nodes of <italic>G</italic> is established, as we have assumed, then these objects become <inline-formula id="IEq210"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_H({{\varvec{\kappa }}})$$\end{document}</tex-math><mml:math id="M444"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003ba;</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq210.gif"/></alternatives></inline-formula> and an indicator function <inline-formula id="IEq211"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varTheta }(P_H({{\varvec{\kappa }}}))$$\end{document}</tex-math><mml:math id="M446"><mml:mrow><mml:mi>&#x00398;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003ba;</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq211.gif"/></alternatives></inline-formula>. In the foregoing graph rewrite rule semantics, such an ordering is established by the arbitrary indexing scheme of <italic>p</italic> and <italic>q</italic>. So we may generalize the graph rewrite rule to cover these slice categories as well by mapping <inline-formula id="IEq212"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _{\mathrm{slice} \; r}({{\varvec{\kappa }}} , {{\varvec{\kappa }}^{\prime }})$$\end{document}</tex-math><mml:math id="M448"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi mathvariant="normal">slice</mml:mi><mml:mspace width="0.277778em"/><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003ba;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003ba;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq212.gif"/></alternatives></inline-formula> to a corresponding <inline-formula id="IEq213"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho _{\mathrm{graph} \; r}(({{\varvec{\kappa }}, {\varvec{\lambda }}}) , ({{\varvec{\kappa }}^{\prime }, {\varvec{\lambda }}^{\prime }}))$$\end{document}</tex-math><mml:math id="M450"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi mathvariant="normal">graph</mml:mi><mml:mspace width="0.277778em"/><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003ba;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003ba;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq213.gif"/></alternatives></inline-formula>:<disp-formula id="Equ19"><label>17</label><alternatives><tex-math id="M451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \rho _{\mathrm{graph} \; r}(({{\varvec{\kappa }}, {\varvec{\lambda }}}) , ({{\varvec{\kappa }}^{\prime }, {\varvec{\lambda }}^{\prime }})) = {\varTheta }(P_H({{\varvec{\kappa }}})) \times {\varTheta }(P_H({{\varvec{\kappa }}^{\prime }})) \times \rho _{\mathrm{slice} \; H,\; r}({{\varvec{\lambda }}} , {{\varvec{\lambda }}^{\prime }}) . \end{aligned}$$\end{document}</tex-math><mml:math id="M452" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi mathvariant="normal">graph</mml:mi><mml:mspace width="0.277778em"/><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003ba;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003ba;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003ba;</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003ba;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi mathvariant="normal">slice</mml:mi><mml:mspace width="0.277778em"/><mml:mi>H</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bb;</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>The first indicator function in Eq.&#x000a0;(<xref rid="Equ19" ref-type="">17</xref>) could be omitted if the initial condition gives nonzero probability only to valid <italic>H</italic>-slice graphs and all rules in the grammar are valid <italic>H</italic>-rewrite rules, maintaining the validity conditions <inline-formula id="IEq214"><alternatives><tex-math id="M453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_H$$\end{document}</tex-math><mml:math id="M454"><mml:msub><mml:mi>P</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq214.gif"/></alternatives></inline-formula> using the second indicator function in Eq.&#x000a0;(<xref rid="Equ19" ref-type="">17</xref>). The remaining operator products in Eq.&#x000a0;(<xref rid="Equ15" ref-type="">13</xref>) can remain the same, yielding the operator algebra semantics of these (and potentially other) slice category rewrite rules, complete with provision for extra domain-model specific labels <inline-formula id="IEq215"><alternatives><tex-math id="M455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M456"><mml:mi>&#x003bb;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq215.gif"/></alternatives></inline-formula>.</p><p id="Par91">In this way, we could <italic>implement</italic> special graph grammar syntax for slice graph rewrite rules, and thereby achieve summable operator algebra semantics for modeling languages with rewrite rules at the level of graded graphs, stratified graphs, abstract cell complexes, graded stratified graphs, and/or graded abstract cell complexes that could implement selected continuum limits such as mesh-approximable stratified spaces and CW complexes (as suggested in Diagram 3).</p><p id="Par92">For example in the case of undirected graded graphs, we could let directed edges represent <inline-formula id="IEq216"><alternatives><tex-math id="M457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Delta } l = +1$$\end{document}</tex-math><mml:math id="M458"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq216.gif"/></alternatives></inline-formula> edges and undirected edges represent <inline-formula id="IEq217"><alternatives><tex-math id="M459">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Delta } l = 0$$\end{document}</tex-math><mml:math id="M460"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq217.gif"/></alternatives></inline-formula>. The triangle 2D mesh refinement example would then become:<disp-formula id="Equ20"><label>18</label><graphic xlink:href="11538_2019_628_Equ20_HTML.gif" position="anchor"/></disp-formula>Directed graded graphs could be represented too, with just one bit of edge label information to record whether there is a change of level number along a directed edge or not. In both cases, the integer-valued level number edge labels are removed, to be restored automatically by an implementation map <inline-formula id="IEq218"><alternatives><tex-math id="M461">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\mathcal {I}}}}$$\end{document}</tex-math><mml:math id="M462"><mml:mi mathvariant="script">I</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq218.gif"/></alternatives></inline-formula> from slice graph grammar rule syntax to ordinary graph grammar rule syntax [this implementation map could even be expressed in the form of a declarative model transformation meta-grammar rule, mapping rules like (<xref rid="Equ20" ref-type="">18</xref>) to a slight variant of rules like (<xref rid="Equ12" ref-type="">10</xref>) with an AST for the labels]. Similarly, for stratified graphs one could label edges with <inline-formula id="IEq219"><alternatives><tex-math id="M463">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Delta } d$$\end{document}</tex-math><mml:math id="M464"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq219.gif"/></alternatives></inline-formula> and allow the interpretation process to restore <italic>d</italic>. For abstract cell complexes, one instead needs only to record one extra bit of edge information regarding <italic>d</italic>: <inline-formula id="IEq220"><alternatives><tex-math id="M465">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Delta } d \in \{0, -1\}$$\end{document}</tex-math><mml:math id="M466"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>d</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq220.gif"/></alternatives></inline-formula>. As in the case of rule (<xref rid="Equ12" ref-type="">10</xref>), with these extra edge labels rule (<xref rid="Equ20" ref-type="">18</xref>) could be made more elaborate by retaining all relevant strata and their connections at smaller level numbers rather than just the graded graph &#x0201c;frontier&#x0201d; comprising the deepest substrata in each stratum.</p><sec id="FPar10"><title>Observation 5</title><p id="Par93">In all the foregoing slice graph category cases, the implementation mapping on rewrite rules should match the implementation mapping on their semantics as proposed above, so that slice implementation at the model level commutes with semantics:<graphic position="anchor" xlink:href="11538_2019_628_Figc_HTML" id="MO26"/>where, again, the slice rewrite rules can pertain to graded graphs, stratified graphs, abstract cell complexes, graded stratified graphs, or graded abstract cell complexes; the latter two could be used to support continuum limits such as mesh-approximable stratified spaces and CW complexes.</p><p>A systematic alternative to operator algebra semantics for graph rewrite rules is provided by the &#x0201c;double pushout&#x0201d; category-theoretic construction (Ehrig et&#x000a0;al. <xref ref-type="bibr" rid="CR12">2006</xref>), using the category of graphs and graph transformations, discussed in Supplementary Material Section 7.2.10.</p></sec></sec><sec id="Sec14"><title>Efficient Implementations</title><p id="Par95">We just saw that slice graph grammar rules can be implemented (efficiently) in terms of ordinary labeled graph grammar rules.</p><p id="Par96">The efficient implementation of graph grammars rules themselves can also be considered. We have mentioned that they can be and have been implemented in terms of parameterized grammars with parameters devoted to recording integer-valued ObjectIDs. That implies that worst-case performance for parameterized grammars can be as bad as finding small unlabeled subgraphs in large unlabeled graphs, though finding subgraphs in practice is a lot easier than finding them in worst case, and labels help substantially. So one option is just to deploy algorithms that match small symbolic expressions, or use computer algebra systems that have done the same. But another option is available specifically for declarative modeling: to find the rules with the most commonly occurring rule firings in a model, and to use meta-grammars or a meta-language (discussed in Sect.&#x000a0;<xref rid="Sec2" ref-type="sec">2</xref>) to transform those rules into submodels comprising rules taking only special forms that can be compiled into special-case efficient simulation code. Examples of special-form rules amenable to special-case simulation code include parameterless rules, terms with parameter sets that take only a few values, rules that consist only of differential equations, context-free grammar rules such as in Equation&#x000a0;(35), 1D chain preserving rules such as Equation&#x000a0;(34), and many other possibilities. Then, use strategies like operator splitting to simulate quickly most of the time, slowing down only for occasional higher-cost operations like cell division in a tissue model or bundling/zippering in a microtubule network model.</p></sec></sec><sec id="Sec15"><title>Meta-Hierarchy Via Graphs</title><p id="Par97">If we seek models in discrete mathematics for the idea of a &#x0201c;hierarchy&#x0201d; such as a hierarchy of biological systems and subsystems, or a hierarchy of modeling methods, the simplest possibility is a tree: a directed graph whose undirected counterpart has no cycles. This graph could be labeled with the names of the subsystems, methods, or other concepts in the hierarchy. Such a restrictive definition could be appropriate for a compositional hierarchy, or for a strict classification aimed at reconstructing clades, but not in general for a hierarchy of specializations or subsets in which a node may have several parent nodes. For that case, a less restrictive possibility is to model a hierarchy as a labeled DAG (directed acyclic graph), which has no cycles as a directed graph. Thus, a labeled DAG is a natural model for the idea of a hierarchy that is more general than a tree.</p><p id="Par98">However, as the foregoing examples show, a hierarchy may be composed of items related in several different ways (composition, specialization, mutually exclusive specialization, and so on.) This fact suggests a further generalization. If the edge labels in a labeled DAG take values in a further DAG of possible relationships, themselves related only by specialization, the resulting compound structure can be called a <italic>meta-hierarchy</italic> since it encodes a hierarchy of interrelated hierarchies. This kind of structure has precedent in, for example, the more general &#x0201c;typed attributed graphs&#x0201d; of Ehrig et&#x000a0;al. (<xref ref-type="bibr" rid="CR12">2006</xref>).</p><p id="Par99">In Sect.&#x000a0;<xref rid="Sec18" ref-type="sec">5</xref>, we will consider a meta-hierarchy whose vertices index into (are labeled by) formal languages for modeling aspects of biology.</p></sec></sec><sec id="Sec16"><title>Model Reduction</title><p id="Par100">Model reduction can be a reasonable strategy to deal with biological complexity. Instead of picking out the most important variables and processes to include in a model a priori, one can include some reasonable representation of many variables and processes (although the model still would not be complete) with reasonable initial parameter values in a fine-scale model, and then computationally seek a smaller, coarser scale model that behaves in approximately the same way, on some set of &#x0201c;observables&#x0201d; or &#x0201c;quantities of interest,&#x0201d; in some relevant region of parameter space.</p><p id="Par101">In addition to eliminating conditionally unnecessary state variables for simplicity&#x02019;s sake, model reduction has the potential to: (a) enable scaling up to very large models through increased computational efficiency in simulation; (b) mathematically connect predictive models across scales of description for both causal authenticity and greater accuracy at each scale; (c) enable the study of the great diversity of possible emergent phenomena, as a function of the parameters, structures, and initial conditions of fine-scale models. Repeated model reduction can result in a <italic>hierarchical stack of interrelated models</italic>, with which to systematically maximize these advantages.</p><p id="Par102">How can we use machine learning to perform the computational search for reduced models? Given enough data from a pure (parameterless) stochastic chemical reaction network, and the correct structure of the network, it is possible to learn the reaction rates (Wang et&#x000a0;al. <xref ref-type="bibr" rid="CR49">2010</xref>; Golightly and Wilkinson <xref ref-type="bibr" rid="CR16">2011</xref>). In Sect.&#x000a0;<xref rid="Sec17" ref-type="sec">4.1</xref>, we summarize how to learn not just reaction rates but an <italic>effective reduced-state space model</italic> in the form of a time-varying Boltzmann distribution in at least some examples by following very general principles, for the parameterless case (Johnson et&#x000a0;al. <xref ref-type="bibr" rid="CR18">2015</xref>) and for the case in which parameters include spatial positions (Ernst et&#x000a0;al. <xref ref-type="bibr" rid="CR14">2018</xref>).</p><p id="Par103">The general theme of using machine learning to create computationally efficient reduced models is rapidly advancing. In computational chemistry for example Smith et&#x000a0;al. (<xref ref-type="bibr" rid="CR47">2017</xref>) develop a neural network for learning from, interpolating, and much more efficiently applying the energy and therefore force information computed in density functional theory fine-scale calculations. Likewise, other work (e.g., Burkardt et&#x000a0;al. <xref ref-type="bibr" rid="CR4">2006</xref>) addresses difficult problems in fluid flow.</p><p id="Par104">As for the general semantics (<inline-formula id="IEq221"><alternatives><tex-math id="M467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }$$\end{document}</tex-math><mml:math id="M468"><mml:mi>&#x003a8;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq221.gif"/></alternatives></inline-formula>) and implementation (<inline-formula id="IEq222"><alternatives><tex-math id="M469">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\mathcal {I}}}}$$\end{document}</tex-math><mml:math id="M470"><mml:mi mathvariant="script">I</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq222.gif"/></alternatives></inline-formula>) families of structure-respecting mappings, we will denote model reduction mappings by a mapping family symbol <inline-formula id="IEq223"><alternatives><tex-math id="M471">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {R}}}$$\end{document}</tex-math><mml:math id="M472"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq223.gif"/></alternatives></inline-formula>.</p><sec id="Sec17"><title>Learning Boltzmann Distribution Dynamics</title><p id="Par105">In the parameterless rewrite rule [e.g., a chemical reaction as in Eq.&#x000a0;(<xref rid="Equ2" ref-type="">2</xref>)] case, we learn a coarse-scale approximation <inline-formula id="IEq224"><alternatives><tex-math id="M473">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{p}}$$\end{document}</tex-math><mml:math id="M474"><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq224.gif"/></alternatives></inline-formula> of <italic>p</italic> as a time-varying version of a Boltzmann distribution or Markov random field (MRF):<disp-formula id="Equ21"><label>19</label><alternatives><tex-math id="M475">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\tilde{p}}({{{\varvec{s}}}}, t; [ \mu _\alpha | \alpha ] ) = \frac{1}{\mathcal {Z}(\mu (t))} \exp \left[ - \sum _\alpha \mu _\alpha (t) V_\alpha (s_i \in C_\alpha ) \right] . \end{aligned}$$\end{document}</tex-math><mml:math id="M476" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0037e;</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="script">Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close="]" open="["><mml:mo>-</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mi>&#x003b1;</mml:mi></mml:munder><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula>Here, each potential function <inline-formula id="IEq225"><alternatives><tex-math id="M477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_\alpha $$\end{document}</tex-math><mml:math id="M478"><mml:msub><mml:mi>V</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq225.gif"/></alternatives></inline-formula> is a function of a subset or clique <inline-formula id="IEq226"><alternatives><tex-math id="M479">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_\alpha $$\end{document}</tex-math><mml:math id="M480"><mml:msub><mml:mi>C</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq226.gif"/></alternatives></inline-formula> of the components of <inline-formula id="IEq227"><alternatives><tex-math id="M481">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\varvec{s}}}}$$\end{document}</tex-math><mml:math id="M482"><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq227.gif"/></alternatives></inline-formula>, creating a bipartite &#x0201c;factor graph&#x0201d; of variable-nodes indexed by <italic>i</italic> and factor-nodes indexed by <inline-formula id="IEq228"><alternatives><tex-math id="M483">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="M484"><mml:mi>&#x003b1;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq228.gif"/></alternatives></inline-formula> (Lauritzen <xref ref-type="bibr" rid="CR25">1995</xref>; Frey <xref ref-type="bibr" rid="CR15">2003</xref>). If the factor graph is not connected then its connected components all factorize into independent probability distributions whose product is <inline-formula id="IEq229"><alternatives><tex-math id="M485">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{p}}$$\end{document}</tex-math><mml:math id="M486"><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq229.gif"/></alternatives></inline-formula>.</p><p id="Par106">To get the dynamics of <inline-formula id="IEq230"><alternatives><tex-math id="M487">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\mu }}}$$\end{document}</tex-math><mml:math id="M488"><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq230.gif"/></alternatives></inline-formula>, one can minimize the KL divergence between <inline-formula id="IEq231"><alternatives><tex-math id="M489">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{p}}$$\end{document}</tex-math><mml:math id="M490"><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq231.gif"/></alternatives></inline-formula> and <italic>p</italic>, where <inline-formula id="IEq232"><alternatives><tex-math id="M491">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{p}}$$\end{document}</tex-math><mml:math id="M492"><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq232.gif"/></alternatives></inline-formula> evolves under a differential equation<disp-formula id="Equ22"><label>20</label><alternatives><tex-math id="M493">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\mathrm{d} \mu _\alpha }{ \mathrm{d}t} = F_\alpha ( [\mu _\beta |\beta ] ) = F_\alpha ({{\varvec{\mu }}}) \end{aligned}$$\end{document}</tex-math><mml:math id="M494" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2019_628_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula>whose right hand sides <inline-formula id="IEq233"><alternatives><tex-math id="M495">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[ F_\alpha | \alpha ]$$\end{document}</tex-math><mml:math id="M496"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq233.gif"/></alternatives></inline-formula> can be taken to be a learned combination of a large number of hand-designed basis functions (Johnson et&#x000a0;al. <xref ref-type="bibr" rid="CR18">2015</xref>; Johnson <xref ref-type="bibr" rid="CR17">2012</xref>), optimizing a KL divergence between distributions <italic>p</italic> and <inline-formula id="IEq234"><alternatives><tex-math id="M497">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\tilde{p}}$$\end{document}</tex-math><mml:math id="M498"><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq234.gif"/></alternatives></inline-formula>. This is the &#x0201c;Graph-Constrained Correlation Dynamics&#x0201d; (GCCD) model reduction method. It was used to achieve a substantial reduction in number of variables for modeling a molecular complex in synapses.</p><p id="Par107">The goal of training for model reduction may be summarized as minimal degradation over time of the approximation on a set of observables: <graphic position="anchor" xlink:href="11538_2019_628_Figd_HTML" id="MO29"/> Here, <italic>R</italic> is a restriction operator mapping fine-scale to coarse-scale states, and <inline-formula id="IEq235"><alternatives><tex-math id="M499">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Delta } t$$\end{document}</tex-math><mml:math id="M500"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq235.gif"/></alternatives></inline-formula> indicates the passage of time under model dynamics. This diagram can be stacked horizontally, for teacher-forcing model training, or vertically, for application across more than two scales. This definition of model reduction is discussed more extensively in Johnson et&#x000a0;al. (<xref ref-type="bibr" rid="CR18">2015</xref>).</p><p id="Par108">This model reduction method has been extended to the case of continuous spatial parameters (Eqs.&#x000a0;<xref rid="Equ8" ref-type="">6</xref>, <xref rid="Equ10" ref-type="">8</xref>) as described in Supplementary Material Section 7.4.5 (Ernst et&#x000a0;al. <xref ref-type="bibr" rid="CR14">2018</xref>). In addition, a future direction in model reduction by discrete and/or continuous search over expressions denoting reduced models is introduced in that section as a speculation.</p></sec></sec><sec id="Sec18"><title>A Meta-hierarchy for Declarative Modeling</title><p id="Par109">We have developed the ideas of declarative modeling including various formal modeling languages, together with structure-respecting maps (some of them category morphisms or functors) between formal languages and related mathematical objects for semantics, implementation, and model reduction. We have also defined a &#x0201c;meta-hierarchy&#x0201d; as a DAG whose edges are labeled by a DAG of types of relationships, the relationship types forming a specialization hierarchy.<fig id="Fig4"><label>Fig. 4</label><caption><p>Outline of the Tchicoma meta-hierarchy for organizing formal languages for modeling and the structure-preserving maps between them. First two labeled graphs are fully connected, and the <inline-formula id="IEq236"><alternatives><tex-math id="M501">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\boxtimes $$\end{document}</tex-math><mml:math id="M502"><mml:mo>&#x022a0;</mml:mo></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq236.gif"/></alternatives></inline-formula> strong graph product between provides for plentiful potential connections. They represent major &#x0201c;knowledge domains&#x0201d; and &#x0201c;ontolexical categories,&#x0201d; respectively. The third element is a DAG of hierarchical relationship types, as called for in the definition of a meta-hierarchy (see main text); this asymmetric construction is indicated idiosyncratically here by the &#x0201c;<inline-formula id="IEq237"><alternatives><tex-math id="M503">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ltimes $$\end{document}</tex-math><mml:math id="M504"><mml:mo>&#x022c9;</mml:mo></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq237.gif"/></alternatives></inline-formula>&#x0201d; operator. Actual formal languages, and structure-preserving mappings between them, would be positioned deeply inside such a meta-hierarchy&#x02014;not at the coarse indexing levels illustrated here</p></caption><graphic xlink:href="11538_2019_628_Fig4_HTML" id="MO30"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>First &#x0201c;knowledge domain&#x0201d; factor of the proposed Tchicoma meta-hierarchy for organizing formal languages involved in complex biological modeling, with graph edge labels showing the <italic>purviews</italic> of the main kinds of structure-preserving mappings between them (<inline-formula id="IEq238"><alternatives><tex-math id="M505">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }, {{\mathcal {I}}, R, A, C, T}$$\end{document}</tex-math><mml:math id="M506"><mml:mrow><mml:mi>&#x003a8;</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">I</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq238.gif"/></alternatives></inline-formula>), as well as a collection of helper mapping types (<inline-formula id="IEq239"><alternatives><tex-math id="M507">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }_C, \{{{\mathcal {I}}}_*\}$$\end{document}</tex-math><mml:math id="M508"><mml:mrow><mml:msub><mml:mi>&#x003a8;</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi mathvariant="script">I</mml:mi><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq239.gif"/></alternatives></inline-formula>) aimed at computational implementation. Solid arrows represent the purviews of various kinds of mappings; the mappings themselves be would defined individually much deeper in the hierarchy. Mathematically founded implementation maps from modeling to computing should be related by <inline-formula id="IEq240"><alternatives><tex-math id="M509">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {I}}}_{Cm} \simeq {{\mathcal {I}}}_{CM} \circ {\varPsi }$$\end{document}</tex-math><mml:math id="M510"><mml:mrow><mml:msub><mml:mi mathvariant="script">I</mml:mi><mml:mrow><mml:mi mathvariant="italic">Cm</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02243;</mml:mo><mml:msub><mml:mi mathvariant="script">I</mml:mi><mml:mrow><mml:mi mathvariant="italic">CM</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02218;</mml:mo><mml:mi>&#x003a8;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq240.gif"/></alternatives></inline-formula>, and/or <inline-formula id="IEq241"><alternatives><tex-math id="M511">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {I}}}_{M} \circ {\varPsi } \simeq {\varPsi }_C \circ {{\mathcal {I}}}_{Cm} $$\end{document}</tex-math><mml:math id="M512"><mml:mrow><mml:msub><mml:mi mathvariant="script">I</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>&#x02218;</mml:mo><mml:mi>&#x003a8;</mml:mi><mml:mo>&#x02243;</mml:mo><mml:msub><mml:mi>&#x003a8;</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>&#x02218;</mml:mo><mml:msub><mml:mi mathvariant="script">I</mml:mi><mml:mrow><mml:mi mathvariant="italic">Cm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq241.gif"/></alternatives></inline-formula>, where defined. Additional mapping kinds could be defined by further such relations. Implementation maps essential for computation can be built up by compositions such as <inline-formula id="IEq242"><alternatives><tex-math id="M513">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {I}}} \simeq {{\mathcal {I}}}_{C} \circ {{\mathcal {I}}}_{Cm} \circ {{\mathcal {I}}}_m$$\end{document}</tex-math><mml:math id="M514"><mml:mrow><mml:mi mathvariant="script">I</mml:mi><mml:mo>&#x02243;</mml:mo><mml:msub><mml:mi mathvariant="script">I</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mo>&#x02218;</mml:mo><mml:msub><mml:mi mathvariant="script">I</mml:mi><mml:mrow><mml:mi mathvariant="italic">Cm</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02218;</mml:mo><mml:msub><mml:mi mathvariant="script">I</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq242.gif"/></alternatives></inline-formula>, etc., which may vary in their computational efficiency and domain of applicability. Dotted arrows show workflow information return to science. Semantics maps <inline-formula id="IEq243"><alternatives><tex-math id="M515">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }$$\end{document}</tex-math><mml:math id="M516"><mml:mi>&#x003a8;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq243.gif"/></alternatives></inline-formula> apply to modeling languages as discussed in the text; semantics maps <inline-formula id="IEq244"><alternatives><tex-math id="M517">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }_C$$\end{document}</tex-math><mml:math id="M518"><mml:msub><mml:mi>&#x003a8;</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq244.gif"/></alternatives></inline-formula> apply to the semantics of programming languages and models of computation, as studied in theoretic computer science. The beginnings of a conventional specialization hierarchy for modeling-relevant topics within several knowledge domains are also indicated</p></caption><graphic xlink:href="11538_2019_628_Fig5_HTML" id="MO31"/></fig></p><p id="Par110">We propose here a particular extensible meta-hierarchy (as defined in Sect.&#x000a0;<xref rid="Sec15" ref-type="sec">3.3</xref>) of formal languages aimed at declarative modeling (as defined in Sect.&#x000a0;<xref rid="Sec2" ref-type="sec">2</xref>) of complex scientific domains such as developmental biology. We attempt to specify the top levels of the meta-hierarchy (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>) but leave lower levels free to evolve with usage. Every node in the meta-hierarchy is either a symbolic placeholder (typical for top-level nodes) or represents a formal language or sub-language to be used in a way that satisfies the definition of declarative modeling. The top-level nodes in the meta-hierarchy are symbolic placeholders for a classification of deeper-level nodes along two independent labelings: (a) &#x0201c;ontolexical,&#x0201d; in which the labels are &#x0201c;process,&#x0201d; &#x0201c;object,&#x0201d; and &#x0201c;expression&#x0201d; as used in Sect.&#x000a0;<xref rid="Sec2" ref-type="sec">2</xref>, and (b) knowledge domain (expanded in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>), in which the labels are &#x0201c;science,&#x0201d; &#x0201c;mathematics,&#x0201d; and &#x0201c;computing&#x0201d;. In addition there is a &#x0201c;declarative dynamical model informatics&#x0201d; or simply &#x0201c;models&#x0201d; knowledge domain node, aimed at mediating between the other three. Of course many deep sub-classifications are possible especially for the knowledge domains, beginning with specialization links to physics, chemistry, and biology, together with reduction links among their further specializations. The resulting meta-hierarchy is named &#x0201c;Tchicoma&#x0201d; after a volcanic formation in the southern Rocky Mountains.</p><p id="Par111">As discussed in Sect.&#x000a0;<xref rid="Sec15" ref-type="sec">3.3</xref>, the edges of the meta-hierarchy are labeled by relationship types (e.g., composition vs. specialization, the latter specialized, e.g., into mutually exclusive and/or exhaustive vs. overlapping specializations; also proven vs. machine-verifiably proven vs. unproven relationships; and so on) that themselves stand in a specialization hierarchy. Such relationship links could be used in the construction of maps <inline-formula id="IEq245"><alternatives><tex-math id="M519">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }$$\end{document}</tex-math><mml:math id="M520"><mml:mi>&#x003a8;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq245.gif"/></alternatives></inline-formula>, <inline-formula id="IEq246"><alternatives><tex-math id="M521">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {I}}}$$\end{document}</tex-math><mml:math id="M522"><mml:mi mathvariant="script">I</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq246.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq247"><alternatives><tex-math id="M523">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {R}}}$$\end{document}</tex-math><mml:math id="M524"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq247.gif"/></alternatives></inline-formula> (for semantics, implementation and model reduction, respectively) in declarative modeling, e.g., to retrieve similar known maps from previous work. Specialization links can be used to insert conditions that enable theorems and algorithms to work, and to evolve those conditions as knowledge accumulates. Automatic curation of these link types would also provide an opportunity to keep usage-based statistics on the edges of each type at each node in the meta-hierarchy from prior successful model-building activities, for human visualization, for automatic heuristic search, and for targeting the invention of new nodes in the meta-hierarchy to regions with high previous application. New nodes could be specializations or generalizations of single nodes or of several nodes jointly, resulting in a cumulative resculpting of the meta-hierarchy and its relationship type DAG under pressure of maximal utility.</p><p id="Par112">The languages at the nodes of this meta-hierarchy can be specified by formal grammars, or they can be generated by unary and binary operators defined for all objects in some mathematical category <italic>C</italic>, including but not limited to category-level binary operators such as universal sum, product, or function arrow that can be defined purely in category-theoretic terms. Such a generated language has the advantage that there is a built-in mathematical semantics taking values in the category <italic>C</italic> objects denoted by the operator expression trees. In full generality, the detection of semantic equivalence between expressions in such languages is intractable, though it can often be specialized to a solvable problem.</p><p id="Par113">The near-top nodes of the Tchicoma meta-hierarchy comprise a Cartesian product of three ontolexical nodes and four knowledge domain nodes (Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>). With the resulting twelve-element cross product classification, one can identify the following potential kinds of structure-respecting inter-language mappings (illustrated in more detail in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>), differentiated by top-level source and target positions in the Tchicoma meta-hierarchy:<list list-type="order"><list-item><p id="Par114">Mappings discussed in this paper:<list list-type="alpha-lower"><list-item><p id="Par115"><inline-formula id="IEq248"><alternatives><tex-math id="M525">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varPsi }}$$\end{document}</tex-math><mml:math id="M526"><mml:mi>&#x003a8;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq248.gif"/></alternatives></inline-formula>: Semantics: Mapping <italic>from</italic> model object and/or process expressions in a modeling language <italic>L</italic>, <italic>to</italic> mathematical objects (specifically to time-evolution operators, in the case of model processes). This mapping is an essential part of declarative modeling as defined in Sect.&#x000a0;<xref rid="Sec2" ref-type="sec">2</xref> and was detailed in Sects.&#x000a0;<xref rid="Sec2" ref-type="sec">2</xref> and <xref rid="Sec7" ref-type="sec">3</xref>.</p></list-item><list-item><p id="Par116"><inline-formula id="IEq249"><alternatives><tex-math id="M527">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {I}}}$$\end{document}</tex-math><mml:math id="M528"><mml:mi mathvariant="script">I</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq249.gif"/></alternatives></inline-formula>: Implementation: Mapping <italic>from</italic> mathematical objects that are the semantics of model objects and/or model processes, <italic>to</italic> computational objects and processes, respectively; or mapping from model expressions to computational expressions that denote these objects and processes; as introduced in Sect.&#x000a0;<xref rid="Sec7" ref-type="sec">3</xref> and illustrated in Diagram 3. Computer Science seeks common target objects for many efficient implementation maps; current examples include Trilinos and PetSc for large-scale scientific computing.</p></list-item><list-item><p id="Par117"><inline-formula id="IEq250"><alternatives><tex-math id="M529">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {R}}}$$\end{document}</tex-math><mml:math id="M530"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq250.gif"/></alternatives></inline-formula>: Model reduction <italic>from</italic> model expressions <italic>to</italic> model expressions with approximately the same semantics under projection to a set of observables; as exemplified in Sect.&#x000a0;<xref rid="Sec16" ref-type="sec">4</xref> and Diagram 6.</p></list-item><list-item><p id="Par118"><inline-formula id="IEq251"><alternatives><tex-math id="M531">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {X}}}$$\end{document}</tex-math><mml:math id="M532"><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq251.gif"/></alternatives></inline-formula>: Transformation: <italic>From</italic> expressions <italic>to</italic> expressions, preserving or approximating semantics (or projections thereof); an essential part of declarative modeling as defined in Sect.&#x000a0;<xref rid="Sec2" ref-type="sec">2</xref>. For example such transformations could include computational implementation <inline-formula id="IEq252"><alternatives><tex-math id="M533">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {I}}}_m$$\end{document}</tex-math><mml:math id="M534"><mml:msub><mml:mi mathvariant="script">I</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq252.gif"/></alternatives></inline-formula> at the model level, model translation <inline-formula id="IEq253"><alternatives><tex-math id="M535">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {T}}}$$\end{document}</tex-math><mml:math id="M536"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq253.gif"/></alternatives></inline-formula> (discussed below), and/or symbolic model reduction <inline-formula id="IEq254"><alternatives><tex-math id="M537">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {R}}}_m$$\end{document}</tex-math><mml:math id="M538"><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq254.gif"/></alternatives></inline-formula> = an inverse image of <inline-formula id="IEq255"><alternatives><tex-math id="M539">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {R}}}$$\end{document}</tex-math><mml:math id="M540"><mml:mi mathvariant="script">R</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq255.gif"/></alternatives></inline-formula> under <inline-formula id="IEq256"><alternatives><tex-math id="M541">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varPsi }$$\end{document}</tex-math><mml:math id="M542"><mml:mi>&#x003a8;</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq256.gif"/></alternatives></inline-formula>, if it exists.</p></list-item></list></p></list-item><list-item><p id="Par119">Mappings not detailed in this paper:<list list-type="alpha-lower"><list-item><p id="Par120"><inline-formula id="IEq257"><alternatives><tex-math id="M543">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {C}}}$$\end{document}</tex-math><mml:math id="M544"><mml:mi mathvariant="script">C</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq257.gif"/></alternatives></inline-formula>: Model creation: <italic>From</italic> domain (object, process) expressions in a domain language <italic>to</italic> (object, process) expressions, respectively, in a modeling language. Domain languages may incorporate ontology formalizations such as the Web Ontology Language (&#x0201c;OWL&#x0201d;) or more general Description Logics; examples include the BioPAX biological pathway description language and ontology (Demir et&#x000a0;al. <xref ref-type="bibr" rid="CR9">2010</xref>), and the Gene Ontology (GO) three-part hierarchy of biological objects and processes that has an object hierarchy and two process hierarchies at two scales, with &#x0201c;Is-A&#x0201d; specialization links within each hierarchy. Declarative model creation packages implemented within computer algebra problem-solving environments include Cellerator (Shapiro et&#x000a0;al. <xref ref-type="bibr" rid="CR41">2003</xref>, <xref ref-type="bibr" rid="CR44">2015</xref>), Cellzilla (Shapiro et&#x000a0;al. <xref ref-type="bibr" rid="CR43">2013</xref>), and Plenum (Yosiphon <xref ref-type="bibr" rid="CR54">2009</xref>).</p></list-item><list-item><p id="Par121"><inline-formula id="IEq258"><alternatives><tex-math id="M545">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {T}}}$$\end{document}</tex-math><mml:math id="M546"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq258.gif"/></alternatives></inline-formula>: Translation: <italic>From</italic> expressions <italic>to</italic> expressions, preserving or approximating semantics (or projections thereof to observables). For example, translation could formalize the process of translating between the inputs to different modeling software systems. By defining such translations first at the level of classical (and/or intuitionistic) mathematics rather than software, it is much easier to establish equivalences where they exist. Then, one can explore whether and how deeply implementing or updating such translations is worth the effort.</p></list-item><list-item><p id="Par122"><inline-formula id="IEq259"><alternatives><tex-math id="M547">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathcal {A}}}$$\end{document}</tex-math><mml:math id="M548"><mml:mi mathvariant="script">A</mml:mi></mml:math><inline-graphic xlink:href="11538_2019_628_Article_IEq259.gif"/></alternatives></inline-formula>: Model analysis (phase diagrams, bifurcation diagrams, and the like): <italic>From</italic> models <italic>to</italic> mathematical analysis products such as reduced-parameter spaces, discontinuity or phase-change strata therein, and long-time asymptotics of observables. Model analysis enables further reduction of submodels, for example by algebraic solution of fast subnetworks.</p></list-item></list></p></list-item></list>For most of these kinds of maps, several maps of the same kind could have the same source and target nodes (e.g., multiple semantics maps related by refinement as discussed in Supplementary, 7.2.6); in that case subscripting the mapping symbols by <italic>mapping sub-kinds</italic> could become necessary&#x02014;although one would prefer to elaborate the meta-hierarchy nodes instead, if possible.</p><p id="Par123">The curation of this meta-hierarchy may provide a fruitful application area for automatic theorem verification software based on theorem-proving methods, since (a) many of these map types require the assertion of mathematical equivalences and approximations that could be proven, possibly with computer help, in an automatically verifiable form; (b) the applicability of a particular map to a particular modeling problem could be subject to logical inference on applicability conditions, perhaps using advanced type theory and (c) the retrieval or synthesis of valid map <italic>compositions</italic> that achieve some formalizable goal could be achieved by forward- and/or reverse-chaining style theorem-proving algorithm. For &#x0201c;computing&#x0201d; nodes in the meta-hierarchy, and implementation maps that target them, predictive declarative models of computational resource use as a function of problem statement could also be collected and trained on past data. Heuristic search for useful new intermediate nodes in the meta-hierarchy could be based on the utility of constructing commutative diagrams of inter-node mappings that &#x0201c;lift&#x0201d; one mapping along another, e.g., lifting implementation maps to more mathematical levels of abstraction where possible, in an internal improvement process akin to software refactoring.</p></sec><sec id="Sec19"><title>Conclusion</title><p id="Par124">We aim to formalize aspects of mathematical biological modeling so that they become amenable both to computer assistance and to cooperative human development of complex biological models. This capability will be particularly useful in developmental biology, where the necessity of relating genotype to phenotype in any fundamental &#x0201c;evodevo&#x0201d; research program commits a modeler to repeated and often difficult scale-changes within the modeling enterprise. A conceptual framework, based on declarative modeling, in support of these goals is presented. The elements of the conceptual framework include an informal definition of declarative biological modeling with formalized examples; a nested series of declarative biological modeling languages with compatible mathematical semantics defined in terms of operator algebra; a model reduction method based on machine learning with which to tame the often necessary complexity of biological models; and a meta-hierarchy of biological modeling sub-languages and methods, organized and cross-linked by structure-respecting maps.</p><p id="Par125">The biological modeling languages defined in this framework include physics-derived operator algebra semantics for processes expressed as reaction/rewrite rules acting on discrete objects, parameters for such objects that can be discrete and/or continuous variables, extended objects with graph structure including containment and adjacency, and approximate spatially continuous object models. Each of these object types receives appropriate dynamics expressed in reaction/rewrite rules whose operator algebra semantics is built from elementary creation and annihilation operators, so they are compatible and can be mixed together into complex multi-rule models by summation of time-evolution operators. A constructive labeled graph approach to the semantics of extended objects including &#x0201c;graded graphs&#x0201d; labeled by approximation level number and/or stratum dimension and identity can approximate and computably implement constructive variants of classical nonconstructive geometries such as manifolds, cell complexes, and stratified spaces.</p><p id="Par126">In many developmental biology systems, the spatial dynamics involves nontrivial changes in geometry and/or topology of extended biological objects. By using rewrite rules for the graph of strata defined in Sect.&#x000a0;<xref rid="Sec8" ref-type="sec">3.1</xref> together ODE-bearing rules for the parametric embeddings of individual strata into 3D space, we now have in principle a way to represent such dynamics mathematically and computationally.</p><p id="Par127">An essential step is to express natural graph-changing operations, including a collection of labeled graph rewrite rules, in terms of an operator algebra generated by the operators for the individual rules. Each graph rewrite rule operator is expressed in terms of elementary creation and annihilation operators, hence explicitly implementable in terms of binary and/or integer-valued random variables. Using this result (Propositions&#x000a0;<xref ref-type="sec" rid="FPar3">1</xref> and <xref ref-type="sec" rid="FPar4">2</xref> and corollaries), we also achieve summable operator algebra semantics for modeling languages with rewrite rules at the level of graded graphs, stratified graphs, abstract cell complexes, graded stratified graphs, and/or graded abstract cell complexes that could implement selected continuum limits such as mesh-approximable stratified spaces and cell complexes. A very expressive language of &#x0201c;dynamical graph grammars&#x0201d; results. All rule operator products and commutators are explicitly calculable, enabling the derivation of simulation and analysis methods.</p><p id="Par128">Significant limitations of the approach as discussed here are of course legion and notably include the fact that many graph structures can be defined virtually, as the result of a function of the labels pertaining to two vertices that may or may not be connected, rather than in terms of explicitly represented edges as we have generally assumed.</p><p id="Par129">A potentially generic model reduction and moment closure method for such models is based on dynamically evolving Boltzmann distributions, derived from fine-scale models by a form of machine learning. Other model reduction methods may be enabled by the broad collection of possible mathematical model types that have been formalized as possible outcomes of model reduction. In this way, both numeric (machine learning) and symbolic (declarative model transformations) Artificial Intelligence methods can be brought to bear on complex biological modeling problems.</p><p id="Par130">Finally, an overarching meta-hierarchy of modeling sub-languages is proposed, within which the structure-respecting maps required for declarative biological modeling could be defined, curated, and evolved through experience for maximal utility. This framework may provide opportunities for mathematical biologists to contribute to systematic mappings for complex biological model creation, definition, reduction, implementation and analysis in ways that could be greatly amplified by automation and artificially intelligent computational improvement.</p></sec><sec sec-type="supplementary-material"><title>Electronic supplementary material</title><sec id="Sec20"><p>Below is the link to the electronic supplementary material.
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="11538_2019_628_MOESM1_ESM.pdf"><caption><p>Supplementary material 1 (pdf 1191 KB)</p></caption></media></supplementary-material></p></sec></sec></body><back><fn-group><fn id="Fn1"><label>1</label><p id="Par31">A simpler published plant model has been translated from declarative form to Organism input; see <ext-link ext-link-type="uri" xlink:href="http://computableplant.ics.uci.edu/sw/CambiumOrganism/">http://computableplant.ics.uci.edu/sw/CambiumOrganism/</ext-link>.</p></fn><fn><p><bold>Publisher's Note</bold></p><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><ack><title>Acknowledgements</title><p>The author is indebted to many discussants, including several particularly helpful reviewers, none of whom are responsible for errors herein. I wish to thank Ray Wightman of the Sainsbury Laboratory for help with sample preparation and microscopy. The Microscopy Facility at the Sainsbury Laboratory is supported by the Gatsby Charitable Foundation. The author wishes to acknowledge the hospitality of the Sainsbury Laboratory Cambridge University, and the Center for Nonlinear Studies of the Los Alamos National Laboratory, and funding from the Leverhulme Trust, National Institutes for Health Grant R01HD073179, USAF/DARPA FA8750-14-C-0011, National Institute of Aging Grant R56AG059602, and Human Frontiers Science Program Grant HFSP&#x02014;RGP0023/2018.</p></ack><ref-list id="Bib1"><title>References</title><ref id="CR1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Banwarth-Kuhn</surname><given-names>M</given-names></name><name><surname>Nematbakhsh</surname><given-names>A</given-names></name><name><surname>Rodriguez</surname><given-names>KW</given-names></name><name><surname>Snipes</surname><given-names>S</given-names></name><name><surname>Rasmussen</surname><given-names>CG</given-names></name><name><surname>Reddy</surname><given-names>GV</given-names></name><name><surname>Alber</surname><given-names>M</given-names></name></person-group><article-title>Cell-based model of the generation and maintenance of the shape and structure of the multilayered shoot apical meristem of <italic>Arabidopsis thaliana</italic></article-title><source>Bull Math Biol</source><year>2018</year></element-citation></ref><ref id="CR2"><mixed-citation publication-type="other">Behr N, Danos V, Garnier I (2016) Stochastic mechanics of graph rewriting. In: Proceedings of the 31st annual ACM/IEEE symposium on logic in computer science, New York City, USA, pp 46&#x02013;55</mixed-citation></ref><ref id="CR3"><mixed-citation publication-type="other">Bendich P, Cohen-Steiner D, Edelsbrunner H, Harer J, Morozov D (2007) Inferring local homology from sampled stratified spaces. In: Proceedings of the 48th annual IEEE symposium on foundations of computer science, pp 536&#x02013;546</mixed-citation></ref><ref id="CR4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burkardt</surname><given-names>J</given-names></name><name><surname>Gunzburger</surname><given-names>M</given-names></name><name><surname>Lee</surname><given-names>H-C</given-names></name></person-group><article-title>POD and CVT-based reduced-order modeling of Navier&#x02013;Stokes flows</article-title><source>Comput Methods Appl Mech Eng</source><year>2006</year><volume>196</volume><issue>1&#x02013;3</issue><fpage>337</fpage><lpage>355</lpage><pub-id pub-id-type="doi">10.1016/j.cma.2006.04.004</pub-id></element-citation></ref><ref id="CR5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cardelli</surname><given-names>L</given-names></name></person-group><article-title>On process rate semantics</article-title><source>Theor Comput Sci</source><year>2008</year><volume>391</volume><fpage>190</fpage><lpage>215</lpage><pub-id pub-id-type="doi">10.1016/j.tcs.2007.11.012</pub-id></element-citation></ref><ref id="CR6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chakrabortty</surname><given-names>B</given-names></name><name><surname>Willemsen</surname><given-names>V</given-names></name><name><surname>de Zeeuw</surname><given-names>T</given-names></name><name><surname>Liao</surname><given-names>C-Y</given-names></name><name><surname>Weijers</surname><given-names>D</given-names></name><name><surname>Mulder</surname><given-names>B</given-names></name><name><surname>Scheres</surname><given-names>B</given-names></name></person-group><article-title>A plausible microtubule-based mechanism for cell division orientation in plant embryogenesis</article-title><source>Curr Biol</source><year>2018</year><volume>28</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2018.07.025</pub-id><pub-id pub-id-type="pmid">29249662</pub-id></element-citation></ref><ref id="CR7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danos</surname><given-names>V</given-names></name><name><surname>Feret</surname><given-names>J</given-names></name><name><surname>Fontana</surname><given-names>W</given-names></name><name><surname>Harmer</surname><given-names>R</given-names></name><name><surname>Krivine</surname><given-names>J</given-names></name></person-group><article-title>Rule-based modelling of cellular signaling</article-title><source>Lect Notes Comput Sci</source><year>2007</year><volume>4703</volume><fpage>17</fpage><lpage>41</lpage><pub-id pub-id-type="doi">10.1007/978-3-540-74407-8_3</pub-id></element-citation></ref><ref id="CR8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danos</surname><given-names>V</given-names></name><name><surname>Feret</surname><given-names>J</given-names></name><name><surname>Fontana</surname><given-names>W</given-names></name><name><surname>Harmer</surname><given-names>R</given-names></name><name><surname>Hayman</surname><given-names>J</given-names></name><name><surname>Krivine</surname><given-names>J</given-names></name><name><surname>Thompson-Walsh</surname><given-names>CD</given-names></name><name><surname>Winskel</surname><given-names>G</given-names></name></person-group><article-title>Graphs, rewriting and pathway reconstruction for rule-based models</article-title><source>FSTTCS</source><year>2012</year><volume>2012</volume><fpage>276</fpage><lpage>288</lpage></element-citation></ref><ref id="CR9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Demir</surname><given-names>E</given-names></name><etal/></person-group><article-title>BioPAX&#x02014;a community standard for pathway data sharing</article-title><source>Nat Biotechnol</source><year>2010</year><volume>28</volume><issue>9</issue><fpage>935</fpage><lpage>942</lpage><pub-id pub-id-type="doi">10.1038/nbt.1666</pub-id><pub-id pub-id-type="pmid">20829833</pub-id></element-citation></ref><ref id="CR10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doi</surname><given-names>M</given-names></name></person-group><article-title>Second quantization representation for classical many-particle system</article-title><source>J Phys A Math Gen</source><year>1976</year><volume>9</volume><fpage>1465</fpage><pub-id pub-id-type="doi">10.1088/0305-4470/9/9/008</pub-id></element-citation></ref><ref id="CR11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doi</surname><given-names>M</given-names></name></person-group><article-title>Stochastic theory of diffusion-controlled reactions</article-title><source>J Phys A Math Gen</source><year>1976</year><volume>9</volume><fpage>1479</fpage><pub-id pub-id-type="doi">10.1088/0305-4470/9/9/009</pub-id></element-citation></ref><ref id="CR12"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ehrig</surname><given-names>H</given-names></name><name><surname>Ehrig</surname><given-names>K</given-names></name><name><surname>Prange</surname><given-names>U</given-names></name><name><surname>Taentzer</surname><given-names>G</given-names></name></person-group><source>Fundamentals of algebraic graph transformation</source><year>2006</year><publisher-loc>Berlin</publisher-loc><publisher-name>Springer</publisher-name></element-citation></ref><ref id="CR13"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ermentrout</surname><given-names>B</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Bower</surname></name><name><surname>Bolouri</surname></name></person-group><article-title>Simplifying and reducing complex models</article-title><source>Computational modeling of genetic and biochemical networks</source><year>2004</year><publisher-loc>New York</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="CR14"><mixed-citation publication-type="other">Ernst OK, Bartol T, Sejnowski T, Mjolsness E (2018) Learning dynamic Boltzmann distributions as reduced models of spatial chemical kinetics. J Chem Phys 149:034107. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1803.01063">arXiv:1803.01063</ext-link></mixed-citation></ref><ref id="CR15"><mixed-citation publication-type="other">Frey B (2003) Extending factor graphs so as to unify directed and undirected graphical models. In: Proceedings of the nineteenth conference on uncertainty in artificial intelligence (UAI2003). <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1212.2486">arXiv:1212.2486</ext-link></mixed-citation></ref><ref id="CR16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golightly</surname><given-names>A</given-names></name><name><surname>Wilkinson</surname><given-names>DJ</given-names></name></person-group><article-title>Bayesian parameter inference for stochastic biochemical network models using particle Markov chain Monte Carlo</article-title><source>Interf Focus</source><year>2011</year><volume>1</volume><fpage>807</fpage><lpage>820</lpage><pub-id pub-id-type="doi">10.1098/rsfs.2011.0047</pub-id></element-citation></ref><ref id="CR17"><mixed-citation publication-type="other">Johnson GT (2012) Dependency diagrams and graph- constrained correlation dynamics: new systems for probabilistic graphical modeling. Ph.D. thesis, Computer Science Department, University of California, Irvine</mixed-citation></ref><ref id="CR18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>T</given-names></name><name><surname>Bartol</surname><given-names>T</given-names></name><name><surname>Sejnowski</surname><given-names>T</given-names></name><name><surname>Mjolsness</surname><given-names>E</given-names></name></person-group><article-title>Model reduction for stochastic CaMKII reaction kinetics in synapses by graph-constrained correlation dynamics</article-title><source>Phys Biol</source><year>2015</year><volume>12</volume><fpage>4</fpage><pub-id pub-id-type="doi">10.1088/1478-3975/12/4/045005</pub-id></element-citation></ref><ref id="CR19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>J&#x000f6;nsson</surname><given-names>H</given-names></name><name><surname>Heisler</surname><given-names>M</given-names></name><name><surname>Reddy</surname><given-names>V</given-names></name><name><surname>Agrawal</surname><given-names>V</given-names></name><name><surname>Gor</surname><given-names>V</given-names></name><name><surname>Shapiro</surname><given-names>BE</given-names></name><name><surname>Mjolsness</surname><given-names>E</given-names></name><name><surname>Meyerowitz</surname><given-names>EM</given-names></name></person-group><article-title>Modeling the organization of the WUSCHEL expression domain in the shoot apical meristem</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><issue>suppl1</issue><fpage>i232i240</fpage><pub-id pub-id-type="pmid">15961462</pub-id></element-citation></ref><ref id="CR20"><mixed-citation publication-type="other">J&#x000f6;nsson H, Heisler M, Shapiro BE, Meyerowitz EM, Mjolsness E (2006) An Auxin-driven polarized transport model for phyllotaxis. In: Proceedings of the national academy of sciences</mixed-citation></ref><ref id="CR21"><mixed-citation publication-type="other">J&#x000f6;nsson H, Sainsbury Laboratory Cambridge University Research Group (2018) &#x0201c;The Organism-Tissue Simulator&#x0201d;, simulation software source code in the C++ language. <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/slcu/teamhj/organism">https://gitlab.com/slcu/teamhj/organism</ext-link>. Accessed December 2018</mixed-citation></ref><ref id="CR22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joyner</surname><given-names>D</given-names></name><name><surname>&#x0010c;ertk</surname><given-names>O</given-names></name><name><surname>Meurer</surname><given-names>A</given-names></name><name><surname>Granger</surname><given-names>BE</given-names></name></person-group><article-title>Open source computer algebra systems: SymPy</article-title><source>ACM Commun Comput Algebra</source><year>2012</year><volume>45</volume><issue>3/4</issue><fpage>225</fpage><lpage>234</lpage><pub-id pub-id-type="doi">10.1145/2110170.2110185</pub-id></element-citation></ref><ref id="CR23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Julien</surname><given-names>J-D</given-names></name><name><surname>Pumir</surname><given-names>A</given-names></name><name><surname>Boudaoud</surname><given-names>A</given-names></name></person-group><article-title>Strain- or stress-sensing in mechanochemical patterning by the phytohormone Auxin</article-title><source>Bull Math Biol</source><year>2019</year></element-citation></ref><ref id="CR24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kac</surname><given-names>M</given-names></name></person-group><article-title>A stochastic model related to the telegraphers equation</article-title><source>Rocky Mt J Math</source><year>1974</year><volume>4</volume><issue>3</issue><fpage>497</fpage><lpage>509</lpage><pub-id pub-id-type="doi">10.1216/RMJ-1974-4-3-497</pub-id></element-citation></ref><ref id="CR25"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lauritzen</surname><given-names>SL</given-names></name></person-group><source>Graphical models</source><year>1995</year><publisher-loc>Oxford</publisher-loc><publisher-name>Oxford Science Publications</publisher-name></element-citation></ref><ref id="CR26"><mixed-citation publication-type="other">Maignan L, Spicher A (2015) Global graph transformations. In: Plump D (ed) Proceedings of the 6th international workshop on graph computation models, L&#x02019;Aquila, Italy. CUER workshop proceedings, vol 1403, pp 34&#x02013;49 (July 20, 2015). <ext-link ext-link-type="uri" xlink:href="http://ceur-ws.org/Vol-1403/">http://ceur-ws.org/Vol-1403/</ext-link>. Accessed June 2019</mixed-citation></ref><ref id="CR27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mattis</surname><given-names>DC</given-names></name><name><surname>Glasser</surname><given-names>ML</given-names></name></person-group><article-title>The uses of quantum field theory in diffusion-limited reactions</article-title><source>Rev Mod Phys</source><year>1998</year><volume>70</volume><fpage>979</fpage><pub-id pub-id-type="doi">10.1103/RevModPhys.70.979</pub-id></element-citation></ref><ref id="CR28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mironova</surname><given-names>VV</given-names></name><name><surname>Omelyanchuk</surname><given-names>NA</given-names></name><name><surname>Novoselova</surname><given-names>ES</given-names></name><name><surname>Doroshkov</surname><given-names>AV</given-names></name><name><surname>Kazantsev</surname><given-names>FV</given-names></name><name><surname>Kochetov</surname><given-names>AV</given-names></name><name><surname>Kolchanov</surname><given-names>NA</given-names></name><name><surname>Mjolsness</surname><given-names>E</given-names></name><name><surname>Likhoshvai</surname><given-names>VA</given-names></name></person-group><article-title>Combined in silico/in vivo analysis of mechanisms providing for root apical meristem self-organization and maintenance</article-title><source>Ann Botany</source><year>2012</year><volume>110</volume><issue>2</issue><fpage>349</fpage><lpage>360</lpage><pub-id pub-id-type="doi">10.1093/aob/mcs069</pub-id><pub-id pub-id-type="pmid">22510326</pub-id></element-citation></ref><ref id="CR29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mjolsness</surname><given-names>E</given-names></name><name><surname>Sharp</surname><given-names>DH</given-names></name><name><surname>Reinitz</surname><given-names>J</given-names></name></person-group><article-title>A connectionist model of development</article-title><source>J Theor Biol</source><year>1991</year><volume>152</volume><issue>4</issue><fpage>429</fpage><lpage>454</lpage><pub-id pub-id-type="doi">10.1016/S0022-5193(05)80391-1</pub-id><pub-id pub-id-type="pmid">1758194</pub-id></element-citation></ref><ref id="CR30"><mixed-citation publication-type="other">Mjolsness E (2005) Stochastic process semantics for dynamical grammar syntax: an overview. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/cs/0511073">arXiv:cs/0511073</ext-link></mixed-citation></ref><ref id="CR31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mjolsness</surname><given-names>E</given-names></name><name><surname>Yosiphon</surname><given-names>G</given-names></name></person-group><article-title>Stochastic process semantics for dynamical grammars</article-title><source>Ann Math Artif Intell</source><year>2006</year><volume>47</volume><issue>3&#x02013;4</issue><fpage>329</fpage><lpage>395</lpage></element-citation></ref><ref id="CR32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mjolsness</surname><given-names>E</given-names></name><name><surname>Orendorff</surname><given-names>D</given-names></name><name><surname>Chatelain</surname><given-names>P</given-names></name><name><surname>Koumoutsakos</surname><given-names>P</given-names></name></person-group><article-title>An exact accelerated stochastic simulation algorithm</article-title><source>J Chem Phys</source><year>2009</year><volume>130</volume><fpage>144110</fpage><pub-id pub-id-type="doi">10.1063/1.3078490</pub-id><pub-id pub-id-type="pmid">19368432</pub-id></element-citation></ref><ref id="CR33"><mixed-citation publication-type="other">Mjolsness E (2010) Towards measurable types for dynamical process modeling languages. In: Proceedings of the 26th conference on mathematical foundations of programming semantics (MFPS 2010). Electronic notes in theoretical computer science (ENTCS), vol 265, pp 123&#x02013;144, 6 Sept 2010, Elsevier</mixed-citation></ref><ref id="CR34"><mixed-citation publication-type="other">Mjolsness E, Cunha A (2012) Topological object types for morphodynamic modeling languages. In: PMA 2012: IEEE fourth international symposium on plant growth modeling, visualization and applications. Shanghai China, October 2012. IEEE Press</mixed-citation></ref><ref id="CR35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mjolsness</surname><given-names>E</given-names></name></person-group><article-title>Time-ordered product expansions for computational stochastic systems biology</article-title><source>Phys Biol</source><year>2013</year><volume>10</volume><fpage>035009</fpage><pub-id pub-id-type="doi">10.1088/1478-3975/10/3/035009</pub-id><pub-id pub-id-type="pmid">23735739</pub-id></element-citation></ref><ref id="CR36"><mixed-citation publication-type="other">Morrison MJ, Kinney JB (2016) Modeling multi-particle complexes in stochastic chemical systems. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1603.07369v1">arXiv:1603.07369v1</ext-link></mixed-citation></ref><ref id="CR37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orendorff</surname><given-names>D</given-names></name><name><surname>Mjolsness</surname><given-names>E</given-names></name></person-group><article-title>A hierarchical exact accelerated stochastic simulation algorithm</article-title><source>J Chem Phys</source><year>2012</year><volume>137</volume><fpage>214104</fpage><pub-id pub-id-type="doi">10.1063/1.4766353</pub-id><pub-id pub-id-type="pmid">23231214</pub-id></element-citation></ref><ref id="CR38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peliti</surname><given-names>L</given-names></name></person-group><article-title>Path integral approach to birth-death processes on a lattice.</article-title><source>J Phys Fr</source><year>1985</year><volume>46</volume><fpage>1469</fpage><pub-id pub-id-type="doi">10.1051/jphys:019850046090146900</pub-id></element-citation></ref><ref id="CR39"><mixed-citation publication-type="other">Perlis A (1982) Epigram No. 102. In: &#x0201c;Epigrams in Programming&#x0201d;, ACM SIGPLAN September, 1982. <ext-link ext-link-type="uri" xlink:href="https://cpsc.yale.edu/epigrams-programming">https://cpsc.yale.edu/epigrams-programming</ext-link>. Accessed March 2018</mixed-citation></ref><ref id="CR40"><mixed-citation publication-type="other">Prusinkiewicz P, Hammel MS, Mjolsness E (1993) Animation of plant development. In: SIGGRAPH &#x02019;93 conference proceedings, ACM</mixed-citation></ref><ref id="CR41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shapiro</surname><given-names>BE</given-names></name><name><surname>Levchenko</surname><given-names>A</given-names></name><name><surname>Meyerowitz</surname><given-names>EM</given-names></name><name><surname>Wold</surname><given-names>BJ</given-names></name><name><surname>Mjolsness</surname><given-names>ED</given-names></name></person-group><article-title>Cellerator: extending a computer algebra system to include biochemical arrows for signal transduction simulations</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><issue>5</issue><fpage>677</fpage><lpage>678</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btg042</pub-id><pub-id pub-id-type="pmid">12651737</pub-id></element-citation></ref><ref id="CR42"><mixed-citation publication-type="other">Shapiro BE, J&#x000f6;nsson H, Sahlin P, Heisler M, Roeder A, Burl M, Meyerowitz EM, Mjolsness ED (2012) Tessellations and pattern formation in plant growth and development. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1209.2937">arXiv:1209.2937</ext-link></mixed-citation></ref><ref id="CR43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shapiro</surname><given-names>BE</given-names></name><name><surname>Meyerowitz</surname><given-names>E</given-names></name><name><surname>Mjolsness</surname><given-names>E</given-names></name></person-group><article-title>Using cellzilla for plant growth simulations at the cellular level</article-title><source>Front Plant Biophys Model</source><year>2013</year><volume>4</volume><fpage>00408</fpage></element-citation></ref><ref id="CR44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shapiro</surname><given-names>BE</given-names></name><name><surname>Mjolsness</surname><given-names>E</given-names></name></person-group><article-title>Pycellerator: an arrow-based reaction-like modelling language for biological simulations</article-title><source>Bioinformatics</source><year>2015</year></element-citation></ref><ref id="CR45"><mixed-citation publication-type="other">Shaw SL, Kamyar R, Ehrhardt DW (2003) Sustained microtubule treadmilling in arabidopsis cortical arrays. Science. 10.1126/science.1083529</mixed-citation></ref><ref id="CR46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shellard</surname><given-names>A</given-names></name><name><surname>Szabo</surname><given-names>A</given-names></name><name><surname>Trepat</surname><given-names>X</given-names></name><name><surname>Mayor</surname><given-names>R</given-names></name></person-group><article-title>Supracellular contraction at the rear of neural crest cell groups drives collective chemotaxis</article-title><source>Science</source><year>2018</year><volume>362</volume><issue>6412</issue><fpage>19</fpage><pub-id pub-id-type="doi">10.1126/science.aau3301</pub-id></element-citation></ref><ref id="CR47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>JS</given-names></name><name><surname>Isayev</surname><given-names>O</given-names></name><name><surname>Roitberg</surname><given-names>AE</given-names></name></person-group><article-title>ANI-1: an extensible neural network potential with DFT accuracy at force field computational cost</article-title><source>Chem Sci Chem Sci</source><year>2017</year><volume>8</volume><fpage>3192</fpage><lpage>3203</lpage><pub-id pub-id-type="doi">10.1039/C6SC05720A</pub-id><pub-id pub-id-type="pmid">28507695</pub-id></element-citation></ref><ref id="CR48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vemu</surname><given-names>A</given-names></name><name><surname>Szczesna</surname><given-names>E</given-names></name><name><surname>Zehr</surname><given-names>EA</given-names></name><name><surname>Spector</surname><given-names>JO</given-names></name><name><surname>Grigorieff</surname><given-names>N</given-names></name><name><surname>Deaconescu</surname><given-names>AM</given-names></name><name><surname>Roll-Mecak</surname><given-names>A</given-names></name></person-group><article-title>Severing enzymes amplify microtubule arrays through lattice GTP-tubulin incorporation</article-title><source>Science</source><year>2018</year><volume>361</volume><issue>6404</issue><fpage>eaau1504</fpage><pub-id pub-id-type="doi">10.1126/science.aau1504</pub-id><pub-id pub-id-type="pmid">30139843</pub-id></element-citation></ref><ref id="CR49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Christley</surname><given-names>S</given-names></name><name><surname>Mjolsness</surname><given-names>E</given-names></name><name><surname>Xie</surname><given-names>X</given-names></name></person-group><article-title>Parameter inference for discretely observed stochastic kinetic models using stochastic gradient descent</article-title><source>BMC Syst Biol</source><year>2010</year><volume>4</volume><fpage>99</fpage><pub-id pub-id-type="doi">10.1186/1752-0509-4-99</pub-id><pub-id pub-id-type="pmid">20663171</pub-id></element-citation></ref><ref id="CR50"><mixed-citation publication-type="other">Winograd T (1975) Frame representations and the procedural&#x02014;declarative controversy. In: Bobrow D, Collins A (eds) Representation and understanding: studies in cognitive science. Academic Press, pp 185&#x02013;210. <ext-link ext-link-type="uri" xlink:href="http://hci.stanford.edu/winograd/papers/FrameRep.pdf">http://hci.stanford.edu/winograd/papers/FrameRep.pdf</ext-link>. Accessed Oct 2018</mixed-citation></ref><ref id="CR51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolff</surname><given-names>HB</given-names></name><name><surname>Davidson</surname><given-names>LA</given-names></name><name><surname>Merks</surname><given-names>RMH</given-names></name></person-group><article-title>Adapting a plant tissue model to animal development: introducing cell sliding into VirtualLeaf</article-title><source>Bull Math Biol</source><year>2019</year></element-citation></ref><ref id="CR52"><element-citation publication-type="book"><person-group person-group-type="author"><collab>Wolfram Research, Inc</collab></person-group><source>Mathematica Version 11</source><year>2018</year><publisher-loc>Champaign</publisher-loc><publisher-name>Wolfram Research Inc</publisher-name></element-citation></ref><ref id="CR53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>C-R</given-names></name><name><surname>Shapiro</surname><given-names>BE</given-names></name><name><surname>Mjolsness</surname><given-names>ED</given-names></name><name><surname>Hatfield</surname><given-names>GW</given-names></name></person-group><article-title>An enzyme mechanism language for the mathematical modeling of metabolic pathways</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><issue>6</issue><fpage>774</fpage><lpage>0780</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bti068</pub-id><pub-id pub-id-type="pmid">15509612</pub-id></element-citation></ref><ref id="CR54"><mixed-citation publication-type="other">Yosiphon G (2009) Stochastic parameterized grammars: formalization, inference, and modeling applications. Ph.D. thesis, Computer Science Department, University of California, Irvine, June 2009. Thesis and code available at <ext-link ext-link-type="uri" xlink:href="http://computableplant.ics.uci.edu/theses/guy/downloads/DGPublications.html">http://computableplant.ics.uci.edu/theses/guy/downloads/DGPublications.html</ext-link>. Accessed Oct 2018</mixed-citation></ref></ref-list></back></article>